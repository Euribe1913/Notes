<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Interval Estimation | Stat 255: Statistics for Data Science Notes</title>
  <meta name="description" content="Chapter 3 Interval Estimation | Stat 255: Statistics for Data Science Notes" />
  <meta name="generator" content="bookdown 0.31 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Interval Estimation | Stat 255: Statistics for Data Science Notes" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Interval Estimation | Stat 255: Statistics for Data Science Notes" />
  
  
  

<meta name="author" content="Andrew Sage - Lawrence University" />


<meta name="date" content="2023-08-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-statistical-models.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STAT 255 Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>1</b> Exploratory Data Analysis</a>
<ul>
<li class="chapter" data-level="1.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#getting-started-in-r"><i class="fa fa-check"></i><b>1.1</b> Getting Started in R</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#previewing-the-data"><i class="fa fa-check"></i><b>1.1.1</b> Previewing the Data</a></li>
<li class="chapter" data-level="1.1.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#modifying-the-data"><i class="fa fa-check"></i><b>1.1.2</b> Modifying the Data</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#data-visualization"><i class="fa fa-check"></i><b>1.2</b> Data Visualization</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#histogram"><i class="fa fa-check"></i><b>1.2.1</b> Histogram</a></li>
<li class="chapter" data-level="1.2.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#density-plot"><i class="fa fa-check"></i><b>1.2.2</b> Density Plot</a></li>
<li class="chapter" data-level="1.2.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#boxplot"><i class="fa fa-check"></i><b>1.2.3</b> Boxplot</a></li>
<li class="chapter" data-level="1.2.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#violin-plot"><i class="fa fa-check"></i><b>1.2.4</b> Violin Plot</a></li>
<li class="chapter" data-level="1.2.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#scatterplot"><i class="fa fa-check"></i><b>1.2.5</b> Scatterplot</a></li>
<li class="chapter" data-level="1.2.6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#bar-graph"><i class="fa fa-check"></i><b>1.2.6</b> Bar Graph</a></li>
<li class="chapter" data-level="1.2.7" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#stacked-and-side-by-side-bar-graphs"><i class="fa fa-check"></i><b>1.2.7</b> Stacked and Side-by-Side Bar Graphs</a></li>
<li class="chapter" data-level="1.2.8" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#correlation-plot"><i class="fa fa-check"></i><b>1.2.8</b> Correlation Plot</a></li>
<li class="chapter" data-level="1.2.9" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#scatterplot-matrix"><i class="fa fa-check"></i><b>1.2.9</b> Scatterplot Matrix</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#summary-tables"><i class="fa fa-check"></i><b>1.3</b> Summary Tables</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#calculating-summary-statistics"><i class="fa fa-check"></i><b>1.3.1</b> Calculating Summary Statistics</a></li>
<li class="chapter" data-level="1.3.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#grouped-summaries"><i class="fa fa-check"></i><b>1.3.2</b> Grouped Summaries</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html"><i class="fa fa-check"></i><b>2</b> Introduction to Statistical Models</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#fitting-models-to-data"><i class="fa fa-check"></i><b>2.1</b> Fitting Models to Data</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#terminology"><i class="fa fa-check"></i><b>2.1.1</b> Terminology</a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-with-quantitative-explanatory-variable"><i class="fa fa-check"></i><b>2.1.2</b> Model with Quantitative Explanatory Variable</a></li>
<li class="chapter" data-level="2.1.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-with-categorical-variable"><i class="fa fa-check"></i><b>2.1.3</b> Model with Categorical Variable</a></li>
<li class="chapter" data-level="2.1.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-with-multiple-explanatory-variables"><i class="fa fa-check"></i><b>2.1.4</b> Model with Multiple Explanatory Variables</a></li>
<li class="chapter" data-level="2.1.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-with-no-explanatory-variable"><i class="fa fa-check"></i><b>2.1.5</b> Model with No Explanatory Variable</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#variability-explained-by-a-model"><i class="fa fa-check"></i><b>2.2</b> Variability Explained by a Model</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#quantifying-variability"><i class="fa fa-check"></i><b>2.2.1</b> Quantifying Variability</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#total-variability"><i class="fa fa-check"></i><b>2.2.2</b> Total Variability</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#residuals"><i class="fa fa-check"></i><b>2.2.3</b> Residuals</a></li>
<li class="chapter" data-level="2.2.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#variability-explained-by-sq.-ft.-model"><i class="fa fa-check"></i><b>2.2.4</b> Variability Explained by Sq. Ft. Model</a></li>
<li class="chapter" data-level="2.2.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#linear-correlation-coefficient"><i class="fa fa-check"></i><b>2.2.5</b> Linear Correlation Coefficient</a></li>
<li class="chapter" data-level="2.2.6" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#variability-explained-by-waterfront-model"><i class="fa fa-check"></i><b>2.2.6</b> Variability Explained by Waterfront Model</a></li>
<li class="chapter" data-level="2.2.7" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#variability-explained-by-multiple-regression-model"><i class="fa fa-check"></i><b>2.2.7</b> Variability Explained by Multiple Regression Model</a></li>
<li class="chapter" data-level="2.2.8" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#summary-sst-ssr-ssm-r2"><i class="fa fa-check"></i><b>2.2.8</b> Summary: SST, SSR, SSM, <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="2.2.9" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#r2-visually"><i class="fa fa-check"></i><b>2.2.9</b> <span class="math inline">\(R^2\)</span> Visually</a></li>
<li class="chapter" data-level="2.2.10" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-comparison-summary"><i class="fa fa-check"></i><b>2.2.10</b> Model Comparison Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#models-with-interaction"><i class="fa fa-check"></i><b>2.3</b> Models with Interaction</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#definition-of-interaction"><i class="fa fa-check"></i><b>2.3.1</b> Definition of Interaction</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#interaction-term"><i class="fa fa-check"></i><b>2.3.2</b> Interaction Term</a></li>
<li class="chapter" data-level="2.3.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#interaction-models-in-r"><i class="fa fa-check"></i><b>2.3.3</b> Interaction Models in R</a></li>
<li class="chapter" data-level="2.3.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#r2-for-interaction-model"><i class="fa fa-check"></i><b>2.3.4</b> <span class="math inline">\(R^2\)</span> for Interaction Model</a></li>
<li class="chapter" data-level="2.3.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#considerations-for-using-interactions"><i class="fa fa-check"></i><b>2.3.5</b> Considerations for Using Interactions</a></li>
<li class="chapter" data-level="2.3.6" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#interaction-vs-correlation"><i class="fa fa-check"></i><b>2.3.6</b> Interaction vs Correlation</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#least-squares-estimation-lse"><i class="fa fa-check"></i><b>2.4</b> Least Squares Estimation (LSE)</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#line-of-best-fit"><i class="fa fa-check"></i><b>2.4.1</b> Line of Best Fit</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#lse-in-simple-linear-regression"><i class="fa fa-check"></i><b>2.4.2</b> LSE in Simple Linear Regression</a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#lse-for-categorical-variable"><i class="fa fa-check"></i><b>2.4.3</b> LSE for Categorical Variable</a></li>
<li class="chapter" data-level="2.4.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#lse-more-generally"><i class="fa fa-check"></i><b>2.4.4</b> LSE More Generally</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#analysis-of-variance"><i class="fa fa-check"></i><b>2.5</b> ANalysis Of VAriance</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#submodels"><i class="fa fa-check"></i><b>2.5.1</b> Submodels</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#f-statistics"><i class="fa fa-check"></i><b>2.5.2</b> F-Statistics</a></li>
<li class="chapter" data-level="2.5.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#comparing-3-or-more-categories"><i class="fa fa-check"></i><b>2.5.3</b> Comparing 3 or More Categories</a></li>
<li class="chapter" data-level="2.5.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#f-statistic-illustration"><i class="fa fa-check"></i><b>2.5.4</b> F-Statistic Illustration</a></li>
<li class="chapter" data-level="2.5.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#alternative-f-statistic-formula"><i class="fa fa-check"></i><b>2.5.5</b> Alternative F-Statistic Formula</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="interval-estimation.html"><a href="interval-estimation.html"><i class="fa fa-check"></i><b>3</b> Interval Estimation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="interval-estimation.html"><a href="interval-estimation.html#sampling-distributions"><i class="fa fa-check"></i><b>3.1</b> Sampling Distributions</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="interval-estimation.html"><a href="interval-estimation.html#sampling-from-a-population"><i class="fa fa-check"></i><b>3.1.1</b> Sampling From a Population</a></li>
<li class="chapter" data-level="3.1.2" data-path="interval-estimation.html"><a href="interval-estimation.html#confidence-intervals"><i class="fa fa-check"></i><b>3.1.2</b> Confidence Intervals</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="interval-estimation.html"><a href="interval-estimation.html#bootstrapping"><i class="fa fa-check"></i><b>3.2</b> Bootstrapping</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="interval-estimation.html"><a href="interval-estimation.html#mercury-levels-in-florida-lakes"><i class="fa fa-check"></i><b>3.2.1</b> Mercury Levels in Florida Lakes</a></li>
<li class="chapter" data-level="3.2.2" data-path="interval-estimation.html"><a href="interval-estimation.html#bootstrap-sampling"><i class="fa fa-check"></i><b>3.2.2</b> Bootstrap Sampling</a></li>
<li class="chapter" data-level="3.2.3" data-path="interval-estimation.html"><a href="interval-estimation.html#bootstrap-samples-of-lakes"><i class="fa fa-check"></i><b>3.2.3</b> Bootstrap Samples of Lakes</a></li>
<li class="chapter" data-level="3.2.4" data-path="interval-estimation.html"><a href="interval-estimation.html#bootstrap-distribution"><i class="fa fa-check"></i><b>3.2.4</b> Bootstrap Distribution</a></li>
<li class="chapter" data-level="3.2.5" data-path="interval-estimation.html"><a href="interval-estimation.html#bootstrap-se-confidence-interval"><i class="fa fa-check"></i><b>3.2.5</b> Bootstrap SE Confidence Interval</a></li>
<li class="chapter" data-level="3.2.6" data-path="interval-estimation.html"><a href="interval-estimation.html#bootstrap-distribution-vs-sampling-distribution"><i class="fa fa-check"></i><b>3.2.6</b> Bootstrap Distribution vs Sampling Distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="interval-estimation.html"><a href="interval-estimation.html#bootstrap-confidence-interval-example"><i class="fa fa-check"></i><b>3.3</b> Bootstrap Confidence Interval Example</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="interval-estimation.html"><a href="interval-estimation.html#bootstrapping-other-statistics"><i class="fa fa-check"></i><b>3.3.1</b> Bootstrapping Other Statistics</a></li>
<li class="chapter" data-level="3.3.2" data-path="interval-estimation.html"><a href="interval-estimation.html#ci-for-mean"><i class="fa fa-check"></i><b>3.3.2</b> CI for Mean</a></li>
<li class="chapter" data-level="3.3.3" data-path="interval-estimation.html"><a href="interval-estimation.html#ci-for-standard-deviation"><i class="fa fa-check"></i><b>3.3.3</b> CI for Standard Deviation</a></li>
<li class="chapter" data-level="3.3.4" data-path="interval-estimation.html"><a href="interval-estimation.html#ci-for-median"><i class="fa fa-check"></i><b>3.3.4</b> CI for Median</a></li>
<li class="chapter" data-level="3.3.5" data-path="interval-estimation.html"><a href="interval-estimation.html#ci-for-difference-in-means"><i class="fa fa-check"></i><b>3.3.5</b> CI for Difference in Means</a></li>
<li class="chapter" data-level="3.3.6" data-path="interval-estimation.html"><a href="interval-estimation.html#ci-for-regression-slope"><i class="fa fa-check"></i><b>3.3.6</b> CI for Regression Slope</a></li>
<li class="chapter" data-level="3.3.7" data-path="interval-estimation.html"><a href="interval-estimation.html#ci-for-regression-response"><i class="fa fa-check"></i><b>3.3.7</b> CI for Regression Response</a></li>
<li class="chapter" data-level="3.3.8" data-path="interval-estimation.html"><a href="interval-estimation.html#more-cis-in-regression"><i class="fa fa-check"></i><b>3.3.8</b> More CI’s in Regression</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="interval-estimation.html"><a href="interval-estimation.html#bootstrapping-cautions"><i class="fa fa-check"></i><b>3.4</b> Bootstrapping Cautions</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stat 255: Statistics for Data Science Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="interval-estimation" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Interval Estimation<a href="interval-estimation.html#interval-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Learning Outcomes:</strong></p>
<ol style="list-style-type: decimal">
<li>State null and alternative hypotheses associated with models involving categorical and quantitative explanatory variables.<br />
</li>
<li>Explain how to use permutation tests for hypotheses involving means, medians, F-statistics, slopes, and other regression coefficients, as well as functions of these statistics.<br />
</li>
<li>Interpret p-values in context.<br />
</li>
<li>Explain the conclusions we should draw from from a hypothesis test, while accounting for other information available in a dataset.<br />
</li>
<li>Explain how to simultaneously test for differences between multiple groups.<br />
</li>
<li>Distinguish between statistical significance and practical importance.</li>
</ol>
<div id="sampling-distributions" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Sampling Distributions<a href="interval-estimation.html#sampling-distributions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sampling-from-a-population" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Sampling From a Population<a href="interval-estimation.html#sampling-from-a-population" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In statistics, we often do not have the time, money, or means to collect data on all individuals or units on which we want to draw conclusions. Instead, we might collect data on only a subset of the individuals, and then make inferences about all individuals we are interested in, using the information we collected.</p>
<p><strong>Vocabulary:</strong></p>
<ol style="list-style-type: decimal">
<li>A <strong>population</strong> is the entire set of individuals that we want to draw conclusions about.</li>
<li>A <strong>sample</strong> is a subset of a population</li>
<li>A <strong>parameter</strong> is a numerical quantity pertaining to an entire population<br />
</li>
<li>A <strong>statistic</strong> is a numerical quantity calculated from a sample</li>
</ol>
<p>We’ll work with a dataset containing information on all 20,591 flights from New York to Chicago in 2013. Our population of interest is all 20,591 flights.</p>
<p>In this situation, we have information on the entire population, but suppose temporarily that we didn’t. Instead, suppose we had only information on a random sample of 75 flights.</p>
<p>The parameter of interest is the proportion of on-time arrivals out of all flights in the population of 20,591. When the parameter is proportion, we’ll denote it with the letter <span class="math inline">\(p\)</span>.</p>
<p>We take a sample of 75 flights. The first 6 flights in the sample are shown below. The <code>ontime</code> variable tells whether or not the flight arrived on time.</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="interval-estimation.html#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">08082023</span>)</span>
<span id="cb132-2"><a href="interval-estimation.html#cb132-2" aria-hidden="true" tabindex="-1"></a>S1 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Flights_NY_CHI, <span class="dv">75</span>)</span>
<span id="cb132-3"><a href="interval-estimation.html#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(S1)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 9
##    year month   day carrier origin dest  sched_dep_time arr_delay ontime
##   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;          &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt; 
## 1  2013     3     8 AA      LGA    ORD             1720       106 N     
## 2  2013    12    15 AA      JFK    ORD             1715       -24 Y     
## 3  2013    10    22 UA      EWR    ORD             1300       -12 Y     
## 4  2013     8    26 UA      EWR    ORD             2110        15 N     
## 5  2013     7    23 AA      LGA    ORD             1359        66 N     
## 6  2013     5    13 UA      EWR    ORD              900       -21 Y</code></pre>
<p>We’ll calculate the number, and proportion of flights that arrived on time.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="interval-estimation.html#cb134-1" aria-hidden="true" tabindex="-1"></a>num_ontime <span class="ot">&lt;-</span> <span class="fu">sum</span>(S1<span class="sc">$</span>ontime <span class="sc">==</span> <span class="st">&quot;Y&quot;</span>) <span class="co"># count number of on-time arrivals</span></span></code></pre></div>
<p>Number of on-time arrivals in the sample.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="interval-estimation.html#cb135-1" aria-hidden="true" tabindex="-1"></a>num_ontime</span></code></pre></div>
<pre><code>## [1] 39</code></pre>
<p>Proportion of on-time arrivals in the sample.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="interval-estimation.html#cb137-1" aria-hidden="true" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> num_ontime<span class="sc">/</span><span class="dv">75</span></span>
<span id="cb137-2"><a href="interval-estimation.html#cb137-2" aria-hidden="true" tabindex="-1"></a>p_hat</span></code></pre></div>
<pre><code>## [1] 0.52</code></pre>
<p>In out sample 52 percent of flights arrived on-time. We’ll denote this quantity <span class="math inline">\(\hat{p}\)</span>, keeping with our convention of using the <span class="math inline">\(\hat{}\)</span> symbol to represent a quantity that is calculated from data (like the predictions and estimates we saw in the previous chapter). The sample statistic <span class="math inline">\(\hat{p}\)</span> is an estimate of the population proportion <span class="math inline">\(p\)</span>.</p>
<p>Of course, this was just one sample of 75 flights. We should not expect the proportion of on-time flights in our sample (<span class="math inline">\(\hat{p}\)</span>) to exactly match the proportion of on-time flights in the entire population (<span class="math inline">\(p\)</span>). Nevertheless we can use the sample to estimate the proportion of all flights in the population that arrive on time. Perhaps, we could say that we would expect between 42 and 62 percent of all 2013 flights from New York to arrive on time. Or, perhaps we could be more precise and estimate that the percentage of on-time flights to be between 47 and 57. We’ll need to figure out how precise we can make our range, while still being confident that it does, in fact, contain the true population parameter.</p>
<p>To summarize:</p>
<ul>
<li>The population is all 20,591 flights from New York to Chicago in 2013.</li>
<li>The sample is the flights that we randomly selected.<br />
</li>
<li>The parameter <span class="math inline">\(p\)</span> is the proportion of on-time arrivals among all 2013 flights from New York to Chicago, which we do not know (though in this particular example, we could find it, since we have data on all flights in the population.)<br />
</li>
<li>The sample statistic is the proportion of flights in our sample that arrived on time, which we know to be <span class="math inline">\(\hat{p}\)</span> = 0.52.</li>
</ul>
<p>Now, let’s take a different sample of 75 flights and see how the proportion of on-time arrivals compares.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="interval-estimation.html#cb139-1" aria-hidden="true" tabindex="-1"></a>S2 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Flights_NY_CHI, <span class="dv">75</span>)</span>
<span id="cb139-2"><a href="interval-estimation.html#cb139-2" aria-hidden="true" tabindex="-1"></a>num_ontime2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(S2<span class="sc">$</span>ontime <span class="sc">==</span> <span class="st">&quot;Y&quot;</span>) <span class="co"># count number of on-time arrivals</span></span>
<span id="cb139-3"><a href="interval-estimation.html#cb139-3" aria-hidden="true" tabindex="-1"></a>p_hat2 <span class="ot">&lt;-</span> num_ontime2<span class="sc">/</span><span class="dv">75</span></span>
<span id="cb139-4"><a href="interval-estimation.html#cb139-4" aria-hidden="true" tabindex="-1"></a>p_hat2</span></code></pre></div>
<pre><code>## [1] 0.5066667</code></pre>
<p>By studying the behavior of the proportion of on-time arrivals in different samples we can gauge how close the proportion in a given sample is likely be to the unknown population parameter. If all of our samples produce very similar estimates, then it is likely that the population parameter is close to these estimates. If the sample proportion varies considerably from sample to sample, then it is possible that the proportion in any given sample might be very different than the population parameter.</p>
<p>Let’s take 10,000 more random samples of 75 flights and record the proportion of on-time arrivals in each sample.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="interval-estimation.html#cb141-1" aria-hidden="true" tabindex="-1"></a>nreps <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># number of repetitions</span></span>
<span id="cb141-2"><a href="interval-estimation.html#cb141-2" aria-hidden="true" tabindex="-1"></a>p_hat_val <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, nreps) <span class="co"># create vector to hold proportion of on-time arrivals</span></span>
<span id="cb141-3"><a href="interval-estimation.html#cb141-3" aria-hidden="true" tabindex="-1"></a>Sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span>nreps</span>
<span id="cb141-4"><a href="interval-estimation.html#cb141-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-5"><a href="interval-estimation.html#cb141-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>nreps){</span>
<span id="cb141-6"><a href="interval-estimation.html#cb141-6" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Flights_NY_CHI, <span class="dv">75</span>) <span class="co"># take sample of 75</span></span>
<span id="cb141-7"><a href="interval-estimation.html#cb141-7" aria-hidden="true" tabindex="-1"></a>N_ontime <span class="ot">&lt;-</span> <span class="fu">sum</span>(S<span class="sc">$</span>ontime <span class="sc">==</span> <span class="st">&quot;Y&quot;</span>) <span class="co"># count number of on-time arrivals</span></span>
<span id="cb141-8"><a href="interval-estimation.html#cb141-8" aria-hidden="true" tabindex="-1"></a>p_hat_val[i] <span class="ot">&lt;-</span> N_ontime<span class="sc">/</span><span class="dv">75</span> <span class="co"># record proportion on-time</span></span>
<span id="cb141-9"><a href="interval-estimation.html#cb141-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb141-10"><a href="interval-estimation.html#cb141-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-11"><a href="interval-estimation.html#cb141-11" aria-hidden="true" tabindex="-1"></a>Samples_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Sample, p_hat_val) <span class="co"># store results in a data frame</span></span></code></pre></div>
<p>The table shows the proportion of on-time arrivals in the first 20 samples of 75 flights.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="interval-estimation.html#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(Samples_df, <span class="dv">20</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Sample</th>
<th align="right">p_hat_val</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.6533333</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.5333333</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.5866667</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.6933333</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.5866667</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">0.6666667</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">0.6133333</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">0.5866667</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">0.6533333</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">0.6533333</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">0.6133333</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">0.5866667</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">0.6133333</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">0.4800000</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">0.6000000</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">0.4400000</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">0.4933333</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">0.5733333</td>
</tr>
<tr class="odd">
<td align="right">19</td>
<td align="right">0.6400000</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">0.5600000</td>
</tr>
</tbody>
</table>
<p>The histogram below shows the distribution of the proportion of on-time arrivals in the 10,000 different samples.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="interval-estimation.html#cb143-1" aria-hidden="true" tabindex="-1"></a>Prop_Samp_Dist<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Samples_df, <span class="fu">aes</span>(<span class="at">x=</span>p_hat_val)) <span class="sc">+</span></span>
<span id="cb143-2"><a href="interval-estimation.html#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;blue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb143-3"><a href="interval-estimation.html#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Sampling Distribution for Proportion On Time&quot;</span>) <span class="sc">+</span> </span>
<span id="cb143-4"><a href="interval-estimation.html#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Prop. on time in sample&quot;</span>)</span>
<span id="cb143-5"><a href="interval-estimation.html#cb143-5" aria-hidden="true" tabindex="-1"></a>Prop_Samp_Dist</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-114-1.png" width="672" /></p>
<p>We notice that most of our 10,000 samples yielded proportions of on-time arrivals between 0.5 and 0.7, The distribution of proportion of on-time arrivals is roughly symmetric and bell-shaped.</p>
<p>The distribution shown in this histogram is called the <strong>sampling distribution for $</strong>. We can gauge how much the proportion of on-time arrivals varies between samples by calculating the standard deviation of this sampling distribution. The standard deviation of a sampling distribution for a statistic is also called the <strong>standard error</strong> of the statistic. In this case it represents the standard error <span class="math inline">\(\hat{p}\)</span> (the proportion of on-time arrivals), and is denoted <span class="math inline">\(\text{SE}(\hat{p})\)</span>. This standard error is shown below.</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="interval-estimation.html#cb144-1" aria-hidden="true" tabindex="-1"></a>SE_p_hat <span class="ot">&lt;-</span> <span class="fu">sd</span>(Samples_df<span class="sc">$</span>p_hat_val)</span>
<span id="cb144-2"><a href="interval-estimation.html#cb144-2" aria-hidden="true" tabindex="-1"></a>SE_p_hat</span></code></pre></div>
<pre><code>## [1] 0.05659102</code></pre>
<p>**Vocabulary<em>:</em></p>
<ul>
<li>The <strong>sampling distribution</strong> of a statistic is the distribution of values the statistic takes on across many different samples of a given size.<br />
</li>
<li>The <strong>standard error</strong> of a statistic is the standard deviation of that statistic’s sampling distribution. It measures how much the statistic varies between different samples of a given size.</li>
</ul>
<p>In this rare situation, we actually have data on all 20,591 flights from New York to Chicago in 2013 (our entire population), Let’s calculate the true value of the population parameter <span class="math inline">\(p\)</span>, the proportion of flights that arrived on-time in our actual population.</p>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="interval-estimation.html#cb146-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sum</span>(Flights_NY_CHI<span class="sc">$</span>ontime <span class="sc">==</span> <span class="st">&quot;Y&quot;</span>)<span class="sc">/</span><span class="dv">20591</span></span>
<span id="cb146-2"><a href="interval-estimation.html#cb146-2" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.6079841</code></pre>
<p>In fact, just over 60% of all flights in the population arrived on time.</p>
<p>The sampling distribution for the proportion of on-time flights is shown again below. The true proportion of on-time flights is marked by the green dotted line. The gold bar at the bottom of the histogram represents the range of sample proportions that lie within <span class="math inline">\(\pm 2\)</span> standard errors of the true population proportion of flights that arrived on time.</p>
<p>0.6079841 - 2(0.056591) to 0.6079841 + 2(0.056591)</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="interval-estimation.html#cb148-1" aria-hidden="true" tabindex="-1"></a>Prop_Samp_Dist<span class="sc">+</span> <span class="fu">geom_vline</span>(<span class="at">xintercept=</span>p, <span class="at">color=</span><span class="st">&quot;green&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>, <span class="at">linewidth=</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>p <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat,<span class="at">xend=</span>p <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-117-1.png" width="672" /></p>
<p>We calculate the proportion of samples whose proportion of on-time arrivals lies within <span class="math inline">\(\pm 2\)</span> standard errors of the true proportion.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="interval-estimation.html#cb149-1" aria-hidden="true" tabindex="-1"></a>Lower <span class="ot">&lt;-</span> p <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat</span>
<span id="cb149-2"><a href="interval-estimation.html#cb149-2" aria-hidden="true" tabindex="-1"></a>Upper <span class="ot">&lt;-</span> p <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat</span>
<span id="cb149-3"><a href="interval-estimation.html#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>((Samples_df<span class="sc">$</span>p_hat_val <span class="sc">&gt;=</span>Lower) <span class="sc">&amp;</span> (Samples_df<span class="sc">$</span>p_hat_val <span class="sc">&lt;=</span> Upper))</span></code></pre></div>
<pre><code>## [1] 9539</code></pre>
<p><code>r sum((Samples_df$p_hat &gt;=Lower) &amp; (Samples_df$p_hat &lt;= Upper))</code> out of the 10,000 simulations (approximately 95%) of the samples produced proportions within <span class="math inline">\(\pm 2\)</span> standard errors of the true population proportion of on-time flights.</p>
</div>
<div id="confidence-intervals" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Confidence Intervals<a href="interval-estimation.html#confidence-intervals" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In a real situation, we won’t have access to the entire population of flights, only the flights in a single sample. For example, recall our original sample of 75 flights, in which we observed a proportion of on-time arrivals of <span class="math inline">\(\hat{p}=\)</span> 0.52.</p>
<p>Since we now know that 95% of all samples produce proportions that lie within two standard errors of the population proportion, we can obtain an estimate of the population proportion <span class="math inline">\(p\)</span> by adding and subtracting <span class="math inline">\(2\times \text{SE}(\hat{p})\)</span> from our observed sample proportion <span class="math inline">\(\hat{p}\)</span>. Such an interval is called an approximate 95% <strong>confidence interval</strong> for the true population proportion <span class="math inline">\(p\)</span>.</p>
<p><strong>Approximate 95% Confidence Interval for <span class="math inline">\(\hat{p}\)</span></strong></p>
<p><span class="math display">\[
\hat{p} \pm 2\times \text{SE}(\hat{p})
\]</span></p>
<p>The confidence interval, based on our original sample, is calculated below.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="interval-estimation.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(p_hat <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat, p_hat <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat) </span></code></pre></div>
<pre><code>## [1] 0.406818 0.633182</code></pre>
<p>Based on our sample of 75 flights, we can be 95% confident that the true proportion of on-time arrivals among all 2013 flights from New York to Chicago is between 0.406818 and <code>p_hat + 2*SE_p_hat</code>.</p>
<p>In fact, knowing what we do about the true value of the population parameter <span class="math inline">\(p\)</span>, we can see that our confidence interval does indeed contain this value. Of course, in a real situaiton, we won’t know the true value of the population parameter, so we won’t know for sure whether or not our confidence interval contains this true parameter value.</p>
<p>A pertinent question at this stage would be ``What does 95% confidence mean?“. To answer that, let’s explore what happens when we calculate confidence intervals based on estimates many different samples. For each of our 10,000 different samples taken from our population, we’ll add and subtract two standard errors from the sample proportion <span class="math inline">\(\hat{p}\)</span> corresponding to that sample.</p>
<p>The table below displays the value of <span class="math inline">\(\hat{p}\)</span>, for the first 20 samples we took, along with the lower and upper bounds of the confidence interval, and whether or not the confidence interval contains the true parameter value <span class="math inline">\(p\)</span> (either <code>TRUE</code> or <code>FALSE</code>).</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="interval-estimation.html#cb153-1" aria-hidden="true" tabindex="-1"></a>Samples_df <span class="ot">&lt;-</span> Samples_df <span class="sc">%&gt;%</span> <span class="fu">mutate</span>( <span class="at">Lower =</span> p_hat_val <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat, </span>
<span id="cb153-2"><a href="interval-estimation.html#cb153-2" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">Upper =</span> p_hat_val <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat,</span>
<span id="cb153-3"><a href="interval-estimation.html#cb153-3" aria-hidden="true" tabindex="-1"></a>                                     <span class="at">Contains =</span> p <span class="sc">&gt;=</span> Lower <span class="sc">&amp;</span> p <span class="sc">&lt;=</span> Upper)</span>
<span id="cb153-4"><a href="interval-estimation.html#cb153-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(Samples_df, <span class="dv">20</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Sample</th>
<th align="right">p_hat_val</th>
<th align="right">Lower</th>
<th align="right">Upper</th>
<th align="left">Contains</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.6533333</td>
<td align="right">0.5401513</td>
<td align="right">0.7665154</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.5333333</td>
<td align="right">0.4201513</td>
<td align="right">0.6465154</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.5866667</td>
<td align="right">0.4734846</td>
<td align="right">0.6998487</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.6933333</td>
<td align="right">0.5801513</td>
<td align="right">0.8065154</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.5866667</td>
<td align="right">0.4734846</td>
<td align="right">0.6998487</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">0.6666667</td>
<td align="right">0.5534846</td>
<td align="right">0.7798487</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">0.6133333</td>
<td align="right">0.5001513</td>
<td align="right">0.7265154</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">0.5866667</td>
<td align="right">0.4734846</td>
<td align="right">0.6998487</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">0.6533333</td>
<td align="right">0.5401513</td>
<td align="right">0.7665154</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">0.6533333</td>
<td align="right">0.5401513</td>
<td align="right">0.7665154</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="right">0.6133333</td>
<td align="right">0.5001513</td>
<td align="right">0.7265154</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="right">0.5866667</td>
<td align="right">0.4734846</td>
<td align="right">0.6998487</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="right">0.6133333</td>
<td align="right">0.5001513</td>
<td align="right">0.7265154</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">0.4800000</td>
<td align="right">0.3668180</td>
<td align="right">0.5931820</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">0.6000000</td>
<td align="right">0.4868180</td>
<td align="right">0.7131820</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="right">0.4400000</td>
<td align="right">0.3268180</td>
<td align="right">0.5531820</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">17</td>
<td align="right">0.4933333</td>
<td align="right">0.3801513</td>
<td align="right">0.6065154</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">18</td>
<td align="right">0.5733333</td>
<td align="right">0.4601513</td>
<td align="right">0.6865154</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="right">19</td>
<td align="right">0.6400000</td>
<td align="right">0.5268180</td>
<td align="right">0.7531820</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">0.5600000</td>
<td align="right">0.4468180</td>
<td align="right">0.6731820</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>The graphic below visualizes the confidence intervals produced using the estimates from the first 100 samples. The green dotted line indicates the true value of <span class="math inline">\(p\)</span>. The black dots indicate the value of <span class="math inline">\(\hat{p}\)</span> for each sample. Intervals that do in fact contain the true value of <span class="math inline">\(p\)</span> are shown in blue, and intervals that do not contain the true value of <span class="math inline">\(p\)</span> are shown in green.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="interval-estimation.html#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Samples_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,], <span class="fu">aes</span>(<span class="at">y=</span>Sample, <span class="at">x=</span>p_hat_val)) <span class="sc">+</span>    </span>
<span id="cb154-2"><a href="interval-estimation.html#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb154-3"><a href="interval-estimation.html#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> Lower, <span class="at">xmax =</span> Upper, <span class="at">color=</span>Contains))  <span class="sc">+</span> </span>
<span id="cb154-4"><a href="interval-estimation.html#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Confidence Interval&quot;</span>) <span class="sc">+</span> </span>
<span id="cb154-5"><a href="interval-estimation.html#cb154-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Sample&quot;</span>) <span class="sc">+</span> </span>
<span id="cb154-6"><a href="interval-estimation.html#cb154-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> p, <span class="at">color=</span><span class="st">&quot;green&quot;</span>, <span class="at">linetype=</span><span class="st">&quot;dotted&quot;</span>, <span class="at">size=</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-121-1.png" width="960" /></p>
<p>Out of these 100 samples, 0 contain the true value of the population parameter <span class="math inline">\(p\)</span>. This is close to the 95% confidence level.</p>
<p>The picture shows confidence intervals produced by the first 100 samples, but we actually took 10,000 different samples of 75 flights. Let’s calculate how many of these samples produced confidence intervals that contain the true value of <span class="math inline">\(p\)</span>.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="interval-estimation.html#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(Samples_df<span class="sc">$</span>Contains <span class="sc">==</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 9539</code></pre>
<p>Again, notice that close to 95% of the samples produced confidence intervals contain the true population parameter <span class="math inline">\(p\)</span>. Note that for the red intervals that do not contain <span class="math inline">\(p\)</span> nothing was done incorrectly. The sample was taken at random, and the confidence interval was calculated using the correct formula. It just happened that by chance, we obtained a sample proportion <span class="math inline">\(\hat{p}\)</span> that was unusually high or low, leading to an interval that did not capture the true population parameter. This, of course, happens rarely, and approximately 95% of the samples do, in fact, result in intervals that contain the true value of <span class="math inline">\(p\)</span>.</p>
<p>This brings us back to the question “what does 95% confidence mean?”. An approximate 95% confidence interval means that if we take a large number of samples and calculate confidence intervals from each of them, then approximately 95% of the samples will produce intervals containing the true population parameter. In reality, we’ll only have on sample, and won’t know whether or not our interval contains the true parameter value. Assuming we have taken the sample and calculated the interval correctly, we can rest assured in the knowledge that that 95% of all intervals taken would contain the true parameter value, and hope that ours is among that 95%.</p>
<p>We calculated the confidence interval by taking our sample statistic <span class="math inline">\(\hat{p}\)</span> plus/minus two standard errors. Confidence intervals that are calculated by adding and subtracting a certain number of standard errors from the sample statistic are called <strong>standard error confidence intervals</strong>. This approach will work as long as the sampling distribution is symmetric and bell-shaped. Probability theory tells us that in a symmetric and bell-shaped distribution, approximately 95% of the area lies within two standard errors of the center of the distribution, given by the true parameter value. We will, however, see that this approach will not work in all cases. Not all statistics produce sampling distributions that are symmetric and bell-shaped, and we will need an alternative way to calculate confidence intervals in these situations.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="interval-estimation.html#cb157-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;Emp_Rule.png&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-123"></span>
<img src="Emp_Rule.png" alt="Image from https://openintro-ims.netlify.app/foundations-mathematical" width="1800" />
<p class="caption">
Figure 3.1: Image from <a href="https://openintro-ims.netlify.app/foundations-mathematical" class="uri">https://openintro-ims.netlify.app/foundations-mathematical</a>
</p>
</div>
<p>If we want to use a level of confidence that is different than 95%, we can adjust the value we multiply the standard error by. In general, a standard error confidence interval has the form</p>
<p><span class="math display">\[
\text{Statistic } \pm m\times \text{Standard Error},
\]</span></p>
<p>where the value of <span class="math inline">\(m\)</span> depends on the desired level of confidence.</p>
<p>Of course, you might ask why we needed to calculate a confidence interval for the proportion of on-time flights in the first place, since we actually have data on all 20,591 flights in the population and already know the true proportion of on-time arrivals to be 0.608. The answer is that we don’t. But, in most real situations, we will only have data from a single sample, not the entire population, and we won’t know the true population parameter. We’ll be able to build on the ideas of sampling distributions and standard error that we learned about in this section to calculate confidence intervals in those scenarios.</p>
</div>
</div>
<div id="bootstrapping" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Bootstrapping<a href="interval-estimation.html#bootstrapping" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="mercury-levels-in-florida-lakes" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Mercury Levels in Florida Lakes<a href="interval-estimation.html#mercury-levels-in-florida-lakes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A 2004 study by Lange, T., Royals, H. and Connor, L. examined Mercury accumulation in large-mouth bass, taken from a sample of 53 Florida Lakes. If Mercury accumulation exceeds 0.5 ppm, then there are environmental concerns. In fact, the legal safety limit in Canada is 0.5 ppm, although it is 1 ppm in the United States.</p>
<div class="figure"><span style="display:block;" id="fig:Bass"></span>
<img src="Bass.png" alt="https://www.maine.gov/ifw/fish-wildlife/fisheries/species-information/largemouth-bass.html" width="50%" />
<p class="caption">
Figure 3.2: <a href="https://www.maine.gov/ifw/fish-wildlife/fisheries/species-information/largemouth-bass.html" class="uri">https://www.maine.gov/ifw/fish-wildlife/fisheries/species-information/largemouth-bass.html</a>
</p>
</div>
<p>In our sample, we have data on 53 lakes, out of more than 30,000 lakes in the the state of Florida. We’ll attempt to draw conclusions about the entire population, consisting of all lakes in Florida, using data from our sample of 53. It is not clear how the lakes in this sample of 53 were selected, or how representative they are of all lakes in the state of Florida. Let’s assume for our purposes that the lakes in the sample can be reasonably thought of as being representative of all lakes in Florida.</p>
<p>The mercury levels of the first 10 lakes in the sample are shown in the table below.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="interval-estimation.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;FloridaLakes&quot;</span>)</span>
<span id="cb158-2"><a href="interval-estimation.html#cb158-2" aria-hidden="true" tabindex="-1"></a>FloridaLakes <span class="ot">&lt;-</span> FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Mercury =</span> AvgMercury)</span></code></pre></div>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="interval-estimation.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury), <span class="dv">10</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">ID</th>
<th align="left">Lake</th>
<th align="right">Mercury</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">Alligator</td>
<td align="right">1.23</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">Annie</td>
<td align="right">1.33</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">Apopka</td>
<td align="right">0.04</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">Blue Cypress</td>
<td align="right">0.44</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">Brick</td>
<td align="right">1.20</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">Bryant</td>
<td align="right">0.27</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="left">Cherry</td>
<td align="right">0.48</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="left">Crescent</td>
<td align="right">0.19</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="left">Deer Point</td>
<td align="right">0.83</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="left">Dias</td>
<td align="right">0.81</td>
</tr>
</tbody>
</table>
<p>The histogram shows the distribution of mercury levels in the 53 lakes in the sample. Lakes exceeding the US standard of 1 ppm are shown in red.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="interval-estimation.html#cb160-1" aria-hidden="true" tabindex="-1"></a>Lakes_Hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>FloridaLakes, <span class="fu">aes</span>(<span class="at">x=</span>Mercury)) <span class="sc">+</span> </span>
<span id="cb160-2"><a href="interval-estimation.html#cb160-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Mercury<span class="sc">&lt;=</span><span class="dv">1</span>), <span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb160-3"><a href="interval-estimation.html#cb160-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Mercury Levels in Sample of 53 Florida Lakes&quot;</span>) <span class="sc">+</span> </span>
<span id="cb160-4"><a href="interval-estimation.html#cb160-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mercury Level&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>()</span>
<span id="cb160-5"><a href="interval-estimation.html#cb160-5" aria-hidden="true" tabindex="-1"></a>Lakes_Hist</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-126-1.png" width="672" /></p>
<p>The proportion of lakes with mercury levels exceeding 1 ppm is calculated below.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="interval-estimation.html#cb161-1" aria-hidden="true" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> <span class="fu">sum</span>(FloridaLakes<span class="sc">$</span>Mercury <span class="sc">&gt;</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">53</span></span>
<span id="cb161-2"><a href="interval-estimation.html#cb161-2" aria-hidden="true" tabindex="-1"></a>p_hat</span></code></pre></div>
<pre><code>## [1] 0.1132075</code></pre>
<p>We see that in our sample of 53 lakes, approximately 11% have mercury levels exceeding the US standard of 1 ppm. Suppose we want to estimate the proportion of all Florida Lakes whose mercury level exceeds this standard. As we saw in the previous section, we would not expect the population proportion to exactly match the sample, due to random variability between samples. We can use the sample proportion as an estimate (<span class="math inline">\(\hat{p} = 0.1132\)</span>), and construct a confidence interval for the unknown population proportion <span class="math inline">\(p\)</span>.</p>
<p>In order to construct the confidence interval, we need to know how much the sample proportion of lakes exceeding 1 ppm <span class="math inline">\(\hat{p}\)</span> could vary between different samples of size 53. That is, we need to know the standard error of <span class="math inline">\(\hat{p}\)</span>. In the previous section, we calculated the standard error by taking 10,000 different samples of the same size as ours from the population, calculating the proportion for each sample, and then calculating the standard deviation of the proportions obtained from these 10,000 different samples. This procedure will not work here, however, because unlike the previous example where we really did have data on the entire population of all flights from New York to Chicago, we do not have data on all 30,000+ lakes in Florida. We cannot take a lot of different samples of size 53 from the population of all lakes, and thus, cannot obtain the sampling distribution for the the proportion of lakes exceeding 1 ppm, or estimate the standard error of <span class="math inline">\(\hat{p}\)</span>.</p>
</div>
<div id="bootstrap-sampling" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Bootstrap Sampling<a href="interval-estimation.html#bootstrap-sampling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All we have is a single sample of 53 lakes. We need to figure out how much the proportion of lakes with mercury levels exceeding 1 ppm would vary between different samples of size 53, using only the information contained in our one sample.</p>
<p>To do this, we’ll implement a popular simulation-based strategy, known as <strong>bootstrapping</strong>.</p>
<p>Let’s assume our sample is representative of all Florida lakes. Then, we’ll duplicate the sample many times to create a large set that will look like the population of all Florida Lakes. We can then draw samples of 53 from that large population, and record the mean mercury level for each sample of 53.</p>
<p>An illustration of the bootstrapping procedure is shown below, using a sample of 12 colored dots, instead of the 53 lakes.</p>
<p><img src="Bootstrap_Idea.png" width="100%" /></p>
<p>In fact, duplicating the sample many times and selecting new samples of size <span class="math inline">\(n\)</span> has the same effect as drawing samples of size <span class="math inline">\(n\)</span> from the original sample, by putting the item drawn back in each time, a procedure called <strong>sampling with replacement</strong>. Thus, we can skip the step of copying/pasting the sample many times, and instead draw our samples with replacement.</p>
<p>This means that in each new sample, some lakes will be drawn multiple times and others not at all. It also ensures that each sample is different, allowing us to estimate variability in the sample mean between the different samples of size 53.</p>
<p>An illustration of the concept of bootstrapping, using sampling with replacement is shown below.</p>
<p><img src="Bootstrap.png" width="100%" /></p>
<p>The variability in sample means in our newly drawn samples is used to approximate the variability in proportion <span class="math inline">\(\hat{p}\)</span> that would occur between different samples of 53 lakes, drawn from the population of all Florida Lakes.</p>
<p>The point of bootstrapping is to observe how much a statistic (in this case the proportion of lakes with Mercury levels exceeding 1 ppm) varies between bootstrap samples. This can act as an estimate of how much that statistic would vary between different samples of size <span class="math inline">\(n\)</span>, drawn from the population.</p>
<p>The steps of bootstrap sampling can be summarized in the following algorithm.</p>
<p><strong>Bootstrap Algorithm</strong></p>
<p>For an original sample of size <span class="math inline">\(n\)</span>:</p>
<ol style="list-style-type: decimal">
<li><p>Take a sample size <span class="math inline">\(n\)</span> by randomly sampling from the original, with replacement. Thus, some observations will show up multiple times, and others not at all. This sample is called a <strong>bootstrap sample</strong>.</p></li>
<li><p>Calculate the statistic of interest in the bootstrap sample (in this case <span class="math inline">\(\hat{p}\)</span>, the proportion of lakes whose mercury levels exceed 1 ppm).</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of the statistic of interest that is calculated in each bootstrap sample.</p></li>
<li><p>Look at the distribution of the statistic across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for the statistic of interest.</p></li>
</ol>
</div>
<div id="bootstrap-samples-of-lakes" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Bootstrap Samples of Lakes<a href="interval-estimation.html#bootstrap-samples-of-lakes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The <code>sample_n()</code> function samples the specified number rows from a data frame, with or without replacement.</p>
<p>The lakes in the first sample are shown below. Notice that some lakes occur multiple times, and others not at all.</p>
<p><strong>Bootstrap Sample 1</strong></p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="interval-estimation.html#cb163-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb163-2"><a href="interval-estimation.html#cb163-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake         Mercury
##    &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;
##  1     2 Annie           1.33
##  2     3 Apopka          0.04
##  3     4 Blue Cypress    0.44
##  4     6 Bryant          0.27
##  5     9 Deer Point      0.83
##  6     9 Deer Point      0.83
##  7    10 Dias            0.81
##  8    11 Dorr            0.71
##  9    12 Down            0.5 
## 10    12 Down            0.5 
## # ℹ 43 more rows</code></pre>
<p>We calculate the proportion of lakes with mercury levels exceeding 1 ppm in this bootstrap sample. Note that if a lake shows up more than once in the bootstrap sample, then it is counted however many times it shows up.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="interval-estimation.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(BootstrapSample1<span class="sc">$</span>Mercury <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">53</span></span></code></pre></div>
<pre><code>## [1] 0.0754717</code></pre>
<p>*<strong>Bootstrap Sample #2</strong></p>
<p>We take a second bootstrap sample. Notice that the lakes chosen and omitted differ from the first sample.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="interval-estimation.html#cb167-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb167-2"><a href="interval-estimation.html#cb167-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake         Mercury
##    &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;
##  1     1 Alligator       1.23
##  2     3 Apopka          0.04
##  3     4 Blue Cypress    0.44
##  4     4 Blue Cypress    0.44
##  5     5 Brick           1.2 
##  6     7 Cherry          0.48
##  7     8 Crescent        0.19
##  8     8 Crescent        0.19
##  9     8 Crescent        0.19
## 10     8 Crescent        0.19
## # ℹ 43 more rows</code></pre>
<p>Proportion exceeding 1 ppm:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="interval-estimation.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(BootstrapSample2<span class="sc">$</span>Mercury <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">53</span></span></code></pre></div>
<pre><code>## [1] 0.0754717</code></pre>
<p><strong>Bootstrap Sample #3</strong></p>
<p>We’ll take one more bootstrap sample and calculate the proportion of lakes with mercury levels exceeding 1 ppm.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="interval-estimation.html#cb171-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb171-2"><a href="interval-estimation.html#cb171-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake       Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
##  1     5 Brick         1.2 
##  2     5 Brick         1.2 
##  3     6 Bryant        0.27
##  4     6 Bryant        0.27
##  5     7 Cherry        0.48
##  6     8 Crescent      0.19
##  7     8 Crescent      0.19
##  8     9 Deer Point    0.83
##  9     9 Deer Point    0.83
## 10    10 Dias          0.81
## # ℹ 43 more rows</code></pre>
<p>Proportion exceeding 1 ppm:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="interval-estimation.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(BootstrapSample3<span class="sc">$</span>Mercury <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">53</span></span></code></pre></div>
<pre><code>## [1] 0.0754717</code></pre>
</div>
<div id="bootstrap-distribution" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> Bootstrap Distribution<a href="interval-estimation.html#bootstrap-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have seen how bootstrap sampling works, we’ll take a large number (10,000) different bootstrap samples and examine how the proportion of lakes with mercury levels exceeding 1 ppm varies between samples.</p>
<p>We’ll use a <code>for-loop</code> to take many different bootstrap samples and record the observed proportion in a vector called <code>p_hat_b</code></p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="interval-estimation.html#cb175-1" aria-hidden="true" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> <span class="fu">sum</span>(FloridaLakes<span class="sc">$</span>Mercury <span class="sc">&gt;</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">53</span> <span class="co">#calculate sample statistic</span></span>
<span id="cb175-2"><a href="interval-estimation.html#cb175-2" aria-hidden="true" tabindex="-1"></a>Bootstrap_prop <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>)   <span class="co">#setup vector to hold bootstrap statistics</span></span>
<span id="cb175-3"><a href="interval-estimation.html#cb175-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb175-4"><a href="interval-estimation.html#cb175-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb175-5"><a href="interval-estimation.html#cb175-5" aria-hidden="true" tabindex="-1"></a>BootstrapSample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="co">#take bootstrap sample</span></span>
<span id="cb175-6"><a href="interval-estimation.html#cb175-6" aria-hidden="true" tabindex="-1"></a>Bootstrap_prop[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(BootstrapSample<span class="sc">$</span>Mercury <span class="sc">&gt;</span> <span class="dv">1</span>)<span class="sc">/</span><span class="dv">53</span> <span class="co"># calc. prop exceeding 1</span></span>
<span id="cb175-7"><a href="interval-estimation.html#cb175-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb175-8"><a href="interval-estimation.html#cb175-8" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Prop <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Bootstrap_prop)  <span class="co">#store values in a dataframe</span></span></code></pre></div>
<p>The distribution of proportions observed in the 10,000 different bootstrap samples is shown below. This distribution is called the <strong>bootstrap distribution.</strong></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="interval-estimation.html#cb176-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Prop_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_Bootstrap_Prop, <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_prop)) <span class="sc">+</span>  </span>
<span id="cb176-2"><a href="interval-estimation.html#cb176-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb176-3"><a href="interval-estimation.html#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Prop &gt; 1 in Bootstrap Sample &quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb176-4"><a href="interval-estimation.html#cb176-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Bootstrap Distribution for Prop. of Lakes Exeeding 1 ppm Hg&quot;</span>) <span class="sc">+</span> </span>
<span id="cb176-5"><a href="interval-estimation.html#cb176-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb176-6"><a href="interval-estimation.html#cb176-6" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Prop_plot</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-137-1.png" width="672" /></p>
</div>
<div id="bootstrap-se-confidence-interval" class="section level3 hasAnchor" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> Bootstrap SE Confidence Interval<a href="interval-estimation.html#bootstrap-se-confidence-interval" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We calculate the standard deviation of this bootstrap distribution, which is an estimate of the standard error of <span class="math inline">\(\hat{p}\)</span>.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="interval-estimation.html#cb177-1" aria-hidden="true" tabindex="-1"></a>SE_p_hat <span class="ot">&lt;-</span> <span class="fu">sd</span>(Lakes_Bootstrap_Prop<span class="sc">$</span>Bootstrap_prop)</span></code></pre></div>
<p>Since the bootstrap distribution is roughly symmetric and bell-shaped, we can calculate a 95% confidence interval for the proportion of all Florida lakes with mercury levels exceeding 1 ppm, using bootstrap standard error confidence interval method</p>
<p><span class="math display">\[
\hat{p} \pm 2\times\text{SE}(\hat{p})
\]</span></p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="interval-estimation.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(p_hat <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat, p_hat <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat)</span></code></pre></div>
<pre><code>## [1] 0.02655044 0.19986466</code></pre>
<p>We are 95% confident that the proportion of all Florida lakes with mercury levels exceeding 1 ppm is between 0.0265504 and 0.1998647.</p>
<p>The gold bar at the bottom of the bootstrap distribution represents this 95% confidence interval.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="interval-estimation.html#cb180-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Prop_plot <span class="sc">+</span> </span>
<span id="cb180-2"><a href="interval-estimation.html#cb180-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>p_hat <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat,<span class="at">xend=</span>p_hat <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_p_hat, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>),</span>
<span id="cb180-3"><a href="interval-estimation.html#cb180-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-140-1.png" width="672" /></p>
</div>
<div id="bootstrap-distribution-vs-sampling-distribution" class="section level3 hasAnchor" number="3.2.6">
<h3><span class="header-section-number">3.2.6</span> Bootstrap Distribution vs Sampling Distribution<a href="interval-estimation.html#bootstrap-distribution-vs-sampling-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We stated that the standard error of the bootstrap distribution is meant to give us and estimate of the standard error of the statistic of interest (<span class="math inline">\(\hat{p}\)</span> in this case). We do note, however, that the bootstrap distribution is not the same as the sampling distribution for a statistic illustrated in the previous section. The sampling distribution shows the distribution of values the statistic would take on accross many different samples drawn from the population. As such, it will be centered at the true population parameter (<span class="math inline">\(p\)</span> in this case). The bootstrap distribution, on the other hand, shows us the distribution of values the statistic takes on across different bootstrap samples drawn from the original sample, using replacement. Since it comes entirely from the original sample, rather than the population, it will be centered at the sample statistic ( in this case <span class="math inline">\(\hat{p}\)</span>), rather than the unknown <span class="math inline">\(p\)</span>. Nevertheless, the amount of variability in a statistic, calculated between different bootstrap samples, is often a reasonable approximation of the amount of variability we would observe in that statistic if we could take many samples of the same size from the entire population.</p>
</div>
</div>
<div id="bootstrap-confidence-interval-example" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Bootstrap Confidence Interval Example<a href="interval-estimation.html#bootstrap-confidence-interval-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="bootstrapping-other-statistics" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Bootstrapping Other Statistics<a href="interval-estimation.html#bootstrapping-other-statistics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ve seen how to use bootstrapping to calculate confidence intervals for an unknown population parameter <span class="math inline">\(p\)</span>, using an estimate <span class="math inline">\(\hat{p}\)</span>, calculated from a sample of size <span class="math inline">\(n\)</span>. This procedure can be applied to calculate confidence intervals for a wide range of population parameters, using statistics calculated from a sample.</p>
<p>For example, we could calculate confidence intervals any of the following parameters, using the corresponding sample statistic.</p>
<table>
<colgroup>
<col width="35%" />
<col width="32%" />
<col width="32%" />
</colgroup>
<thead>
<tr class="header">
<th>Context</th>
<th>Parameter</th>
<th>Statistic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Proportion</td>
<td><span class="math inline">\(p\)</span></td>
<td><span class="math inline">\(\hat{p}\)</span></td>
</tr>
<tr class="even">
<td>Mean</td>
<td><span class="math inline">\(\mu\)</span></td>
<td><span class="math inline">\(\bar{x}\)</span></td>
</tr>
<tr class="odd">
<td>Standard Deviation</td>
<td><span class="math inline">\(\sigma\)</span></td>
<td><span class="math inline">\(s\)</span></td>
</tr>
<tr class="even">
<td>Median</td>
<td>no comon abbreviations</td>
<td></td>
</tr>
<tr class="odd">
<td>Difference in Means</td>
<td><span class="math inline">\(\mu_2-\mu_1\)</span></td>
<td><span class="math inline">\(\bar{x}_2 - \bar{x}_1\)</span></td>
</tr>
<tr class="even">
<td>Regression Coefficient</td>
<td><span class="math inline">\(\beta_j\)</span></td>
<td><span class="math inline">\(b_j\)</span></td>
</tr>
<tr class="odd">
<td>Estimated Regression Response</td>
<td><span class="math inline">\(\beta_0 + \beta_1x_{i1} + \ldots + \beta_px_{ip}\)</span></td>
<td><span class="math inline">\(b_0 + b_1x_{i1} + \ldots + b_px_{ip}\)</span></td>
</tr>
</tbody>
</table>
<p>We follow the same algorithm as we did when working with a proportion, and simply calculate whatever statistic we are interested in step 2, in place of <span class="math inline">\(\hat{p}\)</span>, as we did previously.</p>
<p>The bootstrap algorithm is given again, below.</p>
<p><strong>Bootstrap Algorithm</strong></p>
<p>For an original sample of size <span class="math inline">\(n\)</span>:</p>
<ol style="list-style-type: decimal">
<li><p>Take a sample of size <span class="math inline">\(n\)</span> by randomly sampling from the original sample with replacement. (Thus some observations will show up multiple times and others not at all.)</p></li>
<li><p>Calculate the statistic of interest in the bootstrap sample.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of the statistic of interest that is calculated in each bootstrap sample.</p></li>
<li><p>Look at the distribution of the statistic across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for the statistic of interest.</p></li>
</ol>
<p>We’ll now go through examples, calculating bootstrap confidence intervals for each of the parameters listed above.</p>
</div>
<div id="ci-for-mean" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> CI for Mean<a href="interval-estimation.html#ci-for-mean" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The histogram shows the distribution of mercury levels of the 53 lakes in our sample. The mean and standard deviation in mercury levels for these 53 lakes is shown.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="interval-estimation.html#cb181-1" aria-hidden="true" tabindex="-1"></a>Lakes_Hist <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>FloridaLakes, <span class="fu">aes</span>(<span class="at">x=</span>Mercury)) <span class="sc">+</span> </span>
<span id="cb181-2"><a href="interval-estimation.html#cb181-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>, <span class="at">binwidth =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb181-3"><a href="interval-estimation.html#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Mercury Levels in Sample of Florida Lakes&quot;</span>) <span class="sc">+</span> </span>
<span id="cb181-4"><a href="interval-estimation.html#cb181-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mercury Level&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) </span>
<span id="cb181-5"><a href="interval-estimation.html#cb181-5" aria-hidden="true" tabindex="-1"></a>Lakes_Hist</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
<p>We’ll calculate the mean and median mercury level for the 53 lakes in the sample.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="interval-estimation.html#cb182-1" aria-hidden="true" tabindex="-1"></a>Lakes_Stats <span class="ot">&lt;-</span> FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">MeanHg =</span> <span class="fu">mean</span>(Mercury), </span>
<span id="cb182-2"><a href="interval-estimation.html#cb182-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">StDevHG =</span> <span class="fu">sd</span>(Mercury),</span>
<span id="cb182-3"><a href="interval-estimation.html#cb182-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">N=</span><span class="fu">n</span>())</span>
<span id="cb182-4"><a href="interval-estimation.html#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(Lakes_Stats)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">MeanHg</th>
<th align="right">StDevHG</th>
<th align="right">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.5271698</td>
<td align="right">0.3410356</td>
<td align="right">53</td>
</tr>
</tbody>
</table>
<p>We want to calculate a 95% confidence interval for the mean mercury level among all Florida lakes.
We’ll use bootstrapping again, this time using the sample mean, rather than the proportion exceeding 1 ppm, as our statistic of interest.</p>
<p><strong>Bootstrap Steps</strong></p>
<ol style="list-style-type: decimal">
<li><p>Take a sample of 53 lakes by randomly sampling from the original sample of 53 lakes, with replacement.</p></li>
<li><p>Calculate the mean mercury level in the bootstrap sample.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of the mean mercury level in each bootstrap sample.</p></li>
<li><p>Look at the distribution of the mean across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for the mean mercury level.</p></li>
</ol>
<p>We’ll illustrate the procedure on 3 bootstrap samples.</p>
<p><strong>Bootstrap Sample 1</strong></p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="interval-estimation.html#cb183-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb183-2"><a href="interval-estimation.html#cb183-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake              Mercury
##    &lt;int&gt; &lt;chr&gt;               &lt;dbl&gt;
##  1     2 Annie                1.33
##  2     2 Annie                1.33
##  3     3 Apopka               0.04
##  4     4 Blue Cypress         0.44
##  5     5 Brick                1.2 
##  6    12 Down                 0.5 
##  7    14 East Tohopekaliga    1.16
##  8    13 Eaton                0.49
##  9    16 George               0.15
## 10    16 George               0.15
## # ℹ 43 more rows</code></pre>
<p>We calculate the mean mercury level among the lakes in the bootstrap sample.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="interval-estimation.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(BootstrapSample1<span class="sc">$</span>Mercury)</span></code></pre></div>
<pre><code>## [1] 0.5292453</code></pre>
<p><strong>Bootstrap Sample #2</strong></p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="interval-estimation.html#cb187-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb187-2"><a href="interval-estimation.html#cb187-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake       Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
##  1     1 Alligator     1.23
##  2     1 Alligator     1.23
##  3     1 Alligator     1.23
##  4     2 Annie         1.33
##  5     3 Apopka        0.04
##  6     3 Apopka        0.04
##  7     3 Apopka        0.04
##  8     9 Deer Point    0.83
##  9    12 Down          0.5 
## 10    12 Down          0.5 
## # ℹ 43 more rows</code></pre>
<p>Mean Mercury Level:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="interval-estimation.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(BootstrapSample2<span class="sc">$</span>Mercury)</span></code></pre></div>
<pre><code>## [1] 0.4777358</code></pre>
<p><strong>Bootstrap Sample #3</strong></p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="interval-estimation.html#cb191-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb191-2"><a href="interval-estimation.html#cb191-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake      Mercury
##    &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;
##  1     1 Alligator    1.23
##  2     3 Apopka       0.04
##  3     6 Bryant       0.27
##  4     7 Cherry       0.48
##  5     8 Crescent     0.19
##  6    10 Dias         0.81
##  7    10 Dias         0.81
##  8    11 Dorr         0.71
##  9    12 Down         0.5 
## 10    12 Down         0.5 
## # ℹ 43 more rows</code></pre>
<p>Mean Mercury Level:</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="interval-estimation.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(BootstrapSample3<span class="sc">$</span>Mercury)</span></code></pre></div>
<pre><code>## [1] 0.4860377</code></pre>
<p>Now, we’ll take 10,000 bootstrap samples, and record the mean mercury concentration in each sample.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="interval-estimation.html#cb195-1" aria-hidden="true" tabindex="-1"></a>mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(FloridaLakes<span class="sc">$</span>Mercury)  <span class="co">#calculate sample statistic</span></span>
<span id="cb195-2"><a href="interval-estimation.html#cb195-2" aria-hidden="true" tabindex="-1"></a>Bootstrap_Mean <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>) <span class="co"># setup vector to hold bootstrap statistics</span></span>
<span id="cb195-3"><a href="interval-estimation.html#cb195-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb195-4"><a href="interval-estimation.html#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb195-5"><a href="interval-estimation.html#cb195-5" aria-hidden="true" tabindex="-1"></a>BootstrapSample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="co"># take bootstrap sample</span></span>
<span id="cb195-6"><a href="interval-estimation.html#cb195-6" aria-hidden="true" tabindex="-1"></a>Bootstrap_Mean[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BootstrapSample<span class="sc">$</span>Mercury) <span class="co"># calculate mean in bootstrap sample</span></span>
<span id="cb195-7"><a href="interval-estimation.html#cb195-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb195-8"><a href="interval-estimation.html#cb195-8" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Results_Mean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Bootstrap_Mean)  <span class="co">#store results in data frame</span></span></code></pre></div>
<p>The bootstrap distribution for the mean mercury level is shown below, along with its standard error.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="interval-estimation.html#cb196-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Mean_Plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_Bootstrap_Results_Mean, </span>
<span id="cb196-2"><a href="interval-estimation.html#cb196-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_Mean)) <span class="sc">+</span>  </span>
<span id="cb196-3"><a href="interval-estimation.html#cb196-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb196-4"><a href="interval-estimation.html#cb196-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mean Mercury in Bootstrap Sample &quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb196-5"><a href="interval-estimation.html#cb196-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Bootstrap Distribution for Sample Mean in Florida Lakes&quot;</span>) <span class="sc">+</span> </span>
<span id="cb196-6"><a href="interval-estimation.html#cb196-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) </span>
<span id="cb196-7"><a href="interval-estimation.html#cb196-7" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Mean_Plot </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-150-1.png" width="672" /></p>
<p>We’ll calculate the standard error of the mean. This is a measure of how much the mean varies between samples.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="interval-estimation.html#cb197-1" aria-hidden="true" tabindex="-1"></a>SE_mean <span class="ot">&lt;-</span> <span class="fu">sd</span>(Lakes_Bootstrap_Results_Mean<span class="sc">$</span>Bootstrap_Mean)</span>
<span id="cb197-2"><a href="interval-estimation.html#cb197-2" aria-hidden="true" tabindex="-1"></a>SE_mean</span></code></pre></div>
<pre><code>## [1] 0.045862</code></pre>
<p>Notice that the standard error of the mean is much less than the sample standard deviation of 0.527.</p>
<p><strong>Interpretations of sample standard deviation and standard error of the mean</strong></p>
<ul>
<li>The sample standard deviation measures the amount of variability in mercury levels between the 53 individual lakes in our sample.<br />
</li>
<li>The standard error of the mean measures the amount of variability in sample mean mercury levels between different samples of size 53.</li>
</ul>
<p>There is more variability between mercury levels in individual lakes than there is between average mercury levels in different samples of size 53.</p>
<p>Since the bootstrap distribution is roughly symmetric and bell-shaped, we can use the bootstrap standard error method to calculate an approximate 95% confidence interval for the mean mercury level among all Florida lakes.</p>
<p><span class="math display">\[
\text{Statistic} \pm 2\times\text{Standard Error}
\]</span></p>
<p>In this case, the statistic of interest is the sample mean <span class="math inline">\(\bar{x}=0.527\)</span>. The confidence interval is</p>
<p><span class="math display">\[
\begin{aligned}
&amp; \bar{x} \pm 2\times\text{SE}(\bar{x}) \\
&amp; = 0.527 \pm 2\times{0.458}
\end{aligned}
\]</span></p>
<p>95% Confidence Interval:</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="interval-estimation.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(mean <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_mean, mean <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_mean) </span></code></pre></div>
<pre><code>## [1] 0.4354458 0.6188938</code></pre>
<p>The 95% confidence interval is shown by the gold bar on the graph of the bootstrap distribution below.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="interval-estimation.html#cb201-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Mean_Plot <span class="sc">+</span> </span>
<span id="cb201-2"><a href="interval-estimation.html#cb201-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>mean <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_mean,<span class="at">xend=</span>mean <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_mean, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb201-3"><a href="interval-estimation.html#cb201-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
<p>We are 95% confident that the average mercury level among all Florida lakes is between 0.4354458 and 0.6188938 parts per million.</p>
</div>
<div id="ci-for-standard-deviation" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> CI for Standard Deviation<a href="interval-estimation.html#ci-for-standard-deviation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now, we’ll calculate a confidence interval for the standard deviation in mercury levels among all Florida lakes. Recall that the sample standard deviation (<span class="math inline">\(s\)</span>) was:</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="interval-estimation.html#cb202-1" aria-hidden="true" tabindex="-1"></a>Sample_SD <span class="ot">&lt;-</span> <span class="fu">sd</span>(FloridaLakes<span class="sc">$</span>Mercury)</span>
<span id="cb202-2"><a href="interval-estimation.html#cb202-2" aria-hidden="true" tabindex="-1"></a>Sample_SD</span></code></pre></div>
<pre><code>## [1] 0.3410356</code></pre>
<p>We’ll use this estimate to calculate a confidence interval for the population standard deviation <span class="math inline">\(\sigma\)</span>.</p>
<p>This time, our statistic of interest is the sample standard deviation <span class="math inline">\(s\)</span>.</p>
<p><strong>Bootstrap Steps</strong></p>
<ol style="list-style-type: decimal">
<li><p>Take a sample of 53 lakes by randomly sampling from the original sample of 53 lakes, with replacement.</p></li>
<li><p>Calculate the standard deviation in mercury level in the bootstrap sample.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of the standard deviation mercury level in each bootstrap sample.</p></li>
<li><p>Look at the distribution of the standard deviations across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for the standard deviation in mercury level.</p></li>
</ol>
<p>We’ll illustrate the procedure on 3 bootstrap samples.</p>
<p><strong>Bootstrap Sample 1</strong></p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="interval-estimation.html#cb204-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb204-2"><a href="interval-estimation.html#cb204-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake         Mercury
##    &lt;int&gt; &lt;chr&gt;          &lt;dbl&gt;
##  1     3 Apopka          0.04
##  2     3 Apopka          0.04
##  3     4 Blue Cypress    0.44
##  4     9 Deer Point      0.83
##  5    10 Dias            0.81
##  6    10 Dias            0.81
##  7    10 Dias            0.81
##  8    11 Dorr            0.71
##  9    12 Down            0.5 
## 10    12 Down            0.5 
## # ℹ 43 more rows</code></pre>
<p>We calculate the standard deviation in mercury levels among the lakes in the bootstrap sample.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="interval-estimation.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(BootstrapSample1<span class="sc">$</span>Mercury)</span></code></pre></div>
<pre><code>## [1] 0.2790135</code></pre>
<p><strong>Bootstrap Sample #2</strong></p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="interval-estimation.html#cb208-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb208-2"><a href="interval-estimation.html#cb208-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake       Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
##  1     1 Alligator     1.23
##  2     1 Alligator     1.23
##  3     1 Alligator     1.23
##  4     1 Alligator     1.23
##  5     2 Annie         1.33
##  6     2 Annie         1.33
##  7     2 Annie         1.33
##  8     6 Bryant        0.27
##  9     7 Cherry        0.48
## 10     9 Deer Point    0.83
## # ℹ 43 more rows</code></pre>
<p>Standard Deviation in Mercury Level:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="interval-estimation.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(BootstrapSample2<span class="sc">$</span>Mercury)</span></code></pre></div>
<pre><code>## [1] 0.3788695</code></pre>
<p><strong>Bootstrap Sample #3</strong></p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="interval-estimation.html#cb212-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Lake)</span>
<span id="cb212-2"><a href="interval-estimation.html#cb212-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, Lake, Mercury)</span></code></pre></div>
<pre><code>## # A tibble: 53 × 3
##       ID Lake      Mercury
##    &lt;int&gt; &lt;chr&gt;       &lt;dbl&gt;
##  1     1 Alligator    1.23
##  2     2 Annie        1.33
##  3     2 Annie        1.33
##  4     2 Annie        1.33
##  5     3 Apopka       0.04
##  6     5 Brick        1.2 
##  7     5 Brick        1.2 
##  8     7 Cherry       0.48
##  9     7 Cherry       0.48
## 10     8 Crescent     0.19
## # ℹ 43 more rows</code></pre>
<p>Standard Deviation Mercury Level:</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="interval-estimation.html#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(BootstrapSample3<span class="sc">$</span>Mercury)</span></code></pre></div>
<pre><code>## [1] 0.3881135</code></pre>
<p>Now, we’ll take 10,000 bootstrap samples, and record the standard deviation in mercury concentration in each sample.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="interval-estimation.html#cb216-1" aria-hidden="true" tabindex="-1"></a>Sample_SD <span class="ot">&lt;-</span> <span class="fu">sd</span>(FloridaLakes<span class="sc">$</span>Mercury)  <span class="co">#calculate sample statistic</span></span>
<span id="cb216-2"><a href="interval-estimation.html#cb216-2" aria-hidden="true" tabindex="-1"></a>Bootstrap_SD <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>) <span class="co"># setup vector to hold bootstrap statistics</span></span>
<span id="cb216-3"><a href="interval-estimation.html#cb216-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-4"><a href="interval-estimation.html#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb216-5"><a href="interval-estimation.html#cb216-5" aria-hidden="true" tabindex="-1"></a>BootstrapSample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes, <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="co"># take bootstrap sample</span></span>
<span id="cb216-6"><a href="interval-estimation.html#cb216-6" aria-hidden="true" tabindex="-1"></a>Bootstrap_SD[i] <span class="ot">&lt;-</span> <span class="fu">sd</span>(BootstrapSample<span class="sc">$</span>Mercury) <span class="co"># calculate standard deviation in bootstrap sample</span></span>
<span id="cb216-7"><a href="interval-estimation.html#cb216-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb216-8"><a href="interval-estimation.html#cb216-8" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Results_SD <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Bootstrap_SD)  <span class="co">#store results in data frame</span></span></code></pre></div>
<p>The bootstrap distribution for the mean mercury level is shown below, along with its standard error.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="interval-estimation.html#cb217-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_SD_Plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_Bootstrap_Results_SD, </span>
<span id="cb217-2"><a href="interval-estimation.html#cb217-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_SD)) <span class="sc">+</span>  </span>
<span id="cb217-3"><a href="interval-estimation.html#cb217-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb217-4"><a href="interval-estimation.html#cb217-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;SD in Mercury in Bootstrap Sample &quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb217-5"><a href="interval-estimation.html#cb217-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Bootstrap Distribution for Sample SD in Florida Lakes&quot;</span>) <span class="sc">+</span> </span>
<span id="cb217-6"><a href="interval-estimation.html#cb217-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) </span>
<span id="cb217-7"><a href="interval-estimation.html#cb217-7" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_SD_Plot </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-162-1.png" width="672" /></p>
<p>We’ll calculate the standard error of the standard deviation. This is a measure of how much the standard deviation varies between samples.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="interval-estimation.html#cb218-1" aria-hidden="true" tabindex="-1"></a>SE_SD <span class="ot">&lt;-</span> <span class="fu">sd</span>(Lakes_Bootstrap_Results_SD<span class="sc">$</span>Bootstrap_SD)</span>
<span id="cb218-2"><a href="interval-estimation.html#cb218-2" aria-hidden="true" tabindex="-1"></a>SE_SD</span></code></pre></div>
<pre><code>## [1] 0.0286248</code></pre>
<p>Since the bootstrap distribution is roughly symmetric and bell-shaped, we can use the bootstrap standard error method to calculate an approximate 95% confidence interval for the standard deviation in mercury levels among all Florida lakes.</p>
<p><span class="math display">\[
\text{Statistic} \pm 2\times\text{Standard Error}
\]</span></p>
<p>In this case, the statistic of interest is the sample standard deviation <span class="math inline">\(s=0.341\)</span>. The confidence interval is</p>
<p><span class="math display">\[
\begin{aligned}
&amp; s \pm 2\times\text{SE}(s) \\
&amp; = 0.341 \pm 2\times{0.029}
\end{aligned}
\]</span>
95% Confidence Interval:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="interval-estimation.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(Sample_SD <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_SD, Sample_SD <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_SD        ) </span></code></pre></div>
<pre><code>## [1] 0.2837860 0.3982852</code></pre>
<p>The 95% confidence interval is shown by the gold bar on the graph of the bootstrap distribution below.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="interval-estimation.html#cb222-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_SD_Plot <span class="sc">+</span> </span>
<span id="cb222-2"><a href="interval-estimation.html#cb222-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sample_SD <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_SD,<span class="at">xend=</span>Sample_SD <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_SD, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb222-3"><a href="interval-estimation.html#cb222-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-165-1.png" width="672" /></p>
<p>We are 95% confident that the standard deviation in mercury levels among all Florida lakes is between 0.4699202 and 0.5844194 parts per million.</p>
</div>
<div id="ci-for-median" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> CI for Median<a href="interval-estimation.html#ci-for-median" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We already calculated a confidence interval for the mean mercury level among all Florida lakes. We could calculate a bootstrap confidence interval for the median mercury level as well, but since the distribution of mercury levels in the lakes is roughly symmetric, the mean is a reasonable measure of center, and there is not a clear reason for using the median instead.</p>
<p>When a distribution is skewed or contains large outliers, however, the median is a more robust measure of center than the mean. Recall the distribution of 100 Seattle house prices seen in Chapters 1 and 2.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="interval-estimation.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>Houses, <span class="fu">aes</span>(<span class="at">x=</span>price)) <span class="sc">+</span> </span>
<span id="cb223-2"><a href="interval-estimation.html#cb223-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span> </span>
<span id="cb223-3"><a href="interval-estimation.html#cb223-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Distribution of House Prices&quot;</span>) <span class="sc">+</span></span>
<span id="cb223-4"><a href="interval-estimation.html#cb223-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Price&quot;</span>) <span class="sc">+</span> </span>
<span id="cb223-5"><a href="interval-estimation.html#cb223-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-166-1.png" width="672" /></p>
<p>These 100 houses are a sample of all houses sold in Seattle in 2014 and 2015, so we can use statistics from our sample to draw conclusions about all houses sold in Seattle in this time period.</p>
<p>In this subsection, we’ll use bootstrapping to calculate a 95% confidence interval for the median price among all houses sold in Seattle in this time period.</p>
<p>We calculate the sample median price.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="interval-estimation.html#cb224-1" aria-hidden="true" tabindex="-1"></a>Sample_Median <span class="ot">&lt;-</span> <span class="fu">median</span>(Houses<span class="sc">$</span>price)</span>
<span id="cb224-2"><a href="interval-estimation.html#cb224-2" aria-hidden="true" tabindex="-1"></a>Sample_Median</span></code></pre></div>
<pre><code>## [1] 507.5</code></pre>
<p><strong>Bootstrap Steps</strong></p>
<ol style="list-style-type: decimal">
<li><p>Take a sample of 100 houses by randomly sampling from the original sample of 100 houses, with replacement.</p></li>
<li><p>Calculate the median price in the bootstrap sample.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of the median price in each bootstrap sample.</p></li>
<li><p>Look at the distribution of the median price across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for the median price.</p></li>
</ol>
<p>We’ll illustrate the procedure on 3 bootstrap samples.</p>
<p><strong>Bootstrap Sample 1</strong></p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="interval-estimation.html#cb226-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Houses, <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Id)</span>
<span id="cb226-2"><a href="interval-estimation.html#cb226-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(Id, price)</span></code></pre></div>
<pre><code>## # A tibble: 100 × 2
##       Id price
##    &lt;int&gt; &lt;dbl&gt;
##  1     2  885.
##  2     4  253.
##  3     4  253.
##  4     7  550.
##  5     8  485.
##  6    11  410 
##  7    12  571 
##  8    12  571 
##  9    13 1325 
## 10    14  696 
## # ℹ 90 more rows</code></pre>
<p>We calculate the median price among the houses in the bootstrap sample.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="interval-estimation.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(BootstrapSample1<span class="sc">$</span>price)</span></code></pre></div>
<pre><code>## [1] 543.5</code></pre>
<p><strong>Bootstrap Sample #2</strong></p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="interval-estimation.html#cb230-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Houses, <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Id)</span>
<span id="cb230-2"><a href="interval-estimation.html#cb230-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="sc">%&gt;%</span> <span class="fu">select</span>(Id, price)</span></code></pre></div>
<pre><code>## # A tibble: 100 × 2
##       Id price
##    &lt;int&gt; &lt;dbl&gt;
##  1     6  310.
##  2     7  550.
##  3     7  550.
##  4     9  315.
##  5    10  425 
##  6    12  571 
##  7    13 1325 
##  8    15  605.
##  9    16 3075 
## 10    17  438 
## # ℹ 90 more rows</code></pre>
<p>Median Price:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="interval-estimation.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(BootstrapSample2<span class="sc">$</span>price)</span></code></pre></div>
<pre><code>## [1] 484</code></pre>
<p><strong>Bootstrap Sample #3</strong></p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="interval-estimation.html#cb234-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Houses, <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Id)</span>
<span id="cb234-2"><a href="interval-estimation.html#cb234-2" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="sc">%&gt;%</span> <span class="fu">select</span>(Id, price)</span></code></pre></div>
<pre><code>## # A tibble: 100 × 2
##       Id price
##    &lt;int&gt; &lt;dbl&gt;
##  1     1 1225 
##  2     2  885.
##  3     3  385.
##  4     4  253.
##  5     6  310.
##  6     6  310.
##  7     7  550.
##  8     7  550.
##  9     8  485.
## 10     9  315.
## # ℹ 90 more rows</code></pre>
<p>Median Price:</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="interval-estimation.html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(BootstrapSample3<span class="sc">$</span>price)</span></code></pre></div>
<pre><code>## [1] 520</code></pre>
<p>Now, we’ll take 10,000 bootstrap samples, and record the median price in each sample.</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="interval-estimation.html#cb238-1" aria-hidden="true" tabindex="-1"></a>Sample_Med <span class="ot">&lt;-</span> <span class="fu">median</span>(Houses<span class="sc">$</span>price)  <span class="co">#calculate sample median</span></span>
<span id="cb238-2"><a href="interval-estimation.html#cb238-2" aria-hidden="true" tabindex="-1"></a>Bootstrap_Med <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>) <span class="co"># setup vector to hold bootstrap statistics</span></span>
<span id="cb238-3"><a href="interval-estimation.html#cb238-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb238-4"><a href="interval-estimation.html#cb238-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb238-5"><a href="interval-estimation.html#cb238-5" aria-hidden="true" tabindex="-1"></a>BootstrapSample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(Houses, <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="co"># take bootstrap sample</span></span>
<span id="cb238-6"><a href="interval-estimation.html#cb238-6" aria-hidden="true" tabindex="-1"></a>Bootstrap_Med[i] <span class="ot">&lt;-</span> <span class="fu">median</span>(BootstrapSample<span class="sc">$</span>price) <span class="co"># calculate standard deviation in bootstrap sample</span></span>
<span id="cb238-7"><a href="interval-estimation.html#cb238-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb238-8"><a href="interval-estimation.html#cb238-8" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Results_Med <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Bootstrap_Med)  <span class="co">#store results in data frame</span></span></code></pre></div>
<p>The bootstrap distribution for the median price is shown below, along with its standard error.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="interval-estimation.html#cb239-1" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Med_Plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Houses_Bootstrap_Results_Med, </span>
<span id="cb239-2"><a href="interval-estimation.html#cb239-2" aria-hidden="true" tabindex="-1"></a>                                    <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_Med)) <span class="sc">+</span>  </span>
<span id="cb239-3"><a href="interval-estimation.html#cb239-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb239-4"><a href="interval-estimation.html#cb239-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Median Price in Bootstrap Sample &quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb239-5"><a href="interval-estimation.html#cb239-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Bootstrap Distribution for Median Price in Seattle Houses&quot;</span>) <span class="sc">+</span> </span>
<span id="cb239-6"><a href="interval-estimation.html#cb239-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) </span>
<span id="cb239-7"><a href="interval-estimation.html#cb239-7" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Med_Plot </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-175-1.png" width="672" /></p>
<p>We’ll calculate the standard error of the median. This is a measure of how much the median varies between samples.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="interval-estimation.html#cb240-1" aria-hidden="true" tabindex="-1"></a>SE_Med <span class="ot">&lt;-</span> <span class="fu">sd</span>(Houses_Bootstrap_Results_Med<span class="sc">$</span>Bootstrap_Med)</span>
<span id="cb240-2"><a href="interval-estimation.html#cb240-2" aria-hidden="true" tabindex="-1"></a>SE_Med</span></code></pre></div>
<pre><code>## [1] 46.936</code></pre>
<p>The standard error measures the amount of variability in median house price between different samples of size 100.</p>
<p>Note that this is different than the sample standard deviation, which represents the standard deviation in prices between the 100 different houses in the sample.</p>
<p>Notice that the bootstrap distribution for the median is not symmetric and bell-shaped. Thus, we cannot be assured that 95% of samples will produce a statistic within two standard errors of the mean, so the standard error confidence interval method is not appropriate here. Instead, we’ll calculate a confidence interval by taking the middle 95% of the values in the bootstrap distribution.</p>
<p>We’ll calculate the 0.025 quantile and the 0.975 quantile of this bootstrap distribution. These are the points below which lie 2.5% and 97.5% of the medians in the bootstrap distribution. Thus, the middle 95% of the medians lie between these values.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="interval-estimation.html#cb242-1" aria-hidden="true" tabindex="-1"></a>q<span class="fl">.025</span> <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Houses_Bootstrap_Results_Med<span class="sc">$</span>Bootstrap_Med, <span class="fl">0.025</span>)</span>
<span id="cb242-2"><a href="interval-estimation.html#cb242-2" aria-hidden="true" tabindex="-1"></a>q<span class="fl">.025</span></span></code></pre></div>
<pre><code>## 2.5% 
##  410</code></pre>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="interval-estimation.html#cb244-1" aria-hidden="true" tabindex="-1"></a>q<span class="fl">.975</span> <span class="ot">&lt;-</span> <span class="fu">quantile</span>(Houses_Bootstrap_Results_Med<span class="sc">$</span>Bootstrap_Med, <span class="fl">0.975</span>)</span>
<span id="cb244-2"><a href="interval-estimation.html#cb244-2" aria-hidden="true" tabindex="-1"></a>q<span class="fl">.975</span> </span></code></pre></div>
<pre><code>## 97.5% 
##   600</code></pre>
<p>The 95% confidence interval is shown by the gold bar on the graph of the bootstrap distribution below.</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="interval-estimation.html#cb246-1" aria-hidden="true" tabindex="-1"></a>Houses_Bootstrap_Med_Plot <span class="sc">+</span> </span>
<span id="cb246-2"><a href="interval-estimation.html#cb246-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>q<span class="fl">.025</span>,<span class="at">xend=</span>q<span class="fl">.975</span>, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb246-3"><a href="interval-estimation.html#cb246-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-179-1.png" width="672" /></p>
<p>We are 95% confident that the median price among all houses that sold in Seattle between 2014 and 2015 is between 410 and 600 thousand dollars.</p>
</div>
<div id="ci-for-difference-in-means" class="section level3 hasAnchor" number="3.3.5">
<h3><span class="header-section-number">3.3.5</span> CI for Difference in Means<a href="interval-estimation.html#ci-for-difference-in-means" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We previously calculated a confidence interval for the average mercury level among all lakes in Florida.</p>
<p>Now, we’ll calculate an interval for the difference in average mercury levels between lakes in Northern Florida, compared to Southern Florida.</p>
<p>The boxplot shows and table below describe the distribution of mercury levels for lakes in Northern Florida, compared to Southern Florida.</p>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="interval-estimation.html#cb247-1" aria-hidden="true" tabindex="-1"></a>LakesBP <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>FloridaLakes, <span class="fu">aes</span>(<span class="at">x=</span>Location, <span class="at">y=</span>Mercury, <span class="at">fill=</span>Location)) <span class="sc">+</span> </span>
<span id="cb247-2"><a href="interval-estimation.html#cb247-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span>   <span class="fu">geom_jitter</span>() <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="st">&quot;Mercury Levels in Florida Lakes&quot;</span>) <span class="sc">+</span> </span>
<span id="cb247-3"><a href="interval-estimation.html#cb247-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Location&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Mercury Level&quot;</span>) <span class="sc">+</span> <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span> <span class="fu">coord_flip</span>()</span>
<span id="cb247-4"><a href="interval-estimation.html#cb247-4" aria-hidden="true" tabindex="-1"></a>LakesBP</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-181-1.png" width="672" /></p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="interval-estimation.html#cb248-1" aria-hidden="true" tabindex="-1"></a>LakesTable <span class="ot">&lt;-</span> FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Location) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">MeanHg=</span><span class="fu">mean</span>(Mercury), </span>
<span id="cb248-2"><a href="interval-estimation.html#cb248-2" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">StDevHg=</span><span class="fu">sd</span>(Mercury), </span>
<span id="cb248-3"><a href="interval-estimation.html#cb248-3" aria-hidden="true" tabindex="-1"></a>                                                  <span class="at">N=</span><span class="fu">n</span>())</span>
<span id="cb248-4"><a href="interval-estimation.html#cb248-4" aria-hidden="true" tabindex="-1"></a>LakesTable</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   Location MeanHg StDevHg     N
##   &lt;fct&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt;
## 1 N         0.425   0.270    33
## 2 S         0.696   0.384    20</code></pre>
<p>In our sample of 33 Northern Lakes and 20 Southern Lakes, we saw a difference of 0.27 ppm. We’ll calculate a confidence interval to estimate how big or small this difference could be among all Florida lakes.</p>
<p>We’ll use a statistical model to calculate the average mercury levels in Northern and Southern Florida.</p>
<p><span class="math inline">\(\widehat{\text{Mercury}} = b_0 +b_1\text{I}_{\text{South}}\)</span></p>
<ul>
<li><span class="math inline">\(b_0\)</span> represents the mean mercury level for lakes in North Florida, and<br />
</li>
<li><span class="math inline">\(b_1\)</span> represents the mean difference in mercury level for lakes in South Florida, compared to North Florida</li>
</ul>
<p>The estimates for corresponding to the original sample are shown below.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="interval-estimation.html#cb250-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>Location)</span>
<span id="cb250-2"><a href="interval-estimation.html#cb250-2" aria-hidden="true" tabindex="-1"></a>M</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ Location, data = FloridaLakes)
## 
## Coefficients:
## (Intercept)    LocationS  
##      0.4245       0.2720</code></pre>
<p>Thus, we can obtain a confidence interval for the difference in average mercury levels by fitting a regression model to each of our bootstrap samples and recording the value of the sample statistic <span class="math inline">\(b_1\)</span>, which represents this difference. Alternatively, we could calculate the mean from each group separately and subtract.</p>
<p>When comparing groups, we make one modification in Step #1 of the bootstrap process. Rather than drawing a sample of size <span class="math inline">\(n\)</span> at random, with replacement, we’ll draw the same number of observations from each group as were in the original sample. In this case, we had 33 northern lakes, and 20 southern lakes.</p>
<p><strong>Bootstrap Steps</strong></p>
<ol style="list-style-type: decimal">
<li><p>Take a sample of 33 northern lakes and 20 southern lakes by randomly sampling from the original sample, with replacement.</p></li>
<li><p>Fit a regression model with location as the explanatory variable and record the value of <span class="math inline">\(b_1\)</span>, representing the difference between the means for each group (South-North).</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of the difference in means in each bootstrap sample.</p></li>
<li><p>Look at the distribution of the differences in means across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for the difference in means between mercury levels in Northern and Southern Florida.</p></li>
</ol>
<p>We’ll illustrate the procedure on 3 bootstrap samples.</p>
<p><strong>Bootstrap Sample 1</strong></p>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="interval-estimation.html#cb252-1" aria-hidden="true" tabindex="-1"></a>NLakes <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Location<span class="sc">==</span><span class="st">&quot;N&quot;</span>), <span class="dv">33</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="do">## sample 33 northern lakes</span></span>
<span id="cb252-2"><a href="interval-estimation.html#cb252-2" aria-hidden="true" tabindex="-1"></a>SLakes <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Location<span class="sc">==</span><span class="st">&quot;S&quot;</span>), <span class="dv">20</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="do">## sample 20 southern lakes</span></span>
<span id="cb252-3"><a href="interval-estimation.html#cb252-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(NLakes, SLakes) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb252-4"><a href="interval-estimation.html#cb252-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, Location, Mercury)   <span class="do">## combine Northern and Southern Lakes</span></span>
<span id="cb252-5"><a href="interval-estimation.html#cb252-5" aria-hidden="true" tabindex="-1"></a>BootstrapSample1</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake         Location Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;fct&gt;      &lt;dbl&gt;
##  1     2 Annie        S           1.33
##  2     4 Blue Cypress S           0.44
##  3     4 Blue Cypress S           0.44
##  4     4 Blue Cypress S           0.44
##  5     5 Brick        S           1.2 
##  6     5 Brick        S           1.2 
##  7     6 Bryant       N           0.27
##  8     6 Bryant       N           0.27
##  9     7 Cherry       N           0.48
## 10    10 Dias         N           0.81
## # ℹ 43 more rows</code></pre>
<p>We fit a regression model to the bootstrap sample and calculate the regression coefficients. We’re interested in the second coefficient, <span class="math inline">\(b_1\)</span>, which represents the mean difference between lakes in Southern and Northern Florida</p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="interval-estimation.html#cb254-1" aria-hidden="true" tabindex="-1"></a>Mb1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample1, Mercury <span class="sc">~</span> Location) <span class="do">## fit linear model</span></span>
<span id="cb254-2"><a href="interval-estimation.html#cb254-2" aria-hidden="true" tabindex="-1"></a>Mb1</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ Location, data = BootstrapSample1)
## 
## Coefficients:
## (Intercept)    LocationS  
##      0.4376       0.2889</code></pre>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="interval-estimation.html#cb256-1" aria-hidden="true" tabindex="-1"></a>NLakes <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Location<span class="sc">==</span><span class="st">&quot;N&quot;</span>), <span class="dv">33</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="do">## sample 33 northern lakes</span></span>
<span id="cb256-2"><a href="interval-estimation.html#cb256-2" aria-hidden="true" tabindex="-1"></a>SLakes <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Location<span class="sc">==</span><span class="st">&quot;S&quot;</span>), <span class="dv">20</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="do">## sample 20 southern lakes</span></span>
<span id="cb256-3"><a href="interval-estimation.html#cb256-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(NLakes, SLakes) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb256-4"><a href="interval-estimation.html#cb256-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, Location, Mercury)   <span class="do">## combine Northern and Southern Lakes</span></span>
<span id="cb256-5"><a href="interval-estimation.html#cb256-5" aria-hidden="true" tabindex="-1"></a>BootstrapSample2</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake         Location Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;fct&gt;      &lt;dbl&gt;
##  1     1 Alligator    S           1.23
##  2     4 Blue Cypress S           0.44
##  3     6 Bryant       N           0.27
##  4     7 Cherry       N           0.48
##  5     8 Crescent     N           0.19
##  6     8 Crescent     N           0.19
##  7     8 Crescent     N           0.19
##  8     9 Deer Point   N           0.83
##  9     9 Deer Point   N           0.83
## 10    10 Dias         N           0.81
## # ℹ 43 more rows</code></pre>
<p><strong>Bootstrap Sample 2</strong></p>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="interval-estimation.html#cb258-1" aria-hidden="true" tabindex="-1"></a>Mb2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample2, Mercury <span class="sc">~</span> Location) <span class="do">## fit linear model</span></span>
<span id="cb258-2"><a href="interval-estimation.html#cb258-2" aria-hidden="true" tabindex="-1"></a>Mb2</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ Location, data = BootstrapSample2)
## 
## Coefficients:
## (Intercept)    LocationS  
##      0.4521       0.2814</code></pre>
<p><strong>Bootstrap Sample 3</strong></p>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="interval-estimation.html#cb260-1" aria-hidden="true" tabindex="-1"></a>NLakes <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Location<span class="sc">==</span><span class="st">&quot;N&quot;</span>), <span class="dv">33</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="do">## sample 33 northern lakes</span></span>
<span id="cb260-2"><a href="interval-estimation.html#cb260-2" aria-hidden="true" tabindex="-1"></a>SLakes <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Location<span class="sc">==</span><span class="st">&quot;S&quot;</span>), <span class="dv">20</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="do">## sample 20 southern lakes</span></span>
<span id="cb260-3"><a href="interval-estimation.html#cb260-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(NLakes, SLakes) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb260-4"><a href="interval-estimation.html#cb260-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, Location, Mercury)   <span class="do">## combine Northern and Southern Lakes</span></span>
<span id="cb260-5"><a href="interval-estimation.html#cb260-5" aria-hidden="true" tabindex="-1"></a>BootstrapSample3</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake         Location Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;fct&gt;      &lt;dbl&gt;
##  1     1 Alligator    S           1.23
##  2     2 Annie        S           1.33
##  3     4 Blue Cypress S           0.44
##  4     5 Brick        S           1.2 
##  5     6 Bryant       N           0.27
##  6     7 Cherry       N           0.48
##  7     9 Deer Point   N           0.83
##  8     9 Deer Point   N           0.83
##  9    11 Dorr         N           0.71
## 10    11 Dorr         N           0.71
## # ℹ 43 more rows</code></pre>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="interval-estimation.html#cb262-1" aria-hidden="true" tabindex="-1"></a>Mb3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample3, Mercury <span class="sc">~</span> Location) <span class="do">## fit linear model</span></span>
<span id="cb262-2"><a href="interval-estimation.html#cb262-2" aria-hidden="true" tabindex="-1"></a>Mb3</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ Location, data = BootstrapSample3)
## 
## Coefficients:
## (Intercept)    LocationS  
##      0.4991       0.1619</code></pre>
<p>We’ll now take 10,000 different bootstrap samples and look at the bootstrap distribution for <span class="math inline">\(b_1\)</span>, the difference in mean mercury levels between lakes in Southern and Northern Florida</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="interval-estimation.html#cb264-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>Location) <span class="co">#fit model to original sample</span></span>
<span id="cb264-2"><a href="interval-estimation.html#cb264-2" aria-hidden="true" tabindex="-1"></a>Sample_b1 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record b1 value (second coefficient)</span></span>
<span id="cb264-3"><a href="interval-estimation.html#cb264-3" aria-hidden="true" tabindex="-1"></a>Bootstrap_b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>)  <span class="co">#vector to store b1 values</span></span>
<span id="cb264-4"><a href="interval-estimation.html#cb264-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-5"><a href="interval-estimation.html#cb264-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb264-6"><a href="interval-estimation.html#cb264-6" aria-hidden="true" tabindex="-1"></a>NLakes <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Location<span class="sc">==</span><span class="st">&quot;N&quot;</span>), <span class="dv">33</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="do">## sample 33 northern lakes</span></span>
<span id="cb264-7"><a href="interval-estimation.html#cb264-7" aria-hidden="true" tabindex="-1"></a>SLakes <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Location<span class="sc">==</span><span class="st">&quot;S&quot;</span>), <span class="dv">20</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="do">## sample 20 southern lakes</span></span>
<span id="cb264-8"><a href="interval-estimation.html#cb264-8" aria-hidden="true" tabindex="-1"></a>BootstrapSample <span class="ot">&lt;-</span> <span class="fu">rbind</span>(NLakes, SLakes)   <span class="do">## combine Northern and Southern Lakes</span></span>
<span id="cb264-9"><a href="interval-estimation.html#cb264-9" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample, Mercury <span class="sc">~</span> Location) <span class="do">## fit linear model</span></span>
<span id="cb264-10"><a href="interval-estimation.html#cb264-10" aria-hidden="true" tabindex="-1"></a>Bootstrap_b1[i] <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="do">## record b1 </span></span>
<span id="cb264-11"><a href="interval-estimation.html#cb264-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb264-12"><a href="interval-estimation.html#cb264-12" aria-hidden="true" tabindex="-1"></a>NS_Lakes_Bootstrap_Results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Bootstrap_b1)  <span class="co">#save results as dataframe</span></span></code></pre></div>
<p>The bootstrap distribution for the difference in means, <span class="math inline">\(b_1\)</span>, is shown below, along with the standard error for the difference.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="interval-estimation.html#cb265-1" aria-hidden="true" tabindex="-1"></a>NS_Lakes_Bootstrap_Plot_b1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>NS_Lakes_Bootstrap_Results, <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_b1)) <span class="sc">+</span>  </span>
<span id="cb265-2"><a href="interval-estimation.html#cb265-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb265-3"><a href="interval-estimation.html#cb265-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Mean Difference (b1) in Bootstrap Sample&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb265-4"><a href="interval-estimation.html#cb265-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Northern vs Southern Lakes: Bootstrap Distribution for b1&quot;</span>) </span>
<span id="cb265-5"><a href="interval-estimation.html#cb265-5" aria-hidden="true" tabindex="-1"></a>NS_Lakes_Bootstrap_Plot_b1</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-191-1.png" width="672" /></p>
<p>Standard Error of the Difference in Means <span class="math inline">\(b_1\)</span></p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="interval-estimation.html#cb266-1" aria-hidden="true" tabindex="-1"></a>SE_b1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(NS_Lakes_Bootstrap_Results<span class="sc">$</span>Bootstrap_b1)</span>
<span id="cb266-2"><a href="interval-estimation.html#cb266-2" aria-hidden="true" tabindex="-1"></a>SE_b1</span></code></pre></div>
<pre><code>## [1] 0.09563947</code></pre>
<p>The bootstrap distribution is symmetric and bell-shaped, so we can use the standard error method to calculate a 95% confidence interval.</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_1 \pm 2\times\text{SE}(b_1) \\
&amp; = 0.271 \pm 2\times{0.095}
\end{aligned}
\]</span>
95% Confidence Interval:</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="interval-estimation.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(Sample_b1 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_b1, Sample_b1 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_b1) </span></code></pre></div>
<pre><code>## LocationS LocationS 
## 0.0806756 0.4632335</code></pre>
<p>The 95% confidence interval is shown by the gold bar on the graph of the bootstrap distribution below.</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="interval-estimation.html#cb270-1" aria-hidden="true" tabindex="-1"></a>NS_Lakes_Bootstrap_Plot_b1 <span class="sc">+</span> </span>
<span id="cb270-2"><a href="interval-estimation.html#cb270-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sample_b1 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_b1,<span class="at">xend=</span>Sample_b1 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_b1, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb270-3"><a href="interval-estimation.html#cb270-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-194-1.png" width="672" /></p>
<p>We are 95% confident that the mean mercury level among all lakes in Southern Florida is between 0.0806756 and 0.4632335 higher than the mean mercury level among all lakes in Northern Florida.</p>
<p><strong>Question:</strong> We previously performed a hypothesis test and concluded that there was evidence that mean mercury level was higher for lakes in South Florida than Northern Florida. Is this confidence interval consistent with the result of the hypothesis test? Why or why not?</p>
</div>
<div id="ci-for-regression-slope" class="section level3 hasAnchor" number="3.3.6">
<h3><span class="header-section-number">3.3.6</span> CI for Regression Slope<a href="interval-estimation.html#ci-for-regression-slope" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In addition to the mercury levels of the Florida lakes, we have data on the pH level of each lake. pH level measures the acidity of a lake, ranging from 0 to 14, with 7 being neutral, and lower levels indicating more acidity. We plot the pH level against the mercury level in our sample of 53 lakes.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="interval-estimation.html#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>FloridaLakes, <span class="fu">aes</span>(<span class="at">y=</span>Mercury, <span class="at">x=</span>pH)) <span class="sc">+</span> </span>
<span id="cb271-2"><a href="interval-estimation.html#cb271-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">&quot;lm&quot;</span>, <span class="at">se=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-195-1.png" width="672" /></p>
<p>The regression equation is</p>
<p><span class="math display">\[
\widehat{\text{Mercury}} = b_0 + b_1\times\text{pH}
\]</span></p>
<p>Regression estimates <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> are shown below.</p>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="interval-estimation.html#cb272-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>pH)</span>
<span id="cb272-2"><a href="interval-estimation.html#cb272-2" aria-hidden="true" tabindex="-1"></a>M</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ pH, data = FloridaLakes)
## 
## Coefficients:
## (Intercept)           pH  
##      1.5309      -0.1523</code></pre>
<ul>
<li>On average, lakes with pH level 0 are expected to have a mercury level of 1.53 ppm.<br />
</li>
<li>For each one-unit increase in pH, mercury level is expected to decrease by 0.15 ppm.</li>
</ul>
<p>These estimates are sample statistics, calculated from our sample of 53 lakes. We can think of our regression equation estimates <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> as estimates of parameters <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, which pertain to the slope and intercept of the regression line pertaining to the entire population of all lakes in Florida. We’ll use <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> to estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> in the same way that we used sample proportion <span class="math inline">\(\hat{p}\)</span> to estimate population proportion <span class="math inline">\(p\)</span> and sample mean <span class="math inline">\(\bar{x}\)</span> to estimate population mean <span class="math inline">\(\mu\)</span>.</p>
<p>The intercept, <span class="math inline">\(\beta_0\)</span> has little meaning here, but the slope <span class="math inline">\(\beta_1\)</span> represents the average change in mercury level for each one-unit increase in pH, among all Florida lakes. We’ll use bootstrapping to find a confidence interval for this quantity.</p>
<p><strong>Bootstrap Steps</strong></p>
<ol style="list-style-type: decimal">
<li><p>Take a sample of 53 lakes by randomly sampling from the original sample, with replacement.</p></li>
<li><p>Fit a regression model with pH as the explanatory variable and record the value of slope <span class="math inline">\(b_1\)</span>.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of slope of the regression line for each bootstrap sample.</p></li>
<li><p>Look at the distribution of the slopes across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for the slope relating mercury and pH levels.</p></li>
</ol>
<p>We’ll illustrate the procedure on 3 bootstrap samples.</p>
<p><strong>Bootstrap Sample 1</strong></p>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="interval-estimation.html#cb274-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes , <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)  <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb274-2"><a href="interval-estimation.html#cb274-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, pH, Mercury)   <span class="do">## combine Northern and Southern Lakes</span></span>
<span id="cb274-3"><a href="interval-estimation.html#cb274-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample1</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake            pH Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;
##  1     2 Annie          5.1    1.33
##  2     2 Annie          5.1    1.33
##  3     3 Apopka         9.1    0.04
##  4     4 Blue Cypress   6.9    0.44
##  5     4 Blue Cypress   6.9    0.44
##  6     6 Bryant         7.3    0.27
##  7     6 Bryant         7.3    0.27
##  8     7 Cherry         5.4    0.48
##  9     8 Crescent       8.1    0.19
## 10    10 Dias           6.4    0.81
## # ℹ 43 more rows</code></pre>
<p>We fit a regression model to the bootstrap sample and calculate the regression coefficients. We’re again interested in the second coefficient, <span class="math inline">\(b_1\)</span>, which now represents the slope of the regression line.</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="interval-estimation.html#cb276-1" aria-hidden="true" tabindex="-1"></a>Mb1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample1, Mercury <span class="sc">~</span> pH) <span class="co"># fit linear model</span></span>
<span id="cb276-2"><a href="interval-estimation.html#cb276-2" aria-hidden="true" tabindex="-1"></a>Mb1</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ pH, data = BootstrapSample1)
## 
## Coefficients:
## (Intercept)           pH  
##      1.2681      -0.1098</code></pre>
<p><strong>Bootstrap Sample 2</strong></p>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="interval-estimation.html#cb278-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes , <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)  <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb278-2"><a href="interval-estimation.html#cb278-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, pH, Mercury)</span>
<span id="cb278-3"><a href="interval-estimation.html#cb278-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample2</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake          pH Mercury
##    &lt;int&gt; &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;
##  1     1 Alligator    6.1    1.23
##  2     1 Alligator    6.1    1.23
##  3     2 Annie        5.1    1.33
##  4     2 Annie        5.1    1.33
##  5     3 Apopka       9.1    0.04
##  6     6 Bryant       7.3    0.27
##  7     7 Cherry       5.4    0.48
##  8     9 Deer Point   5.8    0.83
##  9    12 Down         7.2    0.5 
## 10    13 Eaton        7.2    0.49
## # ℹ 43 more rows</code></pre>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="interval-estimation.html#cb280-1" aria-hidden="true" tabindex="-1"></a>Mb2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample2, Mercury <span class="sc">~</span> pH) <span class="co"># fit linear model</span></span>
<span id="cb280-2"><a href="interval-estimation.html#cb280-2" aria-hidden="true" tabindex="-1"></a>Mb2</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ pH, data = BootstrapSample2)
## 
## Coefficients:
## (Intercept)           pH  
##      1.4872      -0.1394</code></pre>
<p><strong>Bootstrap Sample 3</strong></p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="interval-estimation.html#cb282-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes , <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)  <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb282-2"><a href="interval-estimation.html#cb282-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, pH, Mercury)</span>
<span id="cb282-3"><a href="interval-estimation.html#cb282-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample3</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake            pH Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;
##  1     2 Annie          5.1    1.33
##  2     2 Annie          5.1    1.33
##  3     2 Annie          5.1    1.33
##  4     3 Apopka         9.1    0.04
##  5     4 Blue Cypress   6.9    0.44
##  6     4 Blue Cypress   6.9    0.44
##  7     6 Bryant         7.3    0.27
##  8     8 Crescent       8.1    0.19
##  9     8 Crescent       8.1    0.19
## 10    10 Dias           6.4    0.81
## # ℹ 43 more rows</code></pre>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="interval-estimation.html#cb284-1" aria-hidden="true" tabindex="-1"></a>Mb3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample3, Mercury <span class="sc">~</span> pH) <span class="co"># fit linear model</span></span>
<span id="cb284-2"><a href="interval-estimation.html#cb284-2" aria-hidden="true" tabindex="-1"></a>Mb3</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Mercury ~ pH, data = BootstrapSample3)
## 
## Coefficients:
## (Intercept)           pH  
##      1.6431      -0.1761</code></pre>
<p>We’ll now take 10,000 different bootstrap samples and look at the bootstrap distribution for <span class="math inline">\(b_1\)</span>, the slope of the regression line relating mercury level and pH.</p>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="interval-estimation.html#cb286-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>pH) <span class="co">#fit model to original sample</span></span>
<span id="cb286-2"><a href="interval-estimation.html#cb286-2" aria-hidden="true" tabindex="-1"></a>Sample_b1 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record b1 value (second coefficient)</span></span>
<span id="cb286-3"><a href="interval-estimation.html#cb286-3" aria-hidden="true" tabindex="-1"></a>Bootstrap_b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>)  <span class="co">#vector to store b1 values</span></span>
<span id="cb286-4"><a href="interval-estimation.html#cb286-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb286-5"><a href="interval-estimation.html#cb286-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb286-6"><a href="interval-estimation.html#cb286-6" aria-hidden="true" tabindex="-1"></a>BootstrapSample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes , <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="co">#take bootstrap sample</span></span>
<span id="cb286-7"><a href="interval-estimation.html#cb286-7" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample, Mercury <span class="sc">~</span> pH) <span class="co"># fit linear model</span></span>
<span id="cb286-8"><a href="interval-estimation.html#cb286-8" aria-hidden="true" tabindex="-1"></a>Bootstrap_b1[i] <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record b1 </span></span>
<span id="cb286-9"><a href="interval-estimation.html#cb286-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb286-10"><a href="interval-estimation.html#cb286-10" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Slope_Results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Bootstrap_b1)  <span class="co">#save results as dataframe</span></span></code></pre></div>
<p>The bootstrap distribution for the slopes, <span class="math inline">\(b_1\)</span>, is shown below, along with the standard error for the difference.</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="interval-estimation.html#cb287-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Plot_Slope <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_Bootstrap_Slope_Results, <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_b1)) <span class="sc">+</span></span>
<span id="cb287-2"><a href="interval-estimation.html#cb287-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb287-3"><a href="interval-estimation.html#cb287-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Slope in Bootstrap Sample&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb287-4"><a href="interval-estimation.html#cb287-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Bootstrap Distribution for Slope&quot;</span>) </span>
<span id="cb287-5"><a href="interval-estimation.html#cb287-5" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Plot_Slope</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-204-1.png" width="672" /></p>
<p>Standard Error of the slope <span class="math inline">\(b_1\)</span></p>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="interval-estimation.html#cb288-1" aria-hidden="true" tabindex="-1"></a>SE_b1 <span class="ot">&lt;-</span> <span class="fu">sd</span>(Lakes_Bootstrap_Slope_Results<span class="sc">$</span>Bootstrap_b1)</span>
<span id="cb288-2"><a href="interval-estimation.html#cb288-2" aria-hidden="true" tabindex="-1"></a>SE_b1</span></code></pre></div>
<pre><code>## [1] 0.02712872</code></pre>
<p>The bootstrap distribution is symmetric and bell-shaped, so we can use the standard error method to calculate a 95% confidence interval.</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_1 \pm 2\times\text{SE}(b_1) \\
&amp; = -0.1523 \pm 2\times{0.027}
\end{aligned}
\]</span></p>
<p>95% Confidence Interval:</p>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="interval-estimation.html#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(Sample_b1 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_b1, Sample_b1 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_b1) </span></code></pre></div>
<pre><code>##          pH          pH 
## -0.20655831 -0.09804342</code></pre>
<p>The 95% confidence interval is shown by the gold bar on the graph of the bootstrap distribution below.</p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="interval-estimation.html#cb292-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Plot_Slope <span class="sc">+</span> </span>
<span id="cb292-2"><a href="interval-estimation.html#cb292-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sample_b1 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_b1,<span class="at">xend=</span>Sample_b1 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_b1, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb292-3"><a href="interval-estimation.html#cb292-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-207-1.png" width="672" /></p>
<p>We are 95% confident that among all Florida lakes, for each 1 unit increase in pH, mercury level decreases between 0.2065583 and 0.0980434, on average.</p>
</div>
<div id="ci-for-regression-response" class="section level3 hasAnchor" number="3.3.7">
<h3><span class="header-section-number">3.3.7</span> CI for Regression Response<a href="interval-estimation.html#ci-for-regression-response" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In addition to calculating a confidence interval for the slope of the regression line relating mercury and pH levels in a lake, we can also calculate a confidence interval for the average mercury level among all lakes with a given pH.</p>
<p>We’ll calculate a confidence interval for the average mercury level among all lakes with a neutral pH level of 7.</p>
<p>The regression equation is</p>
<p><span class="math display">\[
\begin{aligned}
\widehat{\text{Mercury}} &amp; = b_0 + b_1\times\text{pH} \\
&amp; = 1.5309 - 0.1523\times\text{pH}
\end{aligned}
\]</span></p>
<p>so the expected mercury level among all lakes with <span class="math inline">\(\text{pH} = 7\)</span> is <span class="math inline">\(b_0+7b_1 = 1.5309-0.1523(7)=0.4648\)</span> ppm.</p>
<p>This quantity is a statistic calculated from a sample of 53 lakes, so we would not expect the average mercury level among all lakes in the population to be exactly equal to 0.4648. Again, we’ll use this sample statistic as an estimate of the population parameter, and use bootstrapping to estimate the variability associated with this statistic, in order to make a confidence interval.</p>
<p><strong>Bootstrap Steps</strong></p>
<ol style="list-style-type: decimal">
<li><p>Take a sample of 53 southern lakes by randomly sampling from the original sample, with replacement.</p></li>
<li><p>Fit a regression model with location as the explanatory variable and record the values of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>. Use these to calculate <span class="math inline">\(b_0+7b_1\)</span>.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, keeping track of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>, and calculating <span class="math inline">\(b_0+7b_1\)</span> in each bootstrap sample.</p></li>
<li><p>Look at the distribution of the expected response, <span class="math inline">\(b_0 + 7b_1\)</span>, across bootstrap samples. The variability in this bootstrap distribution can be used to approximate the variability in the sampling distribution for the expected mercury level among all lakes with pH level of 7.</p></li>
</ol>
<p>We’ll illustrate the procedure on 3 bootstrap samples.</p>
<p><strong>Bootstrap Sample 1</strong></p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="interval-estimation.html#cb293-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample1 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes , <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)  <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb293-2"><a href="interval-estimation.html#cb293-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, pH, Mercury)   <span class="do">## combine Northern and Southern Lakes</span></span>
<span id="cb293-3"><a href="interval-estimation.html#cb293-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample1</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake            pH Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;
##  1     2 Annie          5.1    1.33
##  2     4 Blue Cypress   6.9    0.44
##  3     6 Bryant         7.3    0.27
##  4     7 Cherry         5.4    0.48
##  5     9 Deer Point     5.8    0.83
##  6    10 Dias           6.4    0.81
##  7    10 Dias           6.4    0.81
##  8    10 Dias           6.4    0.81
##  9    10 Dias           6.4    0.81
## 10    11 Dorr           5.4    0.71
## # ℹ 43 more rows</code></pre>
<p>We fit a regression model to the bootstrap sample and calculate the regression coefficients. We’re interested in the second coefficient, <span class="math inline">\(b_1\)</span>, which represents the mean difference between lakes in Southern and Northern Florida</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="interval-estimation.html#cb295-1" aria-hidden="true" tabindex="-1"></a>Mb1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample1, Mercury <span class="sc">~</span> pH) <span class="do">## fit linear model</span></span>
<span id="cb295-2"><a href="interval-estimation.html#cb295-2" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> Mb1<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="co"># record value of b0 (first coefficient)</span></span>
<span id="cb295-3"><a href="interval-estimation.html#cb295-3" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> Mb1<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record value of b1 (second coefficient)</span></span>
<span id="cb295-4"><a href="interval-estimation.html#cb295-4" aria-hidden="true" tabindex="-1"></a>b0<span class="sc">+</span><span class="dv">7</span><span class="sc">*</span>b1 <span class="co">#calculate b0+7*b1</span></span></code></pre></div>
<pre><code>## (Intercept) 
##   0.4755848</code></pre>
<p><strong>Bootstrap Sample 2</strong></p>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="interval-estimation.html#cb297-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample2 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes , <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)  <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb297-2"><a href="interval-estimation.html#cb297-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, pH, Mercury)</span>
<span id="cb297-3"><a href="interval-estimation.html#cb297-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample2</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake                 pH Mercury
##    &lt;int&gt; &lt;chr&gt;             &lt;dbl&gt;   &lt;dbl&gt;
##  1     1 Alligator           6.1    1.23
##  2     1 Alligator           6.1    1.23
##  3     3 Apopka              9.1    0.04
##  4     4 Blue Cypress        6.9    0.44
##  5    12 Down                7.2    0.5 
##  6    14 East Tohopekaliga   5.8    1.16
##  7    16 George              8.2    0.15
##  8    17 Griffin             8.7    0.19
##  9    17 Griffin             8.7    0.19
## 10    17 Griffin             8.7    0.19
## # ℹ 43 more rows</code></pre>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="interval-estimation.html#cb299-1" aria-hidden="true" tabindex="-1"></a>Mb2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample2, Mercury <span class="sc">~</span> pH) <span class="do">## fit linear model</span></span>
<span id="cb299-2"><a href="interval-estimation.html#cb299-2" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> Mb2<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="co"># record value of b0 (first coefficient)</span></span>
<span id="cb299-3"><a href="interval-estimation.html#cb299-3" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> Mb2<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record value of b1 (second coefficient)</span></span>
<span id="cb299-4"><a href="interval-estimation.html#cb299-4" aria-hidden="true" tabindex="-1"></a>b0<span class="sc">+</span><span class="dv">7</span><span class="sc">*</span>b1 <span class="co">#calculate b0+7*b1</span></span></code></pre></div>
<pre><code>## (Intercept) 
##   0.4327569</code></pre>
<p><strong>Bootstrap Sample 3</strong></p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="interval-estimation.html#cb301-1" aria-hidden="true" tabindex="-1"></a>BootstrapSample3 <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes , <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)  <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(ID) <span class="sc">%&gt;%</span> </span>
<span id="cb301-2"><a href="interval-estimation.html#cb301-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Lake, pH, Mercury)</span>
<span id="cb301-3"><a href="interval-estimation.html#cb301-3" aria-hidden="true" tabindex="-1"></a>BootstrapSample3</span></code></pre></div>
<pre><code>## # A tibble: 53 × 4
##       ID Lake            pH Mercury
##    &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;
##  1     1 Alligator      6.1    1.23
##  2     2 Annie          5.1    1.33
##  3     2 Annie          5.1    1.33
##  4     4 Blue Cypress   6.9    0.44
##  5     6 Bryant         7.3    0.27
##  6     7 Cherry         5.4    0.48
##  7     8 Crescent       8.1    0.19
##  8     9 Deer Point     5.8    0.83
##  9    11 Dorr           5.4    0.71
## 10    11 Dorr           5.4    0.71
## # ℹ 43 more rows</code></pre>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="interval-estimation.html#cb303-1" aria-hidden="true" tabindex="-1"></a>Mb3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample3, Mercury <span class="sc">~</span> pH) <span class="co"># fit linear model</span></span>
<span id="cb303-2"><a href="interval-estimation.html#cb303-2" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> Mb3<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="co"># record value of b0 (first coefficient)</span></span>
<span id="cb303-3"><a href="interval-estimation.html#cb303-3" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> Mb3<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record value of b1 (second coefficient)</span></span>
<span id="cb303-4"><a href="interval-estimation.html#cb303-4" aria-hidden="true" tabindex="-1"></a>b0<span class="sc">+</span><span class="dv">7</span><span class="sc">*</span>b1 <span class="co">#calculate b0+7*b1</span></span></code></pre></div>
<pre><code>## (Intercept) 
##   0.4717755</code></pre>
<p>We’ll now take 10,000 different bootstrap samples and record the values of <span class="math inline">\(b_0\)</span>, <span class="math inline">\(b_1\)</span>, which we’ll then use to calculate <span class="math inline">\(b_0+7b_1\)</span>.</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="interval-estimation.html#cb305-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>FloridaLakes, Mercury<span class="sc">~</span>pH) <span class="co">#fit model to original sample</span></span>
<span id="cb305-2"><a href="interval-estimation.html#cb305-2" aria-hidden="true" tabindex="-1"></a>Sample_b0 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="co"># record b0 value (second coefficient)</span></span>
<span id="cb305-3"><a href="interval-estimation.html#cb305-3" aria-hidden="true" tabindex="-1"></a>Sample_b1 <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record b1 value (second coefficient)</span></span>
<span id="cb305-4"><a href="interval-estimation.html#cb305-4" aria-hidden="true" tabindex="-1"></a>Sample_Exp7 <span class="ot">&lt;-</span> Sample_b0 <span class="sc">+</span> <span class="dv">7</span><span class="sc">*</span>Sample_b1 <span class="co"># calculate sample expected mercury when pH=7</span></span>
<span id="cb305-5"><a href="interval-estimation.html#cb305-5" aria-hidden="true" tabindex="-1"></a>Bootstrap_b0 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>)  <span class="co">#vector to store b1 values</span></span>
<span id="cb305-6"><a href="interval-estimation.html#cb305-6" aria-hidden="true" tabindex="-1"></a>Bootstrap_b1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">10000</span>)  <span class="co">#vector to store b1 values</span></span>
<span id="cb305-7"><a href="interval-estimation.html#cb305-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-8"><a href="interval-estimation.html#cb305-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>){</span>
<span id="cb305-9"><a href="interval-estimation.html#cb305-9" aria-hidden="true" tabindex="-1"></a>BootstrapSample <span class="ot">&lt;-</span> <span class="fu">sample_n</span>(FloridaLakes , <span class="dv">53</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)   <span class="co">#take bootstrap sample</span></span>
<span id="cb305-10"><a href="interval-estimation.html#cb305-10" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">data=</span>BootstrapSample, Mercury <span class="sc">~</span> pH) <span class="co"># fit linear model</span></span>
<span id="cb305-11"><a href="interval-estimation.html#cb305-11" aria-hidden="true" tabindex="-1"></a>Bootstrap_b0[i] <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">1</span>] <span class="co"># record b0 </span></span>
<span id="cb305-12"><a href="interval-estimation.html#cb305-12" aria-hidden="true" tabindex="-1"></a>Bootstrap_b1[i] <span class="ot">&lt;-</span> M<span class="sc">$</span>coefficients[<span class="dv">2</span>] <span class="co"># record b1 </span></span>
<span id="cb305-13"><a href="interval-estimation.html#cb305-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb305-14"><a href="interval-estimation.html#cb305-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-15"><a href="interval-estimation.html#cb305-15" aria-hidden="true" tabindex="-1"></a>Bootstrap_Exp7 <span class="ot">&lt;-</span>  Bootstrap_b0 <span class="sc">+</span> <span class="dv">7</span><span class="sc">*</span>Bootstrap_b1 <span class="co"># calcualte expected response for each bootstrap sample</span></span>
<span id="cb305-16"><a href="interval-estimation.html#cb305-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-17"><a href="interval-estimation.html#cb305-17" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Exp7_Results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Bootstrap_b0, Bootstrap_b1, Bootstrap_Exp7)  <span class="co">#save results as dataframe</span></span></code></pre></div>
<p>The bootstrap distribution for the expected mercury level among all lakes with pH level 7, <span class="math inline">\(b_0+7b_1\)</span>, is shown below, along with the standard error for this quantity.</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="interval-estimation.html#cb306-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Plot_Exp7 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data=</span>Lakes_Bootstrap_Exp7_Results, <span class="fu">aes</span>(<span class="at">x=</span>Bootstrap_Exp7)) <span class="sc">+</span>  </span>
<span id="cb306-2"><a href="interval-estimation.html#cb306-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">&quot;white&quot;</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span> </span>
<span id="cb306-3"><a href="interval-estimation.html#cb306-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Expected Mercury Level in Bootstrap Sample&quot;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="sc">+</span></span>
<span id="cb306-4"><a href="interval-estimation.html#cb306-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>( <span class="st">&quot;Bootstrap Distribution for Exp. Mercury when pH=7&quot;</span>) </span>
<span id="cb306-5"><a href="interval-estimation.html#cb306-5" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Plot_Exp7</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-215-1.png" width="672" /></p>
<p>Standard Error of the expected response <span class="math inline">\(b_0 + 7b_1\)</span></p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="interval-estimation.html#cb307-1" aria-hidden="true" tabindex="-1"></a>SE_Exp7 <span class="ot">&lt;-</span> <span class="fu">sd</span>(Lakes_Bootstrap_Exp7_Results<span class="sc">$</span>Bootstrap_Exp7)</span>
<span id="cb307-2"><a href="interval-estimation.html#cb307-2" aria-hidden="true" tabindex="-1"></a>SE_Exp7</span></code></pre></div>
<pre><code>## [1] 0.03704046</code></pre>
<p>Again, the bootstrap distribution is symmetric and bell-shaped, so we can use the standard error method to calculate a 95% confidence interval.</p>
<p><span class="math display">\[
\begin{aligned}
&amp; b_1 \pm 2\times\text{SE}(b_1) \\
&amp; = 0.4648 \pm 2\times{0.037}
\end{aligned}
\]</span></p>
<p>95% Confidence Interval:</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="interval-estimation.html#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(Sample_Exp7 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_Exp7, Sample_Exp7 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_Exp7) </span></code></pre></div>
<pre><code>## (Intercept) (Intercept) 
##   0.3907318   0.5388936</code></pre>
<p>The 95% confidence interval is shown by the gold bar on the graph of the bootstrap distribution below.</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="interval-estimation.html#cb311-1" aria-hidden="true" tabindex="-1"></a>Lakes_Bootstrap_Plot_Exp7 <span class="sc">+</span> </span>
<span id="cb311-2"><a href="interval-estimation.html#cb311-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">x=</span>Sample_Exp7 <span class="sc">-</span> <span class="dv">2</span><span class="sc">*</span>SE_Exp7,<span class="at">xend=</span>Sample_Exp7 <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span>SE_Exp7, <span class="at">y=</span><span class="dv">50</span>, <span class="at">yend=</span><span class="dv">50</span>), </span>
<span id="cb311-3"><a href="interval-estimation.html#cb311-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">color=</span><span class="st">&quot;gold&quot;</span>, <span class="at">size=</span><span class="dv">10</span>, <span class="at">alpha=</span><span class="fl">0.01</span>) </span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-218-1.png" width="672" /></p>
<p>We are 95% confident that average mercury level among all Florida lakes with pH level 7 is between 0.3907318 and 0.5388936 ppm.</p>
</div>
<div id="more-cis-in-regression" class="section level3 hasAnchor" number="3.3.8">
<h3><span class="header-section-number">3.3.8</span> More CI’s in Regression<a href="interval-estimation.html#more-cis-in-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="bootstrapping-cautions" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Bootstrapping Cautions<a href="interval-estimation.html#bootstrapping-cautions" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-statistical-models.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Stat255-LU/Notes/edit/master/03-Interval_Estimation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Stat255-LU/Notes/blob/master/03-Interval_Estimation.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
