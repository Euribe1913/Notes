<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Hypothesis Testing via Permutation | Stat 255: Statistics for Data Science Notes</title>
  <meta name="description" content="Chapter 3 Hypothesis Testing via Permutation | Stat 255: Statistics for Data Science Notes" />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Hypothesis Testing via Permutation | Stat 255: Statistics for Data Science Notes" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Hypothesis Testing via Permutation | Stat 255: Statistics for Data Science Notes" />
  
  
  

<meta name="author" content="Andrew Sage - Lawrence University" />


<meta name="date" content="2022-09-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction-to-statistical-models.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">STAT 255 Notes</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html"><i class="fa fa-check"></i><b>1</b> Exploratory Data Analysis</a><ul>
<li class="chapter" data-level="1.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#exploring-data-visualizations"><i class="fa fa-check"></i><b>1.1</b> Exploring Data Visualizations</a><ul>
<li class="chapter" data-level="1.1.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#covid-19-data"><i class="fa fa-check"></i><b>1.1.1</b> COVID-19 Data</a></li>
<li class="chapter" data-level="1.1.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#breakdown-by-age-50"><i class="fa fa-check"></i><b>1.1.2</b> Breakdown by Age &lt; 50</a></li>
<li class="chapter" data-level="1.1.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#vaccination-by-age-breakdown"><i class="fa fa-check"></i><b>1.1.3</b> Vaccination by Age Breakdown</a></li>
<li class="chapter" data-level="1.1.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#simpsons-paradox"><i class="fa fa-check"></i><b>1.1.4</b> Simpson’s Paradox</a></li>
<li class="chapter" data-level="1.1.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#exploring-diamond-prices"><i class="fa fa-check"></i><b>1.1.5</b> Exploring Diamond Prices</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#exploratory-analysis-in-r"><i class="fa fa-check"></i><b>1.2</b> Exploratory Analysis in R</a><ul>
<li class="chapter" data-level="1.2.1" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#loading-the-data"><i class="fa fa-check"></i><b>1.2.1</b> Loading the Data</a></li>
<li class="chapter" data-level="1.2.2" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#previewing-the-data"><i class="fa fa-check"></i><b>1.2.2</b> Previewing the Data</a></li>
<li class="chapter" data-level="1.2.3" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#adding-a-new-variable"><i class="fa fa-check"></i><b>1.2.3</b> Adding a New Variable</a></li>
<li class="chapter" data-level="1.2.4" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#selecting-columns"><i class="fa fa-check"></i><b>1.2.4</b> Selecting Columns</a></li>
<li class="chapter" data-level="1.2.5" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#filtering-by-row"><i class="fa fa-check"></i><b>1.2.5</b> Filtering by Row</a></li>
<li class="chapter" data-level="1.2.6" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#histogram"><i class="fa fa-check"></i><b>1.2.6</b> Histogram</a></li>
<li class="chapter" data-level="1.2.7" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#density-plots"><i class="fa fa-check"></i><b>1.2.7</b> Density Plots</a></li>
<li class="chapter" data-level="1.2.8" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#boxplot"><i class="fa fa-check"></i><b>1.2.8</b> Boxplot</a></li>
<li class="chapter" data-level="1.2.9" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#violin-plot"><i class="fa fa-check"></i><b>1.2.9</b> Violin Plot</a></li>
<li class="chapter" data-level="1.2.10" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#scatterplots"><i class="fa fa-check"></i><b>1.2.10</b> Scatterplots</a></li>
<li class="chapter" data-level="1.2.11" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#bar-graphs"><i class="fa fa-check"></i><b>1.2.11</b> Bar Graphs</a></li>
<li class="chapter" data-level="1.2.12" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#stacked-and-side-by-side-bar-graphs"><i class="fa fa-check"></i><b>1.2.12</b> Stacked and Side-by-Side Bar Graphs</a></li>
<li class="chapter" data-level="1.2.13" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#correlation-plot"><i class="fa fa-check"></i><b>1.2.13</b> Correlation Plot</a></li>
<li class="chapter" data-level="1.2.14" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#scatterplot-matrix"><i class="fa fa-check"></i><b>1.2.14</b> Scatterplot Matrix</a></li>
<li class="chapter" data-level="1.2.15" data-path="exploratory-data-analysis.html"><a href="exploratory-data-analysis.html#summary-tables"><i class="fa fa-check"></i><b>1.2.15</b> Summary Tables</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html"><i class="fa fa-check"></i><b>2</b> Introduction to Statistical Models</a><ul>
<li class="chapter" data-level="2.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#predicting-house-prices"><i class="fa fa-check"></i><b>2.1</b> Predicting House Prices</a><ul>
<li class="chapter" data-level="2.1.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#house-prices-in-ames-ia"><i class="fa fa-check"></i><b>2.1.1</b> House Prices in Ames IA</a></li>
<li class="chapter" data-level="2.1.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#prices-by-neighborhood"><i class="fa fa-check"></i><b>2.1.2</b> Prices by Neighborhood</a></li>
<li class="chapter" data-level="2.1.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#house-prices-by-size"><i class="fa fa-check"></i><b>2.1.3</b> House Prices by Size</a></li>
<li class="chapter" data-level="2.1.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#explanatory-and-response-variables"><i class="fa fa-check"></i><b>2.1.4</b> Explanatory and Response Variables</a></li>
<li class="chapter" data-level="2.1.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#prediction-with-no-explanatory-variables"><i class="fa fa-check"></i><b>2.1.5</b> Prediction with No Explanatory Variables</a></li>
<li class="chapter" data-level="2.1.6" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#simple-model-in-r"><i class="fa fa-check"></i><b>2.1.6</b> Simple Model in R</a></li>
<li class="chapter" data-level="2.1.7" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#prediction-for-a-categorical-explanatory-variable"><i class="fa fa-check"></i><b>2.1.7</b> Prediction for a Categorical Explanatory Variable</a></li>
<li class="chapter" data-level="2.1.8" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-by-neighborhood-in-r"><i class="fa fa-check"></i><b>2.1.8</b> Model by Neighborhood in R</a></li>
<li class="chapter" data-level="2.1.9" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-notation-for-houses-by-neighborhood"><i class="fa fa-check"></i><b>2.1.9</b> Model Notation for Houses by Neighborhood</a></li>
<li class="chapter" data-level="2.1.10" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#prediction-for-quantitative-explanatory-variable"><i class="fa fa-check"></i><b>2.1.10</b> Prediction for Quantitative Explanatory Variable</a></li>
<li class="chapter" data-level="2.1.11" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-using-square-feet"><i class="fa fa-check"></i><b>2.1.11</b> Model using Square Feet</a></li>
<li class="chapter" data-level="2.1.12" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-for-squarefeet-and-interpretations"><i class="fa fa-check"></i><b>2.1.12</b> Model for SquareFeet and Interpretations</a></li>
<li class="chapter" data-level="2.1.13" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#calculating-predicted-prices"><i class="fa fa-check"></i><b>2.1.13</b> Calculating Predicted Prices</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#variability-explained-by-a-model"><i class="fa fa-check"></i><b>2.2</b> Variability Explained by a Model</a><ul>
<li class="chapter" data-level="2.2.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#quantifying-variability"><i class="fa fa-check"></i><b>2.2.1</b> Quantifying Variability</a></li>
<li class="chapter" data-level="2.2.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#residuals-for-three-models"><i class="fa fa-check"></i><b>2.2.2</b> Residuals for Three Models</a></li>
<li class="chapter" data-level="2.2.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#quantifying-unexplained-variablility"><i class="fa fa-check"></i><b>2.2.3</b> Quantifying Unexplained Variablility</a></li>
<li class="chapter" data-level="2.2.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#total-sum-of-squares-sst"><i class="fa fa-check"></i><b>2.2.4</b> Total Sum of Squares (SST)</a></li>
<li class="chapter" data-level="2.2.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#ssr-and-ssm"><i class="fa fa-check"></i><b>2.2.5</b> SSR and SSM</a></li>
<li class="chapter" data-level="2.2.6" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#summary-sst-ssr-ssm-r2"><i class="fa fa-check"></i><b>2.2.6</b> Summary: SST, SSR, SSM, <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="2.2.7" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#r2-visually"><i class="fa fa-check"></i><b>2.2.7</b> <span class="math inline">\(R^2\)</span> Visually</a></li>
<li class="chapter" data-level="2.2.8" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#residuals-for-square-feet-model"><i class="fa fa-check"></i><b>2.2.8</b> Residuals for Square Feet Model</a></li>
<li class="chapter" data-level="2.2.9" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#variation-explained-by-squarefeet-model"><i class="fa fa-check"></i><b>2.2.9</b> Variation Explained by SquareFeet Model</a></li>
<li class="chapter" data-level="2.2.10" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#variation-explained-by-square-feet-model"><i class="fa fa-check"></i><b>2.2.10</b> Variation Explained by Square Feet Model</a></li>
<li class="chapter" data-level="2.2.11" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#linear-correlation-coefficient"><i class="fa fa-check"></i><b>2.2.11</b> Linear Correlation Coefficient</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#multiple-regression-model"><i class="fa fa-check"></i><b>2.3</b> Multiple Regression Model</a><ul>
<li class="chapter" data-level="2.3.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#multiple-regression-model-1"><i class="fa fa-check"></i><b>2.3.1</b> Multiple Regression Model</a></li>
<li class="chapter" data-level="2.3.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#variable-model-different-slopes"><i class="fa fa-check"></i><b>2.3.2</b> 2-Variable Model Different Slopes</a></li>
<li class="chapter" data-level="2.3.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#variable-model-with-constant-slope"><i class="fa fa-check"></i><b>2.3.3</b> 2-Variable Model with Constant Slope</a></li>
<li class="chapter" data-level="2.3.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#house-price-2-variable-model-summary"><i class="fa fa-check"></i><b>2.3.4</b> House Price 2-Variable Model Summary</a></li>
<li class="chapter" data-level="2.3.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#mr-model-for-squarefeet-and-neighborhood"><i class="fa fa-check"></i><b>2.3.5</b> MR Model for SquareFeet and Neighborhood</a></li>
<li class="chapter" data-level="2.3.6" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#predicting-price-in-mr-model"><i class="fa fa-check"></i><b>2.3.6</b> Predicting Price in MR Model</a></li>
<li class="chapter" data-level="2.3.7" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#risk-of-extrapolation"><i class="fa fa-check"></i><b>2.3.7</b> Risk of Extrapolation</a></li>
<li class="chapter" data-level="2.3.8" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#residuals-for-2-variable-model"><i class="fa fa-check"></i><b>2.3.8</b> Residuals for 2-Variable Model</a></li>
<li class="chapter" data-level="2.3.9" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#residuals-for-2-variable-model-cont."><i class="fa fa-check"></i><b>2.3.9</b> Residuals for 2-Variable Model (cont.)</a></li>
<li class="chapter" data-level="2.3.10" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#variation-explained-by-2-variable-model"><i class="fa fa-check"></i><b>2.3.10</b> Variation Explained by 2-Variable Model</a></li>
<li class="chapter" data-level="2.3.11" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-comparison-summary"><i class="fa fa-check"></i><b>2.3.11</b> Model Comparison Summary</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#least-squares-estimation"><i class="fa fa-check"></i><b>2.4</b> Least-Squares Estimation</a><ul>
<li class="chapter" data-level="2.4.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#line-of-best-fit"><i class="fa fa-check"></i><b>2.4.1</b> Line of Best Fit</a></li>
<li class="chapter" data-level="2.4.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#least-squares-estimation-in-simple-linear-regression"><i class="fa fa-check"></i><b>2.4.2</b> Least-Squares Estimation in Simple Linear Regression</a></li>
<li class="chapter" data-level="2.4.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#least-squares-estimation-in-simple-linear-regression-cont."><i class="fa fa-check"></i><b>2.4.3</b> Least-Squares Estimation in Simple Linear Regression (cont.)</a></li>
<li class="chapter" data-level="2.4.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#ls-estimation-for-one-categorical-variable"><i class="fa fa-check"></i><b>2.4.4</b> LS Estimation for One Categorical Variable</a></li>
<li class="chapter" data-level="2.4.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#ls-estimation-more-generally"><i class="fa fa-check"></i><b>2.4.5</b> LS Estimation More Generally</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#analysis-of-variance"><i class="fa fa-check"></i><b>2.5</b> ANalysis Of VAriance</a><ul>
<li class="chapter" data-level="2.5.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#submodels"><i class="fa fa-check"></i><b>2.5.1</b> Submodels</a></li>
<li class="chapter" data-level="2.5.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#comparing-submodels"><i class="fa fa-check"></i><b>2.5.2</b> Comparing Submodels</a></li>
<li class="chapter" data-level="2.5.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#comments-on-f-statistic"><i class="fa fa-check"></i><b>2.5.3</b> Comments on F-Statistic</a></li>
<li class="chapter" data-level="2.5.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#anova-f-statistic"><i class="fa fa-check"></i><b>2.5.4</b> ANOVA F-Statistic</a></li>
<li class="chapter" data-level="2.5.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#anova-f-statistic-for-m2-vs-m3-in-r"><i class="fa fa-check"></i><b>2.5.5</b> ANOVA F-Statistic for M2 vs M3 in R</a></li>
<li class="chapter" data-level="2.5.6" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#anova-f-statistic-for-m1-vs-m0"><i class="fa fa-check"></i><b>2.5.6</b> ANOVA F-Statistic for M1 vs M0</a></li>
<li class="chapter" data-level="2.5.7" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#anova-f-statistic-for-m0-vs-m1-in-r"><i class="fa fa-check"></i><b>2.5.7</b> ANOVA F-Statistic for M0 vs M1 in R</a></li>
<li class="chapter" data-level="2.5.8" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#anova-f-statistic-for-categorical-variables"><i class="fa fa-check"></i><b>2.5.8</b> ANOVA F-Statistic for Categorical Variables</a></li>
<li class="chapter" data-level="2.5.9" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#f-statistic-for-categorical-variables-illustration"><i class="fa fa-check"></i><b>2.5.9</b> F-Statistic for Categorical Variables Illustration</a></li>
<li class="chapter" data-level="2.5.10" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#alternative-f-statistic-formula"><i class="fa fa-check"></i><b>2.5.10</b> Alternative F-Statistic Formula</a></li>
<li class="chapter" data-level="2.5.11" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#calculating-f-statistic-for-categorical-variables"><i class="fa fa-check"></i><b>2.5.11</b> Calculating F-Statistic for Categorical Variables</a></li>
<li class="chapter" data-level="2.5.12" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#calculating-f-statistic-for-categorical-variables-1"><i class="fa fa-check"></i><b>2.5.12</b> Calculating F-Statistic for Categorical Variables</a></li>
<li class="chapter" data-level="2.5.13" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#alternative-calculation-in-r"><i class="fa fa-check"></i><b>2.5.13</b> Alternative Calculation in R</a></li>
<li class="chapter" data-level="2.5.14" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#f-statistic-in-r-output"><i class="fa fa-check"></i><b>2.5.14</b> F-Statistic in R Output</a></li>
<li class="chapter" data-level="2.5.15" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#f-statistic-in-r-output-m1"><i class="fa fa-check"></i><b>2.5.15</b> F-Statistic in R Output M1</a></li>
<li class="chapter" data-level="2.5.16" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#f-statistic-in-r-output-m2"><i class="fa fa-check"></i><b>2.5.16</b> F-Statistic in R Output M2</a></li>
<li class="chapter" data-level="2.5.17" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#f-statistic-in-r-output-m3"><i class="fa fa-check"></i><b>2.5.17</b> F-Statistic in R Output M3</a></li>
<li class="chapter" data-level="2.5.18" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#when-to-use-f-statistics-for-model-comparison"><i class="fa fa-check"></i><b>2.5.18</b> When to Use F-Statistics for Model Comparison</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#models-involving-interaction"><i class="fa fa-check"></i><b>2.6</b> Models Involving Interaction</a><ul>
<li class="chapter" data-level="2.6.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#bear-weights-dataset"><i class="fa fa-check"></i><b>2.6.1</b> Bear Weights Dataset</a></li>
<li class="chapter" data-level="2.6.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#exploring-bears-data"><i class="fa fa-check"></i><b>2.6.2</b> Exploring Bears Data</a></li>
<li class="chapter" data-level="2.6.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#bears-data-cleaning"><i class="fa fa-check"></i><b>2.6.3</b> Bears Data Cleaning</a></li>
<li class="chapter" data-level="2.6.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#bear-weights-and-ages"><i class="fa fa-check"></i><b>2.6.4</b> Bear Weights and Ages</a></li>
<li class="chapter" data-level="2.6.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#two-possible-models"><i class="fa fa-check"></i><b>2.6.5</b> Two Possible Models</a></li>
<li class="chapter" data-level="2.6.6" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#models-with-interaction"><i class="fa fa-check"></i><b>2.6.6</b> Models with Interaction</a></li>
<li class="chapter" data-level="2.6.7" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-equations"><i class="fa fa-check"></i><b>2.6.7</b> Model Equations</a></li>
<li class="chapter" data-level="2.6.8" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#expected-weight-equations"><i class="fa fa-check"></i><b>2.6.8</b> Expected Weight Equations</a></li>
<li class="chapter" data-level="2.6.9" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#interpretations-of-interaction-model-coefficients"><i class="fa fa-check"></i><b>2.6.9</b> Interpretations of Interaction Model Coefficients</a></li>
<li class="chapter" data-level="2.6.10" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-1-r-output"><i class="fa fa-check"></i><b>2.6.10</b> Model 1 R Output</a></li>
<li class="chapter" data-level="2.6.11" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-2-r-output"><i class="fa fa-check"></i><b>2.6.11</b> Model 2 R Output</a></li>
<li class="chapter" data-level="2.6.12" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-1-interpretations"><i class="fa fa-check"></i><b>2.6.12</b> Model 1 Interpretations</a></li>
<li class="chapter" data-level="2.6.13" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-2-interpretations"><i class="fa fa-check"></i><b>2.6.13</b> Model 2 Interpretations</a></li>
<li class="chapter" data-level="2.6.14" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#predicting-bear-weights"><i class="fa fa-check"></i><b>2.6.14</b> Predicting Bear Weights</a></li>
<li class="chapter" data-level="2.6.15" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#predict-function-in-r"><i class="fa fa-check"></i><b>2.6.15</b> <code>predict</code> Function in R</a></li>
<li class="chapter" data-level="2.6.16" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#bears-weight-model-considerations"><i class="fa fa-check"></i><b>2.6.16</b> Bears Weight Model Considerations</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#more-on-interaction"><i class="fa fa-check"></i><b>2.7</b> More on Interaction</a><ul>
<li class="chapter" data-level="2.7.1" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#two-categorical-variables"><i class="fa fa-check"></i><b>2.7.1</b> Two Categorical Variables</a></li>
<li class="chapter" data-level="2.7.2" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#bears-weight-by-season-and-sex"><i class="fa fa-check"></i><b>2.7.2</b> Bears Weight By Season and Sex</a></li>
<li class="chapter" data-level="2.7.3" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#two-models"><i class="fa fa-check"></i><b>2.7.3</b> Two Models</a></li>
<li class="chapter" data-level="2.7.4" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-equations-1"><i class="fa fa-check"></i><b>2.7.4</b> Model Equations</a></li>
<li class="chapter" data-level="2.7.5" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#bears-season-and-sex-interaction-model"><i class="fa fa-check"></i><b>2.7.5</b> Bears Season and Sex Interaction Model</a></li>
<li class="chapter" data-level="2.7.6" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#predictions-for-season-and-sex-interaction-model"><i class="fa fa-check"></i><b>2.7.6</b> Predictions for Season and Sex Interaction Model</a></li>
<li class="chapter" data-level="2.7.7" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#season-and-sex-interaction-model-interpretations"><i class="fa fa-check"></i><b>2.7.7</b> Season and Sex Interaction Model Interpretations</a></li>
<li class="chapter" data-level="2.7.8" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#interpretations-for-season-and-sex-interaction-model"><i class="fa fa-check"></i><b>2.7.8</b> Interpretations for Season and Sex Interaction Model</a></li>
<li class="chapter" data-level="2.7.9" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#predicting-new-observations-in-r"><i class="fa fa-check"></i><b>2.7.9</b> Predicting New Observations in R</a></li>
<li class="chapter" data-level="2.7.10" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#interaction-between-two-quantitative-variables"><i class="fa fa-check"></i><b>2.7.10</b> Interaction Between Two Quantitative Variables</a></li>
<li class="chapter" data-level="2.7.11" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#models-for-age-and-length"><i class="fa fa-check"></i><b>2.7.11</b> Models for Age and Length</a></li>
<li class="chapter" data-level="2.7.12" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#model-equations-2"><i class="fa fa-check"></i><b>2.7.12</b> Model Equations</a></li>
<li class="chapter" data-level="2.7.13" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#and-24-month-old-bears"><i class="fa fa-check"></i><b>2.7.13</b> 6 and 24 Month Old Bears</a></li>
<li class="chapter" data-level="2.7.14" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#interaction-model-in-r"><i class="fa fa-check"></i><b>2.7.14</b> Interaction Model in R</a></li>
<li class="chapter" data-level="2.7.15" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#age-length-interaction-interpretations"><i class="fa fa-check"></i><b>2.7.15</b> Age, Length Interaction Interpretations</a></li>
<li class="chapter" data-level="2.7.16" data-path="introduction-to-statistical-models.html"><a href="introduction-to-statistical-models.html#interaction-vs-correlation"><i class="fa fa-check"></i><b>2.7.16</b> Interaction vs Correlation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html"><i class="fa fa-check"></i><b>3</b> Hypothesis Testing via Permutation</a><ul>
<li class="chapter" data-level="3.1" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#test-for-difference-in-means"><i class="fa fa-check"></i><b>3.1</b> Test for Difference in Means</a><ul>
<li class="chapter" data-level="3.1.1" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#mercury-levels-in-florida-lakes"><i class="fa fa-check"></i><b>3.1.1</b> Mercury Levels in Florida Lakes</a></li>
<li class="chapter" data-level="3.1.2" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#florida-lakes-dataset"><i class="fa fa-check"></i><b>3.1.2</b> Florida Lakes Dataset</a></li>
<li class="chapter" data-level="3.1.3" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#comparing-northern-and-southern-lakes"><i class="fa fa-check"></i><b>3.1.3</b> Comparing Northern and Southern Lakes</a></li>
<li class="chapter" data-level="3.1.4" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#model-for-northern-and-southern-lakes"><i class="fa fa-check"></i><b>3.1.4</b> Model for Northern and Southern Lakes</a></li>
<li class="chapter" data-level="3.1.5" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#model-for-lakes-r-output"><i class="fa fa-check"></i><b>3.1.5</b> Model for Lakes R Output</a></li>
<li class="chapter" data-level="3.1.6" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#interpreting-lakes-regression-output"><i class="fa fa-check"></i><b>3.1.6</b> Interpreting Lakes Regression Output</a></li>
<li class="chapter" data-level="3.1.7" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#evidence-of-difference"><i class="fa fa-check"></i><b>3.1.7</b> Evidence of Difference?</a></li>
<li class="chapter" data-level="3.1.8" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#permutation-test"><i class="fa fa-check"></i><b>3.1.8</b> Permutation Test</a></li>
<li class="chapter" data-level="3.1.9" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#applet-for-permutation-tests"><i class="fa fa-check"></i><b>3.1.9</b> Applet for Permutation Tests</a></li>
<li class="chapter" data-level="3.1.10" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#five-permutations-in-r"><i class="fa fa-check"></i><b>3.1.10</b> Five Permutations in R</a></li>
<li class="chapter" data-level="3.1.11" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#r-code-for-permutation-test"><i class="fa fa-check"></i><b>3.1.11</b> R Code for Permutation Test</a></li>
<li class="chapter" data-level="3.1.12" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#permutation-tests-results"><i class="fa fa-check"></i><b>3.1.12</b> Permutation Tests Results</a></li>
<li class="chapter" data-level="3.1.13" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#conclusions"><i class="fa fa-check"></i><b>3.1.13</b> Conclusions</a></li>
<li class="chapter" data-level="3.1.14" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#hypothesis-testing-terminology"><i class="fa fa-check"></i><b>3.1.14</b> Hypothesis Testing Terminology</a></li>
<li class="chapter" data-level="3.1.15" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#how-low-should-the-p-value-be"><i class="fa fa-check"></i><b>3.1.15</b> How Low Should the p-value Be</a></li>
<li class="chapter" data-level="3.1.16" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#practical-importance"><i class="fa fa-check"></i><b>3.1.16</b> Practical Importance</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#test-for-difference-in-standard-deviation"><i class="fa fa-check"></i><b>3.2</b> Test for Difference in Standard Deviation</a><ul>
<li class="chapter" data-level="3.2.1" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#standard-deviation-northern-and-southern-lakes"><i class="fa fa-check"></i><b>3.2.1</b> Standard Deviation Northern and Southern Lakes</a></li>
<li class="chapter" data-level="3.2.2" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#hypotheses"><i class="fa fa-check"></i><b>3.2.2</b> Hypotheses</a></li>
<li class="chapter" data-level="3.2.3" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#permutation-test-steps"><i class="fa fa-check"></i><b>3.2.3</b> Permutation Test Steps</a></li>
<li class="chapter" data-level="3.2.4" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#r-code-for-permutation-test-1"><i class="fa fa-check"></i><b>3.2.4</b> R Code for Permutation Test</a></li>
<li class="chapter" data-level="3.2.5" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#permutation-tests-results-1"><i class="fa fa-check"></i><b>3.2.5</b> Permutation Tests Results</a></li>
<li class="chapter" data-level="3.2.6" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#conclusions-1"><i class="fa fa-check"></i><b>3.2.6</b> Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#test-for-regression-slope"><i class="fa fa-check"></i><b>3.3</b> Test for Regression Slope</a><ul>
<li class="chapter" data-level="3.3.1" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#cars-dataset"><i class="fa fa-check"></i><b>3.3.1</b> 2015 Cars Dataset</a></li>
<li class="chapter" data-level="3.3.2" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#car-price-and-acceleration-time"><i class="fa fa-check"></i><b>3.3.2</b> Car Price and Acceleration Time</a></li>
<li class="chapter" data-level="3.3.3" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#modeling-price-using-acc060"><i class="fa fa-check"></i><b>3.3.3</b> Modeling Price using Acc060</a></li>
<li class="chapter" data-level="3.3.4" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#modeling-for-car-price-and-acceleration"><i class="fa fa-check"></i><b>3.3.4</b> Modeling for Car Price and Acceleration</a></li>
<li class="chapter" data-level="3.3.5" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#acc060-model-interpretations"><i class="fa fa-check"></i><b>3.3.5</b> Acc060 Model Interpretations</a></li>
<li class="chapter" data-level="3.3.6" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#is-car-price-associated-with-acceleration-time"><i class="fa fa-check"></i><b>3.3.6</b> Is Car Price Associated with Acceleration Time?</a></li>
<li class="chapter" data-level="3.3.7" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#acc060-key-question-and-hypotheses"><i class="fa fa-check"></i><b>3.3.7</b> Acc060 Key Question and Hypotheses</a></li>
<li class="chapter" data-level="3.3.8" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#permutation-test-for-slope"><i class="fa fa-check"></i><b>3.3.8</b> Permutation Test for Slope</a></li>
<li class="chapter" data-level="3.3.9" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#five-permutations"><i class="fa fa-check"></i><b>3.3.9</b> Five Permutations</a></li>
<li class="chapter" data-level="3.3.10" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#fourth-permutation"><i class="fa fa-check"></i><b>3.3.10</b> Fourth Permutation</a></li>
<li class="chapter" data-level="3.3.11" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#r-code-for-permutation-test-2"><i class="fa fa-check"></i><b>3.3.11</b> R Code for Permutation Test</a></li>
<li class="chapter" data-level="3.3.12" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#permutation-test-results"><i class="fa fa-check"></i><b>3.3.12</b> Permutation Test Results</a></li>
<li class="chapter" data-level="3.3.13" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#p-value-and-conclusion"><i class="fa fa-check"></i><b>3.3.13</b> P-value and Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#test-for-comparing-multiple-groups"><i class="fa fa-check"></i><b>3.4</b> Test for Comparing Multiple Groups</a><ul>
<li class="chapter" data-level="3.4.1" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#relationship-price-and-car-size"><i class="fa fa-check"></i><b>3.4.1</b> Relationship Price and Car Size</a></li>
<li class="chapter" data-level="3.4.2" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#cars-questions-of-interest"><i class="fa fa-check"></i><b>3.4.2</b> Cars Questions of Interest</a></li>
<li class="chapter" data-level="3.4.3" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#cars-price-and-size-model"><i class="fa fa-check"></i><b>3.4.3</b> Cars Price and Size Model</a></li>
<li class="chapter" data-level="3.4.4" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#relationship-between-size-and-price"><i class="fa fa-check"></i><b>3.4.4</b> Relationship between Size and Price</a></li>
<li class="chapter" data-level="3.4.5" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#test-statistic-for-car-size-and-price"><i class="fa fa-check"></i><b>3.4.5</b> Test Statistic for Car Size and Price</a></li>
<li class="chapter" data-level="3.4.6" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#key-question-in-car-size-investigation"><i class="fa fa-check"></i><b>3.4.6</b> Key Question in Car Size Investigation</a></li>
<li class="chapter" data-level="3.4.7" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#simulation-based-test-for-f-statistic"><i class="fa fa-check"></i><b>3.4.7</b> Simulation-Based Test for F-Statistic</a></li>
<li class="chapter" data-level="3.4.8" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#five-permutations-1"><i class="fa fa-check"></i><b>3.4.8</b> Five Permutations</a></li>
<li class="chapter" data-level="3.4.9" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#r-code-for-permutation-test-3"><i class="fa fa-check"></i><b>3.4.9</b> R Code For Permutation Test</a></li>
<li class="chapter" data-level="3.4.10" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#f-statistic-for-size-simulation-results"><i class="fa fa-check"></i><b>3.4.10</b> F-statistic for Size Simulation Results</a></li>
<li class="chapter" data-level="3.4.11" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#differences-between-different-sizes"><i class="fa fa-check"></i><b>3.4.11</b> Differences Between Different Sizes</a></li>
<li class="chapter" data-level="3.4.12" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#regression-coefficients-for-tests-between-sizes"><i class="fa fa-check"></i><b>3.4.12</b> Regression Coefficients for Tests Between Sizes</a></li>
<li class="chapter" data-level="3.4.13" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#simulation-for-differences-between-types-of-cars"><i class="fa fa-check"></i><b>3.4.13</b> Simulation for Differences between Types of Cars</a></li>
<li class="chapter" data-level="3.4.14" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#code-for-simulation-based-test-of-prices-by-size"><i class="fa fa-check"></i><b>3.4.14</b> Code for Simulation-Based Test of Prices by Size</a></li>
<li class="chapter" data-level="3.4.15" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#car-size-simulation-based-results-for-b_1"><i class="fa fa-check"></i><b>3.4.15</b> Car Size Simulation-Based Results for <span class="math inline">\(b_1\)</span></a></li>
<li class="chapter" data-level="3.4.16" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#car-size-simulation-based-results-for-b_2"><i class="fa fa-check"></i><b>3.4.16</b> Car Size Simulation-Based Results for <span class="math inline">\(b_2\)</span></a></li>
<li class="chapter" data-level="3.4.17" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#car-size-simulation-based-results-for-b_1-b_2"><i class="fa fa-check"></i><b>3.4.17</b> Car Size Simulation-Based Results for <span class="math inline">\(b_1-b_2\)</span></a></li>
<li class="chapter" data-level="3.4.18" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#bonferroni-correction"><i class="fa fa-check"></i><b>3.4.18</b> Bonferroni Correction</a></li>
<li class="chapter" data-level="3.4.19" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#summary-of-tests-between-multiple-groups"><i class="fa fa-check"></i><b>3.4.19</b> Summary of Tests Between Multiple Groups</a></li>
<li class="chapter" data-level="3.4.20" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#bear-weights-by-season"><i class="fa fa-check"></i><b>3.4.20</b> Bear Weights by Season</a></li>
<li class="chapter" data-level="3.4.21" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#bear-weights-by-season-model"><i class="fa fa-check"></i><b>3.4.21</b> Bear Weights by Season Model</a></li>
<li class="chapter" data-level="3.4.22" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#f-statistic-for-bear-weights-by-season"><i class="fa fa-check"></i><b>3.4.22</b> F-Statistic for Bear Weights by Season</a></li>
<li class="chapter" data-level="3.4.23" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#hypotheses-for-bears-seasons-f-test"><i class="fa fa-check"></i><b>3.4.23</b> Hypotheses for Bears Seasons F-Test</a></li>
<li class="chapter" data-level="3.4.24" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#simulation-based-test-for-bears-f-statistic"><i class="fa fa-check"></i><b>3.4.24</b> Simulation-Based Test for Bears F-Statistic</a></li>
<li class="chapter" data-level="3.4.25" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#bears-f-statistic-simulation"><i class="fa fa-check"></i><b>3.4.25</b> Bears F-Statistic Simulation</a></li>
<li class="chapter" data-level="3.4.26" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#f-statistic-for-bears-season-simulation"><i class="fa fa-check"></i><b>3.4.26</b> F-statistic for Bears Season Simulation</a></li>
<li class="chapter" data-level="3.4.27" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#dont-accept-null-hypothesis"><i class="fa fa-check"></i><b>3.4.27</b> Don’t Accept Null Hypothesis</a></li>
<li class="chapter" data-level="3.4.28" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#comparison-of-weights-by-season"><i class="fa fa-check"></i><b>3.4.28</b> Comparison of Weights by Season</a></li>
<li class="chapter" data-level="3.4.29" data-path="hypothesis-testing-via-permutation.html"><a href="hypothesis-testing-via-permutation.html#dont-accept-null-hypothesis-cont."><i class="fa fa-check"></i><b>3.4.29</b> Don’t Accept Null Hypothesis (Cont.)</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Stat 255: Statistics for Data Science Notes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="hypothesis-testing-via-permutation" class="section level1 hasAnchor">
<h1><span class="header-section-number">Chapter 3</span> Hypothesis Testing via Permutation<a href="hypothesis-testing-via-permutation.html#hypothesis-testing-via-permutation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><strong>Learning Outcomes:</strong></p>
<ol style="list-style-type: decimal">
<li>State null and alternative hypotheses associated with models involving categorical and quantitative explanatory variables.<br />
</li>
<li>Explain how to use permutation tests for hypotheses involving means, medians, F-statistics, slopes, and other regression coefficients, as well as functions of these statistics.<br />
</li>
<li>Interpret p-values in context.<br />
</li>
<li>Explain the conclusions we should draw from from a hypothesis test, while accounting for other information available in a dataset.<br />
</li>
<li>Explain how to simultaneously test for differences between multiple groups.<br />
</li>
<li>Distinguish between statistical significance and practical importance.</li>
</ol>
<div id="test-for-difference-in-means" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.1</span> Test for Difference in Means<a href="hypothesis-testing-via-permutation.html#test-for-difference-in-means" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="mercury-levels-in-florida-lakes" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.1</span> Mercury Levels in Florida Lakes<a href="hypothesis-testing-via-permutation.html#mercury-levels-in-florida-lakes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A 2004 study by Lange, T., Royals, H. and Connor, L. examined Mercury accumulation in large-mouth bass, taken from a sample of 53 Florida Lakes. If Mercury accumulation exceeds 0.5 ppm, then there are environmental concerns. In fact, the legal safety limit in Canada is 0.5 ppm, although it is 1 ppm in the United States.</p>
<div class="figure"><span style="display:block;" id="fig:Bass"></span>
<img src="Bass.png" alt="https://www.maine.gov/ifw/fish-wildlife/fisheries/species-information/largemouth-bass.html" width="50%" />
<p class="caption">
Figure 3.1: <a href="https://www.maine.gov/ifw/fish-wildlife/fisheries/species-information/largemouth-bass.html" class="uri">https://www.maine.gov/ifw/fish-wildlife/fisheries/species-information/largemouth-bass.html</a>
</p>
</div>
</div>
<div id="florida-lakes-dataset" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.2</span> Florida Lakes Dataset<a href="hypothesis-testing-via-permutation.html#florida-lakes-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="hypothesis-testing-via-permutation.html#cb159-1"></a><span class="kw">data</span>(<span class="st">&quot;FloridaLakes&quot;</span>)</span>
<span id="cb159-2"><a href="hypothesis-testing-via-permutation.html#cb159-2"></a><span class="kw">glimpse</span>(FloridaLakes)</span></code></pre></div>
<pre><code>## Rows: 53
## Columns: 12
## $ ID                &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 1…
## $ Lake              &lt;chr&gt; &quot;Alligator&quot;, &quot;Annie&quot;, &quot;Apopka&quot;, &quot;Blue Cypress&quot;, &quot;Bri…
## $ Alkalinity        &lt;dbl&gt; 5.9, 3.5, 116.0, 39.4, 2.5, 19.6, 5.2, 71.4, 26.4, 4…
## $ pH                &lt;dbl&gt; 6.1, 5.1, 9.1, 6.9, 4.6, 7.3, 5.4, 8.1, 5.8, 6.4, 5.…
## $ Calcium           &lt;dbl&gt; 3.0, 1.9, 44.1, 16.4, 2.9, 4.5, 2.8, 55.2, 9.2, 4.6,…
## $ Chlorophyll       &lt;dbl&gt; 0.7, 3.2, 128.3, 3.5, 1.8, 44.1, 3.4, 33.7, 1.6, 22.…
## $ AvgMercury        &lt;dbl&gt; 1.23, 1.33, 0.04, 0.44, 1.20, 0.27, 0.48, 0.19, 0.83…
## $ NumSamples        &lt;int&gt; 5, 7, 6, 12, 12, 14, 10, 12, 24, 12, 12, 12, 7, 43, …
## $ MinMercury        &lt;dbl&gt; 0.85, 0.92, 0.04, 0.13, 0.69, 0.04, 0.30, 0.08, 0.26…
## $ MaxMercury        &lt;dbl&gt; 1.43, 1.90, 0.06, 0.84, 1.50, 0.48, 0.72, 0.38, 1.40…
## $ ThreeYrStdMercury &lt;dbl&gt; 1.53, 1.33, 0.04, 0.44, 1.33, 0.25, 0.45, 0.16, 0.72…
## $ AgeData           &lt;int&gt; 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1…</code></pre>
<p>We are interested in whether mercury levels are higher or lower, on average, in Northern Florida compared to Southern Florida.</p>
<p>We’ll divide the state along route 50, which runs East-West, passing through Northern Orlando.</p>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-139"></span>
<img src="Florida.png" alt="from Google Maps" width="30%" />
<p class="caption">
Figure 3.2: from Google Maps
</p>
</div>
<p>We add a variable indicating whether each lake lies in the northern or southern part of the state.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="hypothesis-testing-via-permutation.html#cb161-1"></a><span class="kw">library</span>(Lock5Data)</span>
<span id="cb161-2"><a href="hypothesis-testing-via-permutation.html#cb161-2"></a><span class="kw">data</span>(FloridaLakes)</span>
<span id="cb161-3"><a href="hypothesis-testing-via-permutation.html#cb161-3"></a><span class="co">#Location relative to rt. 50</span></span>
<span id="cb161-4"><a href="hypothesis-testing-via-permutation.html#cb161-4"></a>FloridaLakes<span class="op">$</span>Location &lt;-<span class="st"> </span><span class="kw">as.factor</span>(<span class="kw">c</span>(<span class="st">&quot;S&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;S&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>,<span class="st">&quot;N&quot;</span>))</span>
<span id="cb161-5"><a href="hypothesis-testing-via-permutation.html#cb161-5"></a><span class="kw">print.data.frame</span>(<span class="kw">data.frame</span>(FloridaLakes<span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Lake, Location, AvgMercury)), <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>##               Lake Location AvgMercury
##          Alligator        S       1.23
##              Annie        S       1.33
##             Apopka        N       0.04
##       Blue Cypress        S       0.44
##              Brick        S       1.20
##             Bryant        N       0.27
##             Cherry        N       0.48
##           Crescent        N       0.19
##         Deer Point        N       0.83
##               Dias        N       0.81
##               Dorr        N       0.71
##               Down        S       0.50
##              Eaton        N       0.49
##  East Tohopekaliga        S       1.16
##            Farm-13        N       0.05
##             George        N       0.15
##            Griffin        N       0.19
##             Harney        N       0.77
##               Hart        S       1.08
##         Hatchineha        S       0.98
##            Iamonia        N       0.63
##          Istokpoga        S       0.56
##            Jackson        N       0.41
##          Josephine        S       0.73
##           Kingsley        N       0.34
##          Kissimmee        S       0.59
##          Lochloosa        N       0.34
##             Louisa        S       0.84
##         Miccasukee        N       0.50
##           Minneola        N       0.34
##             Monroe        N       0.28
##            Newmans        N       0.34
##         Ocean Pond        N       0.87
##       Ocheese Pond        N       0.56
##         Okeechobee        S       0.17
##             Orange        N       0.18
##        Panasoffkee        N       0.19
##             Parker        S       0.04
##             Placid        S       0.49
##             Puzzle        N       1.10
##             Rodman        N       0.16
##           Rousseau        N       0.10
##            Sampson        N       0.48
##              Shipp        S       0.21
##            Talquin        N       0.86
##             Tarpon        S       0.52
##       Tohopekaliga        S       0.65
##           Trafford        S       0.27
##              Trout        S       0.94
##       Tsala Apopka        N       0.40
##               Weir        N       0.43
##            Wildcat        N       0.25
##               Yale        N       0.27</code></pre>
</div>
<div id="comparing-northern-and-southern-lakes" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.3</span> Comparing Northern and Southern Lakes<a href="hypothesis-testing-via-permutation.html#comparing-northern-and-southern-lakes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We are interested in investigating whether average mercury levels are higher in either Northern Florida or Southern Florida than the other.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="hypothesis-testing-via-permutation.html#cb163-1"></a>LakesBP &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>FloridaLakes, <span class="kw">aes</span>(<span class="dt">x=</span>Location, <span class="dt">y=</span>AvgMercury, <span class="dt">fill=</span>Location)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb163-2"><a href="hypothesis-testing-via-permutation.html#cb163-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st">   </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Mercury Levels in Florida Lakes&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb163-3"><a href="hypothesis-testing-via-permutation.html#cb163-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Location&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Mercury Level&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() </span>
<span id="cb163-4"><a href="hypothesis-testing-via-permutation.html#cb163-4"></a>LakesBP</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-141-1.png" width="672" /></p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="hypothesis-testing-via-permutation.html#cb164-1"></a>LakesTable &lt;-<span class="st"> </span>FloridaLakes <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Location) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">MeanHg=</span><span class="kw">mean</span>(AvgMercury), <span class="dt">StDevHg=</span><span class="kw">sd</span>(AvgMercury),  <span class="dt">N=</span><span class="kw">n</span>())</span>
<span id="cb164-2"><a href="hypothesis-testing-via-permutation.html#cb164-2"></a><span class="kw">kable</span>(LakesTable)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Location</th>
<th align="right">MeanHg</th>
<th align="right">StDevHg</th>
<th align="right">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N</td>
<td align="right">0.4245455</td>
<td align="right">0.2696652</td>
<td align="right">33</td>
</tr>
<tr class="even">
<td align="left">S</td>
<td align="right">0.6965000</td>
<td align="right">0.3838760</td>
<td align="right">20</td>
</tr>
</tbody>
</table>
</div>
<div id="model-for-northern-and-southern-lakes" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.4</span> Model for Northern and Southern Lakes<a href="hypothesis-testing-via-permutation.html#model-for-northern-and-southern-lakes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(\widehat{\text{Hg}} = b_0 +b_1\text{I}_{\text{South}}\)</span></p>
<ul>
<li><span class="math inline">\(b_0\)</span> represents the mean mercury level for lakes in North Florida, and<br />
</li>
<li><span class="math inline">\(b_1\)</span> represents the mean difference in mercury level for lakes in South Florida, compared to North Florida</li>
</ul>
</div>
<div id="model-for-lakes-r-output" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.5</span> Model for Lakes R Output<a href="hypothesis-testing-via-permutation.html#model-for-lakes-r-output" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="hypothesis-testing-via-permutation.html#cb165-1"></a>Lakes_M &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>FloridaLakes, AvgMercury <span class="op">~</span><span class="st"> </span>Location)</span>
<span id="cb165-2"><a href="hypothesis-testing-via-permutation.html#cb165-2"></a><span class="kw">summary</span>(Lakes_M)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = AvgMercury ~ Location, data = FloridaLakes)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.65650 -0.23455 -0.08455  0.24350  0.67545 
## 
## Coefficients:
##             Estimate Std. Error t value       Pr(&gt;|t|)    
## (Intercept)  0.42455    0.05519   7.692 0.000000000441 ***
## LocationS    0.27195    0.08985   3.027        0.00387 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3171 on 51 degrees of freedom
## Multiple R-squared:  0.1523, Adjusted R-squared:  0.1357 
## F-statistic: 9.162 on 1 and 51 DF,  p-value: 0.003868</code></pre>
</div>
<div id="interpreting-lakes-regression-output" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.6</span> Interpreting Lakes Regression Output<a href="hypothesis-testing-via-permutation.html#interpreting-lakes-regression-output" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(\widehat{\text{Hg}} = 0.4245455 +0.2719545\text{I}_{\text{South}}\)</span></p>
<ul>
<li><p><span class="math inline">\(b_1 = 0.27915= 0.6965 - 0.4245\)</span> is equal to the difference in mean mercury levels between Northern and Southern lakes. (We’ve already seen that for categorical variables, the least-squares estimate is the mean, so this makes sense.)</p></li>
<li><p>We can use <span class="math inline">\(b_1\)</span> to assess the size of the difference in mean mercury concentration levels.</p></li>
<li><p>Since the lakes we observed are only a sample of all lakes, we cannot assume the difference in mercury concentrations is exactly 0.4245 for all Northern vs Southern Florida lakes.</p></li>
</ul>
</div>
<div id="evidence-of-difference" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.7</span> Evidence of Difference?<a href="hypothesis-testing-via-permutation.html#evidence-of-difference" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>Do these results provide evidence that among all Florida lakes, the mean mercury level is higher in the South than in the North?</li>
</ul>
<p>Possible Explanations:<br />
1. There really is a difference in average mercury level between lakes in Northern and Southern Florida.<br />
2. There really is no difference in average mercury levels between lakes in Northern and Southern Florida, and we just happened, by chance, to select more lakes with higher mercury concentrations in Southern Florida.</p>
<p><strong>Question:</strong> Which of these explanations do you think is more reasonable?</p>
</div>
<div id="permutation-test" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.8</span> Permutation Test<a href="hypothesis-testing-via-permutation.html#permutation-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Key Question:</strong></p>
<ul>
<li>How likely is it that we would have observed a difference in means (i.e. a value of <span class="math inline">\(b_1\)</span>) as extreme as 0.6965-0.4245 = 0.27195 ppm, merely by chance, if there is really no relationship between location and mercury level?</li>
</ul>
<p>We can answer the key question using a procedure known as a <strong>permutation test</strong>. In a permutation test, we randomly permute our data to simulate a situation where there is no relationship between our explanatory and response variable. We observe whether it is plausible to observe values of a statistic (in this case the difference in means) as extreme or more extreme than what we saw in the actual data.</p>
<p>We’ll simulate situations where there is no relationship between location and mercury level, and see how often we observe a difference in means (<span class="math inline">\(b_1\)</span>) as extreme as 0.27195.</p>
<p><strong>Procedure:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Randomly shuffle the locations of the lakes, so that any relationship between location and mercury level is due only to chance.</p></li>
<li><p>Calculate the difference in mean mercury levels (i.e. value of <span class="math inline">\(b_1\)</span>) in “Northern” and “Southern” lakes, using the shuffled data.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, recording the difference in means (i.e. value of <span class="math inline">\(b_1\)</span>) each time.<br />
</p></li>
<li><p>Analyze the distribution of mean differences, simulated under the assumption that there is no relationship between location and mercury level. Look whether the actual difference we observed is consistent with the simulation results.</p></li>
</ol>
</div>
<div id="applet-for-permutation-tests" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.9</span> Applet for Permutation Tests<a href="hypothesis-testing-via-permutation.html#applet-for-permutation-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>An <a href="https://istats.shinyapps.io/PermDist_2samples/">Art of Stat Web App</a> performs the steps listed above.</p>
<p>Follow these steps to perform the simulation.<br />
1. Open the app.<br />
2. Under “Enter Data”, Choose “Provide Own”.<br />
3. For “Response Variable”, type in “Mercury Concentration.”<br />
4. For “Group 1 Label”, enter “North”, and for “Group 2 Label”, enter “South”.<br />
5. Copy/paste the following values into the “Group 1 Data” box. These are the mercury concentrations in the lakes in North Florida.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="hypothesis-testing-via-permutation.html#cb167-1"></a>NLakesHg &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(FloridaLakes <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Location<span class="op">==</span><span class="st">&quot;N&quot;</span>))<span class="op">$</span>AvgMercury</span>
<span id="cb167-2"><a href="hypothesis-testing-via-permutation.html#cb167-2"></a><span class="kw">kable</span>(NLakesHg, <span class="dt">fill =</span> <span class="kw">getOption</span>(<span class="st">&quot;width&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.04</td>
</tr>
<tr class="even">
<td align="right">0.27</td>
</tr>
<tr class="odd">
<td align="right">0.48</td>
</tr>
<tr class="even">
<td align="right">0.19</td>
</tr>
<tr class="odd">
<td align="right">0.83</td>
</tr>
<tr class="even">
<td align="right">0.81</td>
</tr>
<tr class="odd">
<td align="right">0.71</td>
</tr>
<tr class="even">
<td align="right">0.49</td>
</tr>
<tr class="odd">
<td align="right">0.05</td>
</tr>
<tr class="even">
<td align="right">0.15</td>
</tr>
<tr class="odd">
<td align="right">0.19</td>
</tr>
<tr class="even">
<td align="right">0.77</td>
</tr>
<tr class="odd">
<td align="right">0.63</td>
</tr>
<tr class="even">
<td align="right">0.41</td>
</tr>
<tr class="odd">
<td align="right">0.34</td>
</tr>
<tr class="even">
<td align="right">0.34</td>
</tr>
<tr class="odd">
<td align="right">0.50</td>
</tr>
<tr class="even">
<td align="right">0.34</td>
</tr>
<tr class="odd">
<td align="right">0.28</td>
</tr>
<tr class="even">
<td align="right">0.34</td>
</tr>
<tr class="odd">
<td align="right">0.87</td>
</tr>
<tr class="even">
<td align="right">0.56</td>
</tr>
<tr class="odd">
<td align="right">0.18</td>
</tr>
<tr class="even">
<td align="right">0.19</td>
</tr>
<tr class="odd">
<td align="right">1.10</td>
</tr>
<tr class="even">
<td align="right">0.16</td>
</tr>
<tr class="odd">
<td align="right">0.10</td>
</tr>
<tr class="even">
<td align="right">0.48</td>
</tr>
<tr class="odd">
<td align="right">0.86</td>
</tr>
<tr class="even">
<td align="right">0.40</td>
</tr>
<tr class="odd">
<td align="right">0.43</td>
</tr>
<tr class="even">
<td align="right">0.25</td>
</tr>
<tr class="odd">
<td align="right">0.27</td>
</tr>
</tbody>
</table>
<ol start="5" style="list-style-type: decimal">
<li>Copy/paste the following values into the “Group 2 Data” box. These are the mercury concentrations in the lakes in North Florida.</li>
</ol>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="hypothesis-testing-via-permutation.html#cb168-1"></a>NLakesHg &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(FloridaLakes <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(Location<span class="op">==</span><span class="st">&quot;S&quot;</span>))<span class="op">$</span>AvgMercury</span>
<span id="cb168-2"><a href="hypothesis-testing-via-permutation.html#cb168-2"></a><span class="kw">kable</span>(NLakesHg, <span class="dt">fill =</span> <span class="kw">getOption</span>(<span class="st">&quot;width&quot;</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1.23</td>
</tr>
<tr class="even">
<td align="right">1.33</td>
</tr>
<tr class="odd">
<td align="right">0.44</td>
</tr>
<tr class="even">
<td align="right">1.20</td>
</tr>
<tr class="odd">
<td align="right">0.50</td>
</tr>
<tr class="even">
<td align="right">1.16</td>
</tr>
<tr class="odd">
<td align="right">1.08</td>
</tr>
<tr class="even">
<td align="right">0.98</td>
</tr>
<tr class="odd">
<td align="right">0.56</td>
</tr>
<tr class="even">
<td align="right">0.73</td>
</tr>
<tr class="odd">
<td align="right">0.59</td>
</tr>
<tr class="even">
<td align="right">0.84</td>
</tr>
<tr class="odd">
<td align="right">0.17</td>
</tr>
<tr class="even">
<td align="right">0.04</td>
</tr>
<tr class="odd">
<td align="right">0.49</td>
</tr>
<tr class="even">
<td align="right">0.21</td>
</tr>
<tr class="odd">
<td align="right">0.52</td>
</tr>
<tr class="even">
<td align="right">0.65</td>
</tr>
<tr class="odd">
<td align="right">0.27</td>
</tr>
<tr class="even">
<td align="right">0.94</td>
</tr>
</tbody>
</table>
<ol start="6" style="list-style-type: decimal">
<li><p>For the question: “Select how many permutations you want to generate:” Choose 1.</p></li>
<li><p>Click “Generate”</p></li>
<li><p>The app will randomly assign the lakes to groups, with sizes matching the original data, and calculate the mean for each group. Observe means in the “Permuted Sample” and the difference in means. Is the difference as extreme as we observed in the actual data?</p></li>
</ol>
<p>STOP HERE UNTIL FURTHER INSTRUCTED.</p>
<ol start="9" style="list-style-type: decimal">
<li>Now generate 5 more permutations. Did you get any differences in means as extreme as we observed in the original data? What does this tell us about the likelihood of observing a difference in means as extreme as 0.27 by chance?</li>
</ol>
<p>STOP HERE UNTIL FURTHER INSTRUCTED.</p>
<ol start="10" style="list-style-type: decimal">
<li>Now generate 10,000 permutations. How often do you get a difference as extreme as we observed in the original data? What does this tell us about the likelihood of observing a difference in means as extreme as 0.27 by chance?</li>
</ol>
</div>
<div id="five-permutations-in-r" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.10</span> Five Permutations in R<a href="hypothesis-testing-via-permutation.html#five-permutations-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll use R to perform permutation tests in the same manner as is done in the Art of Stat App.</p>
<p><strong>First Permutation</strong></p>
<p>Recall these groups were randomly assigned, so the only differences in averages are due to random chance.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="hypothesis-testing-via-permutation.html#cb169-1"></a>ShuffledLakes &lt;-<span class="st"> </span>FloridaLakes    <span class="co">## create copy of dataset</span></span>
<span id="cb169-2"><a href="hypothesis-testing-via-permutation.html#cb169-2"></a>ShuffledLakes<span class="op">$</span>Location &lt;-<span class="st"> </span>ShuffledLakes<span class="op">$</span>Location[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledLakes))] </span></code></pre></div>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="hypothesis-testing-via-permutation.html#cb170-1"></a>Shuffle1df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(FloridaLakes<span class="op">$</span>Lake, FloridaLakes<span class="op">$</span>Location, FloridaLakes<span class="op">$</span>AvgMercury, ShuffledLakes<span class="op">$</span>Location)</span>
<span id="cb170-2"><a href="hypothesis-testing-via-permutation.html#cb170-2"></a><span class="kw">names</span>(Shuffle1df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Lake&quot;</span>, <span class="st">&quot;Location&quot;</span>, <span class="st">&quot;AvgMercury&quot;</span>, <span class="st">&quot;Shuffled Location&quot;</span>)</span>
<span id="cb170-3"><a href="hypothesis-testing-via-permutation.html#cb170-3"></a><span class="kw">kable</span>(<span class="kw">head</span>(Shuffle1df))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Lake</th>
<th align="left">Location</th>
<th align="right">AvgMercury</th>
<th align="left">Shuffled Location</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alligator</td>
<td align="left">S</td>
<td align="right">1.23</td>
<td align="left">N</td>
</tr>
<tr class="even">
<td align="left">Annie</td>
<td align="left">S</td>
<td align="right">1.33</td>
<td align="left">S</td>
</tr>
<tr class="odd">
<td align="left">Apopka</td>
<td align="left">N</td>
<td align="right">0.04</td>
<td align="left">S</td>
</tr>
<tr class="even">
<td align="left">Blue Cypress</td>
<td align="left">S</td>
<td align="right">0.44</td>
<td align="left">N</td>
</tr>
<tr class="odd">
<td align="left">Brick</td>
<td align="left">S</td>
<td align="right">1.20</td>
<td align="left">N</td>
</tr>
<tr class="even">
<td align="left">Bryant</td>
<td align="left">N</td>
<td align="right">0.27</td>
<td align="left">N</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="hypothesis-testing-via-permutation.html#cb171-1"></a>LakesPerm &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>Shuffle1df, <span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">Shuffled Location</span><span class="st">`</span>, <span class="dt">y=</span>AvgMercury, <span class="dt">fill=</span><span class="st">`</span><span class="dt">Shuffled Location</span><span class="st">`</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb171-2"><a href="hypothesis-testing-via-permutation.html#cb171-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st">   </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Mercury Levels in Florida Lakes&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb171-3"><a href="hypothesis-testing-via-permutation.html#cb171-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Location&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Mercury Level&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</span>
<span id="cb171-4"><a href="hypothesis-testing-via-permutation.html#cb171-4"></a>LakesPerm</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-148-1.png" width="672" /></p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="hypothesis-testing-via-permutation.html#cb172-1"></a>LakesPermTable &lt;-<span class="st"> </span>Shuffle1df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(<span class="st">`</span><span class="dt">Shuffled Location</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">MeanHg=</span><span class="kw">mean</span>(AvgMercury), <span class="dt">StDevHg=</span><span class="kw">sd</span>(AvgMercury),  <span class="dt">N=</span><span class="kw">n</span>())</span>
<span id="cb172-2"><a href="hypothesis-testing-via-permutation.html#cb172-2"></a><span class="kw">kable</span>(LakesPermTable)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Shuffled Location</th>
<th align="right">MeanHg</th>
<th align="right">StDevHg</th>
<th align="right">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N</td>
<td align="right">0.5460606</td>
<td align="right">0.3552986</td>
<td align="right">33</td>
</tr>
<tr class="even">
<td align="left">S</td>
<td align="right">0.4960000</td>
<td align="right">0.3225784</td>
<td align="right">20</td>
</tr>
</tbody>
</table>
<p><strong>Second Permutation</strong></p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="hypothesis-testing-via-permutation.html#cb173-1"></a>ShuffledLakes &lt;-<span class="st"> </span>FloridaLakes    <span class="co">## create copy of dataset</span></span>
<span id="cb173-2"><a href="hypothesis-testing-via-permutation.html#cb173-2"></a>ShuffledLakes<span class="op">$</span>Location &lt;-<span class="st"> </span>ShuffledLakes<span class="op">$</span>Location[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledLakes))] </span>
<span id="cb173-3"><a href="hypothesis-testing-via-permutation.html#cb173-3"></a><span class="kw">kable</span>(<span class="kw">head</span>(Shuffle1df))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Lake</th>
<th align="left">Location</th>
<th align="right">AvgMercury</th>
<th align="left">Shuffled Location</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alligator</td>
<td align="left">S</td>
<td align="right">1.23</td>
<td align="left">N</td>
</tr>
<tr class="even">
<td align="left">Annie</td>
<td align="left">S</td>
<td align="right">1.33</td>
<td align="left">S</td>
</tr>
<tr class="odd">
<td align="left">Apopka</td>
<td align="left">N</td>
<td align="right">0.04</td>
<td align="left">S</td>
</tr>
<tr class="even">
<td align="left">Blue Cypress</td>
<td align="left">S</td>
<td align="right">0.44</td>
<td align="left">N</td>
</tr>
<tr class="odd">
<td align="left">Brick</td>
<td align="left">S</td>
<td align="right">1.20</td>
<td align="left">N</td>
</tr>
<tr class="even">
<td align="left">Bryant</td>
<td align="left">N</td>
<td align="right">0.27</td>
<td align="left">N</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="hypothesis-testing-via-permutation.html#cb174-1"></a>Shuffle1df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(FloridaLakes<span class="op">$</span>Lake, FloridaLakes<span class="op">$</span>Location, FloridaLakes<span class="op">$</span>AvgMercury, ShuffledLakes<span class="op">$</span>Location)</span>
<span id="cb174-2"><a href="hypothesis-testing-via-permutation.html#cb174-2"></a><span class="kw">names</span>(Shuffle1df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Lake&quot;</span>, <span class="st">&quot;Location&quot;</span>, <span class="st">&quot;AvgMercury&quot;</span>, <span class="st">&quot;Shuffled Location&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="hypothesis-testing-via-permutation.html#cb175-1"></a>LakesPerm &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>Shuffle1df, <span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">Shuffled Location</span><span class="st">`</span>, <span class="dt">y=</span>AvgMercury, <span class="dt">fill=</span><span class="st">`</span><span class="dt">Shuffled Location</span><span class="st">`</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb175-2"><a href="hypothesis-testing-via-permutation.html#cb175-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st">   </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Mercury Levels in Florida Lakes&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb175-3"><a href="hypothesis-testing-via-permutation.html#cb175-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Location&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Mercury Level&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</span>
<span id="cb175-4"><a href="hypothesis-testing-via-permutation.html#cb175-4"></a>LakesPerm</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-152-1.png" width="672" /></p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="hypothesis-testing-via-permutation.html#cb176-1"></a>LakesPermTable &lt;-<span class="st"> </span>Shuffle1df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(<span class="st">`</span><span class="dt">Shuffled Location</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">MeanHg=</span><span class="kw">mean</span>(AvgMercury), <span class="dt">StDevHg=</span><span class="kw">sd</span>(AvgMercury),  <span class="dt">N=</span><span class="kw">n</span>())</span>
<span id="cb176-2"><a href="hypothesis-testing-via-permutation.html#cb176-2"></a><span class="kw">kable</span>(LakesPermTable)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Shuffled Location</th>
<th align="right">MeanHg</th>
<th align="right">StDevHg</th>
<th align="right">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N</td>
<td align="right">0.4839394</td>
<td align="right">0.3316431</td>
<td align="right">33</td>
</tr>
<tr class="even">
<td align="left">S</td>
<td align="right">0.5985000</td>
<td align="right">0.3527975</td>
<td align="right">20</td>
</tr>
</tbody>
</table>
<p><strong>Third Permutation</strong></p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="hypothesis-testing-via-permutation.html#cb177-1"></a>ShuffledLakes &lt;-<span class="st"> </span>FloridaLakes    <span class="co">## create copy of dataset</span></span>
<span id="cb177-2"><a href="hypothesis-testing-via-permutation.html#cb177-2"></a>ShuffledLakes<span class="op">$</span>Location &lt;-<span class="st"> </span>ShuffledLakes<span class="op">$</span>Location[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledLakes))] </span>
<span id="cb177-3"><a href="hypothesis-testing-via-permutation.html#cb177-3"></a><span class="kw">kable</span>(<span class="kw">head</span>(Shuffle1df))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Lake</th>
<th align="left">Location</th>
<th align="right">AvgMercury</th>
<th align="left">Shuffled Location</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alligator</td>
<td align="left">S</td>
<td align="right">1.23</td>
<td align="left">S</td>
</tr>
<tr class="even">
<td align="left">Annie</td>
<td align="left">S</td>
<td align="right">1.33</td>
<td align="left">S</td>
</tr>
<tr class="odd">
<td align="left">Apopka</td>
<td align="left">N</td>
<td align="right">0.04</td>
<td align="left">N</td>
</tr>
<tr class="even">
<td align="left">Blue Cypress</td>
<td align="left">S</td>
<td align="right">0.44</td>
<td align="left">S</td>
</tr>
<tr class="odd">
<td align="left">Brick</td>
<td align="left">S</td>
<td align="right">1.20</td>
<td align="left">N</td>
</tr>
<tr class="even">
<td align="left">Bryant</td>
<td align="left">N</td>
<td align="right">0.27</td>
<td align="left">S</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="hypothesis-testing-via-permutation.html#cb178-1"></a>Shuffle1df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(FloridaLakes<span class="op">$</span>Lake, FloridaLakes<span class="op">$</span>Location, FloridaLakes<span class="op">$</span>AvgMercury, ShuffledLakes<span class="op">$</span>Location)</span>
<span id="cb178-2"><a href="hypothesis-testing-via-permutation.html#cb178-2"></a><span class="kw">names</span>(Shuffle1df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Lake&quot;</span>, <span class="st">&quot;Location&quot;</span>, <span class="st">&quot;AvgMercury&quot;</span>, <span class="st">&quot;Shuffled Location&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="hypothesis-testing-via-permutation.html#cb179-1"></a>LakesPerm &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>Shuffle1df, <span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">Shuffled Location</span><span class="st">`</span>, <span class="dt">y=</span>AvgMercury, <span class="dt">fill=</span><span class="st">`</span><span class="dt">Shuffled Location</span><span class="st">`</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb179-2"><a href="hypothesis-testing-via-permutation.html#cb179-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st">   </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Mercury Levels in Florida Lakes&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb179-3"><a href="hypothesis-testing-via-permutation.html#cb179-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Location&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Mercury Level&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</span>
<span id="cb179-4"><a href="hypothesis-testing-via-permutation.html#cb179-4"></a>LakesPerm</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-156-1.png" width="672" /></p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="hypothesis-testing-via-permutation.html#cb180-1"></a>LakesPermTable &lt;-<span class="st"> </span>Shuffle1df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(<span class="st">`</span><span class="dt">Shuffled Location</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">MeanHg=</span><span class="kw">mean</span>(AvgMercury), <span class="dt">StDevHg=</span><span class="kw">sd</span>(AvgMercury),  <span class="dt">N=</span><span class="kw">n</span>())</span>
<span id="cb180-2"><a href="hypothesis-testing-via-permutation.html#cb180-2"></a><span class="kw">kable</span>(LakesPermTable)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Shuffled Location</th>
<th align="right">MeanHg</th>
<th align="right">StDevHg</th>
<th align="right">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N</td>
<td align="right">0.5324242</td>
<td align="right">0.3863777</td>
<td align="right">33</td>
</tr>
<tr class="even">
<td align="left">S</td>
<td align="right">0.5185000</td>
<td align="right">0.2583607</td>
<td align="right">20</td>
</tr>
</tbody>
</table>
<p><strong>Fourth Permutation</strong></p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="hypothesis-testing-via-permutation.html#cb181-1"></a>ShuffledLakes &lt;-<span class="st"> </span>FloridaLakes    <span class="co">## create copy of dataset</span></span>
<span id="cb181-2"><a href="hypothesis-testing-via-permutation.html#cb181-2"></a>ShuffledLakes<span class="op">$</span>Location &lt;-<span class="st"> </span>ShuffledLakes<span class="op">$</span>Location[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledLakes))] </span>
<span id="cb181-3"><a href="hypothesis-testing-via-permutation.html#cb181-3"></a><span class="kw">kable</span>(<span class="kw">head</span>(Shuffle1df))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Lake</th>
<th align="left">Location</th>
<th align="right">AvgMercury</th>
<th align="left">Shuffled Location</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alligator</td>
<td align="left">S</td>
<td align="right">1.23</td>
<td align="left">N</td>
</tr>
<tr class="even">
<td align="left">Annie</td>
<td align="left">S</td>
<td align="right">1.33</td>
<td align="left">N</td>
</tr>
<tr class="odd">
<td align="left">Apopka</td>
<td align="left">N</td>
<td align="right">0.04</td>
<td align="left">N</td>
</tr>
<tr class="even">
<td align="left">Blue Cypress</td>
<td align="left">S</td>
<td align="right">0.44</td>
<td align="left">S</td>
</tr>
<tr class="odd">
<td align="left">Brick</td>
<td align="left">S</td>
<td align="right">1.20</td>
<td align="left">N</td>
</tr>
<tr class="even">
<td align="left">Bryant</td>
<td align="left">N</td>
<td align="right">0.27</td>
<td align="left">S</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="hypothesis-testing-via-permutation.html#cb182-1"></a>Shuffle1df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(FloridaLakes<span class="op">$</span>Lake, FloridaLakes<span class="op">$</span>Location, FloridaLakes<span class="op">$</span>AvgMercury, ShuffledLakes<span class="op">$</span>Location)</span>
<span id="cb182-2"><a href="hypothesis-testing-via-permutation.html#cb182-2"></a><span class="kw">names</span>(Shuffle1df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Lake&quot;</span>, <span class="st">&quot;Location&quot;</span>, <span class="st">&quot;AvgMercury&quot;</span>, <span class="st">&quot;Shuffled Location&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="hypothesis-testing-via-permutation.html#cb183-1"></a>LakesPerm &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>Shuffle1df, <span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">Shuffled Location</span><span class="st">`</span>, <span class="dt">y=</span>AvgMercury, <span class="dt">fill=</span><span class="st">`</span><span class="dt">Shuffled Location</span><span class="st">`</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb183-2"><a href="hypothesis-testing-via-permutation.html#cb183-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st">   </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Mercury Levels in Florida Lakes&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb183-3"><a href="hypothesis-testing-via-permutation.html#cb183-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Location&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Mercury Level&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</span>
<span id="cb183-4"><a href="hypothesis-testing-via-permutation.html#cb183-4"></a>LakesPerm</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-160-1.png" width="672" /></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="hypothesis-testing-via-permutation.html#cb184-1"></a>LakesPermTable &lt;-<span class="st"> </span>Shuffle1df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(<span class="st">`</span><span class="dt">Shuffled Location</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">MeanHg=</span><span class="kw">mean</span>(AvgMercury), <span class="dt">StDevHg=</span><span class="kw">sd</span>(AvgMercury),  <span class="dt">N=</span><span class="kw">n</span>())</span>
<span id="cb184-2"><a href="hypothesis-testing-via-permutation.html#cb184-2"></a><span class="kw">kable</span>(LakesPermTable)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Shuffled Location</th>
<th align="right">MeanHg</th>
<th align="right">StDevHg</th>
<th align="right">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N</td>
<td align="right">0.4833333</td>
<td align="right">0.3314803</td>
<td align="right">33</td>
</tr>
<tr class="even">
<td align="left">S</td>
<td align="right">0.5995000</td>
<td align="right">0.3527109</td>
<td align="right">20</td>
</tr>
</tbody>
</table>
<p><strong>Fifth Permutation</strong></p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="hypothesis-testing-via-permutation.html#cb185-1"></a>ShuffledLakes &lt;-<span class="st"> </span>FloridaLakes    <span class="co">## create copy of dataset</span></span>
<span id="cb185-2"><a href="hypothesis-testing-via-permutation.html#cb185-2"></a>ShuffledLakes<span class="op">$</span>Location &lt;-<span class="st"> </span>ShuffledLakes<span class="op">$</span>Location[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledLakes))] </span>
<span id="cb185-3"><a href="hypothesis-testing-via-permutation.html#cb185-3"></a><span class="kw">kable</span>(<span class="kw">head</span>(Shuffle1df))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Lake</th>
<th align="left">Location</th>
<th align="right">AvgMercury</th>
<th align="left">Shuffled Location</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alligator</td>
<td align="left">S</td>
<td align="right">1.23</td>
<td align="left">N</td>
</tr>
<tr class="even">
<td align="left">Annie</td>
<td align="left">S</td>
<td align="right">1.33</td>
<td align="left">S</td>
</tr>
<tr class="odd">
<td align="left">Apopka</td>
<td align="left">N</td>
<td align="right">0.04</td>
<td align="left">N</td>
</tr>
<tr class="even">
<td align="left">Blue Cypress</td>
<td align="left">S</td>
<td align="right">0.44</td>
<td align="left">N</td>
</tr>
<tr class="odd">
<td align="left">Brick</td>
<td align="left">S</td>
<td align="right">1.20</td>
<td align="left">N</td>
</tr>
<tr class="even">
<td align="left">Bryant</td>
<td align="left">N</td>
<td align="right">0.27</td>
<td align="left">S</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="hypothesis-testing-via-permutation.html#cb186-1"></a>Shuffle1df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(FloridaLakes<span class="op">$</span>Lake, FloridaLakes<span class="op">$</span>Location, FloridaLakes<span class="op">$</span>AvgMercury, ShuffledLakes<span class="op">$</span>Location)</span>
<span id="cb186-2"><a href="hypothesis-testing-via-permutation.html#cb186-2"></a><span class="kw">names</span>(Shuffle1df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Lake&quot;</span>, <span class="st">&quot;Location&quot;</span>, <span class="st">&quot;AvgMercury&quot;</span>, <span class="st">&quot;Shuffled Location&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="hypothesis-testing-via-permutation.html#cb187-1"></a>LakesPerm &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>Shuffle1df, <span class="kw">aes</span>(<span class="dt">x=</span><span class="st">`</span><span class="dt">Shuffled Location</span><span class="st">`</span>, <span class="dt">y=</span>AvgMercury, <span class="dt">fill=</span><span class="st">`</span><span class="dt">Shuffled Location</span><span class="st">`</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb187-2"><a href="hypothesis-testing-via-permutation.html#cb187-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st">   </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Mercury Levels in Florida Lakes&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb187-3"><a href="hypothesis-testing-via-permutation.html#cb187-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Location&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Mercury Level&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</span>
<span id="cb187-4"><a href="hypothesis-testing-via-permutation.html#cb187-4"></a>LakesPerm</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-164-1.png" width="672" /></p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="hypothesis-testing-via-permutation.html#cb188-1"></a>LakesPermTable &lt;-<span class="st"> </span>Shuffle1df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(<span class="st">`</span><span class="dt">Shuffled Location</span><span class="st">`</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">MeanHg=</span><span class="kw">mean</span>(AvgMercury), <span class="dt">StDevHg=</span><span class="kw">sd</span>(AvgMercury),  <span class="dt">N=</span><span class="kw">n</span>())</span>
<span id="cb188-2"><a href="hypothesis-testing-via-permutation.html#cb188-2"></a><span class="kw">kable</span>(LakesPermTable)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Shuffled Location</th>
<th align="right">MeanHg</th>
<th align="right">StDevHg</th>
<th align="right">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N</td>
<td align="right">0.5642424</td>
<td align="right">0.3259508</td>
<td align="right">33</td>
</tr>
<tr class="even">
<td align="left">S</td>
<td align="right">0.4660000</td>
<td align="right">0.3647551</td>
<td align="right">20</td>
</tr>
</tbody>
</table>
</div>
<div id="r-code-for-permutation-test" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.11</span> R Code for Permutation Test<a href="hypothesis-testing-via-permutation.html#r-code-for-permutation-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll write a <code>for</code> loop to perform 10,000 permutations and record the value of <span class="math inline">\(b_1\)</span> (the difference in sample means) for each simulation.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="hypothesis-testing-via-permutation.html#cb189-1"></a>b1 &lt;-<span class="st"> </span>Lakes_M<span class="op">$</span>coef[<span class="dv">2</span>] <span class="co">## record value of b1 from actual data</span></span>
<span id="cb189-2"><a href="hypothesis-testing-via-permutation.html#cb189-2"></a></span>
<span id="cb189-3"><a href="hypothesis-testing-via-permutation.html#cb189-3"></a><span class="co">## perform simulation</span></span>
<span id="cb189-4"><a href="hypothesis-testing-via-permutation.html#cb189-4"></a>b1Sim &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">10000</span>)          <span class="co">## vector to hold results</span></span>
<span id="cb189-5"><a href="hypothesis-testing-via-permutation.html#cb189-5"></a>ShuffledLakes &lt;-<span class="st"> </span>FloridaLakes    <span class="co">## create copy of dataset</span></span>
<span id="cb189-6"><a href="hypothesis-testing-via-permutation.html#cb189-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>){</span>
<span id="cb189-7"><a href="hypothesis-testing-via-permutation.html#cb189-7"></a>  <span class="co">#randomly shuffle locations</span></span>
<span id="cb189-8"><a href="hypothesis-testing-via-permutation.html#cb189-8"></a>ShuffledLakes<span class="op">$</span>Location &lt;-<span class="st"> </span>ShuffledLakes<span class="op">$</span>Location[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledLakes))] </span>
<span id="cb189-9"><a href="hypothesis-testing-via-permutation.html#cb189-9"></a>ShuffledLakes_M&lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>ShuffledLakes, AvgMercury <span class="op">~</span><span class="st"> </span>Location)   <span class="co">#fit model to shuffled data</span></span>
<span id="cb189-10"><a href="hypothesis-testing-via-permutation.html#cb189-10"></a>b1Sim[i] &lt;-<span class="st"> </span>ShuffledLakes_M<span class="op">$</span>coef[<span class="dv">2</span>]  <span class="co">## record b1 from shuffled model</span></span>
<span id="cb189-11"><a href="hypothesis-testing-via-permutation.html#cb189-11"></a>}</span>
<span id="cb189-12"><a href="hypothesis-testing-via-permutation.html#cb189-12"></a>NSLakes_SimulationResults &lt;-<span class="st"> </span><span class="kw">data.frame</span>(b1Sim)  <span class="co">#save results in dataframe</span></span></code></pre></div>
</div>
<div id="permutation-tests-results" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.12</span> Permutation Tests Results<a href="hypothesis-testing-via-permutation.html#permutation-tests-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="hypothesis-testing-via-permutation.html#cb190-1"></a>NSLakes_SimulationResultsPlot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>NSLakes_SimulationResults, <span class="kw">aes</span>(<span class="dt">x=</span>b1Sim)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb190-2"><a href="hypothesis-testing-via-permutation.html#cb190-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">color=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb190-3"><a href="hypothesis-testing-via-permutation.html#cb190-3"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="kw">c</span>(b1, <span class="dv">-1</span><span class="op">*</span>b1), <span class="dt">color=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb190-4"><a href="hypothesis-testing-via-permutation.html#cb190-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Lakes: Simulated Value of b1&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb190-5"><a href="hypothesis-testing-via-permutation.html#cb190-5"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Distribution of b1 under assumption of no relationship&quot;</span>)</span>
<span id="cb190-6"><a href="hypothesis-testing-via-permutation.html#cb190-6"></a>NSLakes_SimulationResultsPlot</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-167-1.png" width="672" /></p>
<p>It appears unlikely that we would observe a difference in sample mean (<span class="math inline">\(b_1\)</span>) as extreme as 0.27195 ppm by chance, if there is really no relationship between location and mercury level.</p>
</div>
<div id="conclusions" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.13</span> Conclusions<a href="hypothesis-testing-via-permutation.html#conclusions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Number of simulations (out of 10,000) resulting in difference in means more extreme than 0.27195.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="hypothesis-testing-via-permutation.html#cb191-1"></a><span class="kw">sum</span>(<span class="kw">abs</span>(b1Sim) <span class="op">&gt;</span><span class="st"> </span><span class="kw">abs</span>(b1))</span></code></pre></div>
<pre><code>## [1] 39</code></pre>
<p>Proportion of simulations resulting in difference in means more extreme than 0.27195.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="hypothesis-testing-via-permutation.html#cb193-1"></a><span class="kw">mean</span>(<span class="kw">abs</span>(b1Sim) <span class="op">&gt;</span><span class="st"> </span><span class="kw">abs</span>(b1))</span></code></pre></div>
<pre><code>## [1] 0.0039</code></pre>
<p>The probability of observing a difference in means as extreme as 0.27195 by chance, when there is no relationship between location and mercury level is very low.</p>
<p>There is strong evidence of a relationship between location and mercury level. In this case, there is strong evidence that mercury level is higher in Southern Lakes than northern Lakes.</p>
</div>
<div id="hypothesis-testing-terminology" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.14</span> Hypothesis Testing Terminology<a href="hypothesis-testing-via-permutation.html#hypothesis-testing-terminology" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can think of the simulation as a test of the following hypotheses:</p>
<p>Hypothesis 1: Among all Florida lakes, average mercury level is the same for lakes in Northern Florida, as in Southern Florida. (Thus the difference of 0.27 we observed in our data occurred just by chance).</p>
<p>Hypothesis 2: Among all Florida lakes, there is a difference in average mercury level between lakes in Northern Florida and Southern Florida.</p>
<p>The “no difference,” or “chance alone” hypothesis is called the <strong>null hypothesis</strong>. The other hypothesis is called the <strong>alternative hypothesis</strong>.</p>
<p>We used <span class="math inline">\(b_1\)</span> to measure difference in average mercury levels between the locations in our observed data.</p>
<p>We found that the probability of observing a difference in means as extreme as 0.27 when Hypothesis 1 is true is very low (approximately 0.0023)</p>
<ul>
<li>The statistic used to measure the difference or relationship we are interested in is called a <strong>test statistic</strong>.
<ul>
<li>In this case, the test statistic is the difference in sample means (<span class="math inline">\(b_1\)</span>)</li>
</ul></li>
<li>The <strong>p-value</strong> is the probability of observing a test statistic as extreme or more extreme than we did due to chance, when the null hypothesis is true.<br />
- A low p-value provides evidence against the null hypothesis.<br />
- A high p-value means that the data could have plausibly been obtained when the null hypothesis is true, and thus the null hypothesis cannot be ruled out.<br />
- A high p-value does not mean that the null hypothesis is true or probably true. A p-value can only tell us the strength of evidence against the null hypothesis, and should never be interpreted as support for the null hypothesis.</li>
</ul>
</div>
<div id="how-low-should-the-p-value-be" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.15</span> How Low Should the p-value Be<a href="hypothesis-testing-via-permutation.html#how-low-should-the-p-value-be" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="hypothesis-testing-via-permutation.html#cb195-1"></a>knitr<span class="op">::</span><span class="kw">include_graphics</span>(<span class="st">&quot;pvals.png&quot;</span>)</span></code></pre></div>
<p><img src="pvals.png" width="100%" /></p>
</div>
<div id="practical-importance" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.1.16</span> Practical Importance<a href="hypothesis-testing-via-permutation.html#practical-importance" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A low p-value tells us that the difference in average Mercury levels that we saw in our sample is unlikely to have occurred by chance, providing evidence that there is indeed a difference in average Mercury levels between Northern and Southern lakes.</p>
<p>The p-value does not tell us anything about the size of the difference!
If the difference is really small (say 0.001 ppm), perhaps there is no need to worry about it.</p>
<p>It’s possible to get a small p-value even when the true difference is very small (especially when our sample size is large).</p>
<p>In addition to a p-value, we should consider whether a difference is big enough to be meaningful in a practical way, before making any policy decisions.</p>
<p>For now, we can use the difference in sample means of 0.27 ppm as an estimate of the size of the difference. Based on our limited knowledge of mercury levels, this does seem big enough to merit further investigation, and possible action.</p>
</div>
</div>
<div id="test-for-difference-in-standard-deviation" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.2</span> Test for Difference in Standard Deviation<a href="hypothesis-testing-via-permutation.html#test-for-difference-in-standard-deviation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="standard-deviation-northern-and-southern-lakes" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.2.1</span> Standard Deviation Northern and Southern Lakes<a href="hypothesis-testing-via-permutation.html#standard-deviation-northern-and-southern-lakes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Recall that in our sample, the standard deviation was higher for the lakes in Southern Florida than Northern Florida.</p>
<p>Note: for a sample of <span class="math inline">\(n\)</span> observations, <span class="math inline">\(y_1, \ldots, y_n\)</span>, standard deviation is a measure of spread, is calculated using the formula:</p>
<p><span class="math display">\[
SD=\sqrt{\frac{1}{n-1}\sum_{i=1}^n(y_i-\bar{y})^2}
\]</span></p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="hypothesis-testing-via-permutation.html#cb196-1"></a>LakesBP &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>FloridaLakes, <span class="kw">aes</span>(<span class="dt">x=</span>Location, <span class="dt">y=</span>AvgMercury, <span class="dt">fill=</span>Location)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb196-2"><a href="hypothesis-testing-via-permutation.html#cb196-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st">   </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Mercury Levels in Florida Lakes&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb196-3"><a href="hypothesis-testing-via-permutation.html#cb196-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Location&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Mercury Level&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.5</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() </span>
<span id="cb196-4"><a href="hypothesis-testing-via-permutation.html#cb196-4"></a>LakesBP</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="hypothesis-testing-via-permutation.html#cb197-1"></a>LakesTable &lt;-<span class="st"> </span>FloridaLakes <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Location) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">MeanHg=</span><span class="kw">mean</span>(AvgMercury), <span class="dt">StDevHg=</span><span class="kw">sd</span>(AvgMercury),  <span class="dt">N=</span><span class="kw">n</span>())</span>
<span id="cb197-2"><a href="hypothesis-testing-via-permutation.html#cb197-2"></a><span class="kw">kable</span>(LakesTable)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Location</th>
<th align="right">MeanHg</th>
<th align="right">StDevHg</th>
<th align="right">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">N</td>
<td align="right">0.4245455</td>
<td align="right">0.2696652</td>
<td align="right">33</td>
</tr>
<tr class="even">
<td align="left">S</td>
<td align="right">0.6965000</td>
<td align="right">0.3838760</td>
<td align="right">20</td>
</tr>
</tbody>
</table>
<p>Does this provide evidence that there is really more variability in mercury levels for lakes in Southern Florida than in Northern Florida, or could we have just by chance picked lakes with more variability in South Florida?</p>
</div>
<div id="hypotheses" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.2.2</span> Hypotheses<a href="hypothesis-testing-via-permutation.html#hypotheses" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Null Hypothesis:</strong> Standard deviation in mercury levels among all lakes in Northern Florida is the same as the standard deviation in mercury levels among all lakes in Southern Florida.</p>
<p><strong>Alternative Hypothesis:</strong> Standard deviation in mercury levels among all lakes in Northern Florida is different than the standard deviation in mercury levels among all lakes in Southern Florida.</p>
</div>
<div id="permutation-test-steps" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.2.3</span> Permutation Test Steps<a href="hypothesis-testing-via-permutation.html#permutation-test-steps" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Procedure:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Randomly shuffle the locations of the lakes, so that any relationship between location and mercury level is due only to chance.</p></li>
<li><p>Calculate the difference in <strong>standard deviation</strong> in mercury levels (i.e. value of <span class="math inline">\(b_1\)</span>) in “Northern” and “Southern” lakes, using the shuffled data.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, recording the difference in standard deviations each time.</p></li>
<li><p>Analyze the distribution of differences in standard deviation, simulated under the assumption that there is no relationship between location and mercury level. Look whether the actual difference we observed is consistent with the simulation results.</p></li>
</ol>
<p><strong>Question:</strong> Looking back at the 5 simulations performed in the previous section, does it seem plausible that we could have observed a difference in standard deviations as extreme as <span class="math inline">\(0.3839-0.2697 = 0.1142\)</span> by chance?</p>
</div>
<div id="r-code-for-permutation-test-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.2.4</span> R Code for Permutation Test<a href="hypothesis-testing-via-permutation.html#r-code-for-permutation-test-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="hypothesis-testing-via-permutation.html#cb198-1"></a>SDTab &lt;-<span class="st"> </span>FloridaLakes <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Location) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">SD=</span><span class="kw">sd</span>(AvgMercury))</span>
<span id="cb198-2"><a href="hypothesis-testing-via-permutation.html#cb198-2"></a>DiffSD &lt;-<span class="st"> </span>SDTab<span class="op">$</span>SD[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>SDTab<span class="op">$</span>SD[<span class="dv">1</span>] </span>
<span id="cb198-3"><a href="hypothesis-testing-via-permutation.html#cb198-3"></a></span>
<span id="cb198-4"><a href="hypothesis-testing-via-permutation.html#cb198-4"></a><span class="co">## perform simulation</span></span>
<span id="cb198-5"><a href="hypothesis-testing-via-permutation.html#cb198-5"></a>DiffSim &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">10000</span>)          <span class="co">## vector to hold results</span></span>
<span id="cb198-6"><a href="hypothesis-testing-via-permutation.html#cb198-6"></a>ShuffledLakes &lt;-<span class="st"> </span>FloridaLakes    <span class="co">## create copy of dataset</span></span>
<span id="cb198-7"><a href="hypothesis-testing-via-permutation.html#cb198-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>){</span>
<span id="cb198-8"><a href="hypothesis-testing-via-permutation.html#cb198-8"></a>  <span class="co">#randomly shuffle locations</span></span>
<span id="cb198-9"><a href="hypothesis-testing-via-permutation.html#cb198-9"></a>ShuffledLakes<span class="op">$</span>Location &lt;-<span class="st"> </span>ShuffledLakes<span class="op">$</span>Location[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledLakes))] </span>
<span id="cb198-10"><a href="hypothesis-testing-via-permutation.html#cb198-10"></a>SDTabSim &lt;-<span class="st"> </span>ShuffledLakes <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Location) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">SD=</span><span class="kw">sd</span>(AvgMercury))</span>
<span id="cb198-11"><a href="hypothesis-testing-via-permutation.html#cb198-11"></a>DiffSim[i] &lt;-<span class="st"> </span>SDTabSim<span class="op">$</span>SD[<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span>SDTabSim<span class="op">$</span>SD[<span class="dv">1</span>] <span class="co">#record difference in SD for simulated data</span></span>
<span id="cb198-12"><a href="hypothesis-testing-via-permutation.html#cb198-12"></a>}</span>
<span id="cb198-13"><a href="hypothesis-testing-via-permutation.html#cb198-13"></a>NSLakes_SDSimResults &lt;-<span class="st"> </span><span class="kw">data.frame</span>(DiffSim)  <span class="co">#save results in dataframe</span></span></code></pre></div>
</div>
<div id="permutation-tests-results-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.2.5</span> Permutation Tests Results<a href="hypothesis-testing-via-permutation.html#permutation-tests-results-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="hypothesis-testing-via-permutation.html#cb199-1"></a>NSLakes_SDSimResultsPlot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>NSLakes_SDSimResults, <span class="kw">aes</span>(<span class="dt">x=</span>DiffSim)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb199-2"><a href="hypothesis-testing-via-permutation.html#cb199-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">color=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb199-3"><a href="hypothesis-testing-via-permutation.html#cb199-3"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="kw">c</span>(DiffSD, <span class="dv">-1</span><span class="op">*</span>DiffSD), <span class="dt">color=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb199-4"><a href="hypothesis-testing-via-permutation.html#cb199-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Lakes: Difference in SD&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb199-5"><a href="hypothesis-testing-via-permutation.html#cb199-5"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Distribution of Difference in SD under assumption of no relationship&quot;</span>)</span>
<span id="cb199-6"><a href="hypothesis-testing-via-permutation.html#cb199-6"></a>NSLakes_SDSimResultsPlot</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-174-1.png" width="672" /></p>
<p>Number of simulations (out of 10,000) resulting in standard deviations greater the 0.1142.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="hypothesis-testing-via-permutation.html#cb200-1"></a><span class="kw">sum</span>(<span class="kw">abs</span>(DiffSim) <span class="op">&gt;</span><span class="st"> </span><span class="kw">abs</span>(DiffSD))</span></code></pre></div>
<pre><code>## [1] 601</code></pre>
<p>Proportion of simulations (out of 10,000) resulting in standard deviations greater the 0.1142.</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="hypothesis-testing-via-permutation.html#cb202-1"></a><span class="kw">mean</span>(<span class="kw">abs</span>(DiffSim) <span class="op">&gt;</span><span class="st"> </span><span class="kw">abs</span>(DiffSD))</span></code></pre></div>
<pre><code>## [1] 0.0601</code></pre>
<p>This p-value represents the probability of observing a difference in sample standard deviations as extreme as 0.1142 in a samples of size 33 and 20 by chance, if in fact, the standard deviation in mercury concentration levels is the same for lakes in Northern Florida as in Southern Florida.</p>
</div>
<div id="conclusions-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.2.6</span> Conclusions<a href="hypothesis-testing-via-permutation.html#conclusions-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is unlikely that we would observe a difference in standard deviations as extreme as 0.1142 by chance. There is evidence that lakes in Southern Florida exhibit more variability in mercury levels than lakes in Northern Florida (though the evidence is not as strong as it was when we were testing for a difference in means).</p>
<p>Again, a p-value does not tell us whether a difference is practically meaningful. Without knowing a lot about mercury levels, and their impact on the ecosystem, it’s harder to tell wheter an estimated difference in standard deviations of 0.11 ppm is meaningful or not. It would be good to consult a biologist before making any decisions based on these results.</p>
</div>
</div>
<div id="test-for-regression-slope" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.3</span> Test for Regression Slope<a href="hypothesis-testing-via-permutation.html#test-for-regression-slope" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="cars-dataset" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.1</span> 2015 Cars Dataset<a href="hypothesis-testing-via-permutation.html#cars-dataset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We consider data from the Kelly Blue Book, pertaining to new cars, released in 2015. We’ll investigate the relationship between price, length, and time it takes to accelerate from 0 to 60 mph.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="hypothesis-testing-via-permutation.html#cb204-1"></a><span class="kw">data</span>(Cars2015)</span>
<span id="cb204-2"><a href="hypothesis-testing-via-permutation.html#cb204-2"></a><span class="kw">glimpse</span>(Cars2015)</span></code></pre></div>
<pre><code>## Rows: 110
## Columns: 20
## $ Make      &lt;fct&gt; Chevrolet, Hyundai, Kia, Mitsubishi, Nissan, Dodge, Chevrole…
## $ Model     &lt;fct&gt; Spark, Accent, Rio, Mirage, Versa Note, Dart, Cruze LS, 500L…
## $ Type      &lt;fct&gt; Hatchback, Hatchback, Sedan, Hatchback, Hatchback, Sedan, Se…
## $ LowPrice  &lt;dbl&gt; 12.270, 14.745, 13.990, 12.995, 14.180, 16.495, 16.170, 19.3…
## $ HighPrice &lt;dbl&gt; 25.560, 17.495, 18.290, 15.395, 17.960, 23.795, 25.660, 24.6…
## $ Drive     &lt;fct&gt; FWD, FWD, FWD, FWD, FWD, FWD, FWD, FWD, FWD, FWD, FWD, AWD, …
## $ CityMPG   &lt;int&gt; 30, 28, 28, 37, 31, 23, 24, 24, 28, 30, 27, 27, 25, 27, 30, …
## $ HwyMPG    &lt;int&gt; 39, 37, 36, 44, 40, 35, 36, 33, 38, 35, 33, 36, 36, 37, 39, …
## $ FuelCap   &lt;dbl&gt; 9.0, 11.4, 11.3, 9.2, 10.9, 14.2, 15.6, 13.1, 12.4, 11.1, 11…
## $ Length    &lt;int&gt; 145, 172, 172, 149, 164, 184, 181, 167, 179, 154, 156, 180, …
## $ Width     &lt;int&gt; 63, 67, 68, 66, 67, 72, 71, 70, 72, 67, 68, 69, 70, 68, 69, …
## $ Wheelbase &lt;int&gt; 94, 101, 101, 97, 102, 106, 106, 103, 104, 99, 98, 104, 104,…
## $ Height    &lt;int&gt; 61, 57, 57, 59, 61, 58, 58, 66, 58, 59, 58, 58, 57, 58, 59, …
## $ UTurn     &lt;int&gt; 34, 37, 37, 32, 37, 38, 38, 37, 39, 34, 35, 38, 37, 36, 37, …
## $ Weight    &lt;int&gt; 2345, 2550, 2575, 2085, 2470, 3260, 3140, 3330, 2990, 2385, …
## $ Acc030    &lt;dbl&gt; 4.4, 3.7, 3.5, 4.4, 4.0, 3.4, 3.7, 3.9, 3.4, 3.9, 3.9, 3.7, …
## $ Acc060    &lt;dbl&gt; 12.8, 10.3, 9.5, 12.1, 10.9, 9.3, 9.8, 9.5, 9.2, 10.8, 11.1,…
## $ QtrMile   &lt;dbl&gt; 19.4, 17.8, 17.3, 19.0, 18.2, 17.2, 17.6, 17.4, 17.1, 18.3, …
## $ PageNum   &lt;int&gt; 123, 148, 163, 188, 196, 128, 119, 131, 136, 216, 179, 205, …
## $ Size      &lt;fct&gt; Small, Small, Small, Small, Small, Small, Small, Small, Smal…</code></pre>
</div>
<div id="car-price-and-acceleration-time" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.2</span> Car Price and Acceleration Time<a href="hypothesis-testing-via-permutation.html#car-price-and-acceleration-time" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>LowPrice</code> represents the price of a standard (non-luxury) model of a car. <code>Acc060</code> represents time it takes to accelerate from 0 to 60 mph.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="hypothesis-testing-via-permutation.html#cb206-1"></a><span class="kw">data</span>(Cars2015)</span></code></pre></div>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="hypothesis-testing-via-permutation.html#cb207-1"></a>CarsA060 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>Cars2015, <span class="kw">aes</span>(<span class="dt">x=</span>Acc060, <span class="dt">y=</span>LowPrice)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span><span class="ot">FALSE</span>) </span>
<span id="cb207-2"><a href="hypothesis-testing-via-permutation.html#cb207-2"></a>CarsA060</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-179-1.png" width="672" /></p>
</div>
<div id="modeling-price-using-acc060" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.3</span> Modeling Price using Acc060<a href="hypothesis-testing-via-permutation.html#modeling-price-using-acc060" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(\widehat{Price} = b_0 + b_1\times\text{Acc. Time}\)</span></p>
<ul>
<li>Model assumes expected price is a linear function of acceleration time.</li>
</ul>
<p>Interpretations:</p>
<p><span class="math inline">\(b_0\)</span> represents intercept of regression line, i.e. expected price of a car that can accelerate from 0 to 60 mph in no time. This is not a meaningful interpretation in context.</p>
<p><span class="math inline">\(b_1\)</span> represents slope of regression line, i.e. expected change in price for each additional second it takes to accelerate from 0 to 60 mph.</p>
</div>
<div id="modeling-for-car-price-and-acceleration" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.4</span> Modeling for Car Price and Acceleration<a href="hypothesis-testing-via-permutation.html#modeling-for-car-price-and-acceleration" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="hypothesis-testing-via-permutation.html#cb208-1"></a>Cars_M_A060 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>Cars2015, LowPrice<span class="op">~</span>Acc060)</span>
<span id="cb208-2"><a href="hypothesis-testing-via-permutation.html#cb208-2"></a><span class="kw">summary</span>(Cars_M_A060)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = LowPrice ~ Acc060, data = Cars2015)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -29.512  -6.544  -1.265   4.759  27.195 
## 
## Coefficients:
##             Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)  89.9036     5.0523   17.79 &lt;0.0000000000000002 ***
## Acc060       -7.1933     0.6234  -11.54 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 10.71 on 108 degrees of freedom
## Multiple R-squared:  0.5521, Adjusted R-squared:  0.548 
## F-statistic: 133.1 on 1 and 108 DF,  p-value: &lt; 0.00000000000000022</code></pre>
</div>
<div id="acc060-model-interpretations" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.5</span> Acc060 Model Interpretations<a href="hypothesis-testing-via-permutation.html#acc060-model-interpretations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(\widehat{Price} = b_0 + b_1\times\text{Acc. Time}\)</span></p>
<p><span class="math inline">\(\widehat{Price} = 89.90 - 7.193\times\text{Acc. Time}\)</span></p>
<ul>
<li><p>Intercept <span class="math inline">\(b_0\)</span> might be interpreted as the price of a car that can accelerate from 0 to 60 in no time, but this is not a meaningful interpretation since there are no such cars.</p></li>
<li><p><span class="math inline">\(b_1=-7.1933\)</span> tells us that on average, the price of a car is expected to decrease by 7.19 thousand dollars for each additional second it takes to accelerate from 0 to 60 mph.</p></li>
<li><p><span class="math inline">\(R^2 = 0.5521\)</span> tells us that 55% of the variation in price is explained by the linear model using acceleration time as the explanatory variable.</p></li>
</ul>
</div>
<div id="is-car-price-associated-with-acceleration-time" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.6</span> Is Car Price Associated with Acceleration Time?<a href="hypothesis-testing-via-permutation.html#is-car-price-associated-with-acceleration-time" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Is it possible that there is really no relationship between price and acceleration time, and we just happened to choose a sample that led to a slope of -7.1933, by chance?</p>
<p>Is it possible that among all cars, the picture looks like the one below, and we just happened to draw a sample of 110 cars, showing a downward trend by chance?</p>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-181-1.png" width="672" /></p>
</div>
<div id="acc060-key-question-and-hypotheses" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.7</span> Acc060 Key Question and Hypotheses<a href="hypothesis-testing-via-permutation.html#acc060-key-question-and-hypotheses" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If there is really no relationship between price and acceleration time, then we would expect a slope (i.e value of <span class="math inline">\(b_1\)</span>) equal to 0.</p>
<p><strong>Key Question:</strong></p>
<ul>
<li>How likely is it that we would have observed a slope (i.e. a value of <span class="math inline">\(b_1\)</span>) as extreme as -7.1933 merely by chance, if there is really no relationship between price and acceleration time?</li>
</ul>
<p><strong>Null Hypothesis:</strong> Among all 2015 cars, there is no relationship between price and acceleration time, and the slope we observed occurred merely by chance.</p>
<p><strong>Alternative Hypothesis:</strong> The slope we observed is due to more than chance, and there is a relationship between price and acceleration time among all 2015 cars.</p>
</div>
<div id="permutation-test-for-slope" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.8</span> Permutation Test for Slope<a href="hypothesis-testing-via-permutation.html#permutation-test-for-slope" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Procedure:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Randomly shuffle the acceleration times, so that any relationship between acceleration time and price is due only to chance.</p></li>
<li><p>Fit a regression line to the shuffled data and record the slope of the regression line.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, recording the slope (i.e. value of <span class="math inline">\(b_1\)</span>) each time.<br />
</p></li>
<li><p>Analyze the distribution of slopes, simulated under the assumption that there is no relationship between price and acceleration time. Look whether the actual slope we observed is consistent with the simulation results.</p></li>
</ol>
</div>
<div id="five-permutations" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.9</span> Five Permutations<a href="hypothesis-testing-via-permutation.html#five-permutations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>First Permutation</strong></p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="hypothesis-testing-via-permutation.html#cb210-1"></a>ShuffledCars &lt;-<span class="st"> </span>Cars2015    <span class="co">## create copy of dataset</span></span>
<span id="cb210-2"><a href="hypothesis-testing-via-permutation.html#cb210-2"></a>ShuffledCars<span class="op">$</span>Acc060 &lt;-<span class="st"> </span>ShuffledCars<span class="op">$</span>Acc060[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledCars))] </span></code></pre></div>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="hypothesis-testing-via-permutation.html#cb211-1"></a>Shuffle1df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Cars2015<span class="op">$</span>Make, Cars2015<span class="op">$</span>Model, Cars2015<span class="op">$</span>LowPrice, Cars2015<span class="op">$</span>Acc060, ShuffledCars<span class="op">$</span>Acc060)</span>
<span id="cb211-2"><a href="hypothesis-testing-via-permutation.html#cb211-2"></a><span class="kw">names</span>(Shuffle1df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Make&quot;</span>, <span class="st">&quot;Model&quot;</span>, <span class="st">&quot;LowPrice&quot;</span>, <span class="st">&quot;Acc060&quot;</span>, <span class="st">&quot;ShuffledAcc060&quot;</span>)</span>
<span id="cb211-3"><a href="hypothesis-testing-via-permutation.html#cb211-3"></a><span class="kw">kable</span>(<span class="kw">head</span>(Shuffle1df))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Make</th>
<th align="left">Model</th>
<th align="right">LowPrice</th>
<th align="right">Acc060</th>
<th align="right">ShuffledAcc060</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Chevrolet</td>
<td align="left">Spark</td>
<td align="right">12.270</td>
<td align="right">12.8</td>
<td align="right">6.8</td>
</tr>
<tr class="even">
<td align="left">Hyundai</td>
<td align="left">Accent</td>
<td align="right">14.745</td>
<td align="right">10.3</td>
<td align="right">10.1</td>
</tr>
<tr class="odd">
<td align="left">Kia</td>
<td align="left">Rio</td>
<td align="right">13.990</td>
<td align="right">9.5</td>
<td align="right">9.4</td>
</tr>
<tr class="even">
<td align="left">Mitsubishi</td>
<td align="left">Mirage</td>
<td align="right">12.995</td>
<td align="right">12.1</td>
<td align="right">9.7</td>
</tr>
<tr class="odd">
<td align="left">Nissan</td>
<td align="left">Versa Note</td>
<td align="right">14.180</td>
<td align="right">10.9</td>
<td align="right">8.1</td>
</tr>
<tr class="even">
<td align="left">Dodge</td>
<td align="left">Dart</td>
<td align="right">16.495</td>
<td align="right">9.3</td>
<td align="right">7.2</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="hypothesis-testing-via-permutation.html#cb212-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>Shuffle1df, <span class="kw">aes</span>(<span class="dt">x=</span>ShuffledAcc060, <span class="dt">y=</span>LowPrice)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-184-1.png" width="672" />
Slope of regression line from permuted data:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="hypothesis-testing-via-permutation.html#cb213-1"></a>M_Cars_Shuffle &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>ShuffledCars, LowPrice<span class="op">~</span>Acc060)</span>
<span id="cb213-2"><a href="hypothesis-testing-via-permutation.html#cb213-2"></a><span class="kw">summary</span>(M_Cars_Shuffle)<span class="op">$</span>coef[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] 0.5801725</code></pre>
<p><strong>Second Permutation</strong></p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="hypothesis-testing-via-permutation.html#cb215-1"></a>ShuffledCars &lt;-<span class="st"> </span>Cars2015    <span class="co">## create copy of dataset</span></span>
<span id="cb215-2"><a href="hypothesis-testing-via-permutation.html#cb215-2"></a>ShuffledCars<span class="op">$</span>Acc060 &lt;-<span class="st"> </span>ShuffledCars<span class="op">$</span>Acc060[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledCars))] </span></code></pre></div>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="hypothesis-testing-via-permutation.html#cb216-1"></a>Shuffle1df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Cars2015<span class="op">$</span>Make, Cars2015<span class="op">$</span>Model, Cars2015<span class="op">$</span>LowPrice, Cars2015<span class="op">$</span>Acc060, ShuffledCars<span class="op">$</span>Acc060)</span>
<span id="cb216-2"><a href="hypothesis-testing-via-permutation.html#cb216-2"></a><span class="kw">names</span>(Shuffle1df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Make&quot;</span>, <span class="st">&quot;Model&quot;</span>, <span class="st">&quot;LowPrice&quot;</span>, <span class="st">&quot;Acc060&quot;</span>, <span class="st">&quot;ShuffledAcc060&quot;</span>)</span>
<span id="cb216-3"><a href="hypothesis-testing-via-permutation.html#cb216-3"></a><span class="kw">kable</span>(<span class="kw">head</span>(Shuffle1df))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Make</th>
<th align="left">Model</th>
<th align="right">LowPrice</th>
<th align="right">Acc060</th>
<th align="right">ShuffledAcc060</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Chevrolet</td>
<td align="left">Spark</td>
<td align="right">12.270</td>
<td align="right">12.8</td>
<td align="right">6.9</td>
</tr>
<tr class="even">
<td align="left">Hyundai</td>
<td align="left">Accent</td>
<td align="right">14.745</td>
<td align="right">10.3</td>
<td align="right">8.0</td>
</tr>
<tr class="odd">
<td align="left">Kia</td>
<td align="left">Rio</td>
<td align="right">13.990</td>
<td align="right">9.5</td>
<td align="right">10.5</td>
</tr>
<tr class="even">
<td align="left">Mitsubishi</td>
<td align="left">Mirage</td>
<td align="right">12.995</td>
<td align="right">12.1</td>
<td align="right">7.2</td>
</tr>
<tr class="odd">
<td align="left">Nissan</td>
<td align="left">Versa Note</td>
<td align="right">14.180</td>
<td align="right">10.9</td>
<td align="right">8.4</td>
</tr>
<tr class="even">
<td align="left">Dodge</td>
<td align="left">Dart</td>
<td align="right">16.495</td>
<td align="right">9.3</td>
<td align="right">11.0</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="hypothesis-testing-via-permutation.html#cb217-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>Shuffle1df, <span class="kw">aes</span>(<span class="dt">x=</span>ShuffledAcc060, <span class="dt">y=</span>LowPrice)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-188-1.png" width="672" />
Slope of regression line from permuted data:</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="hypothesis-testing-via-permutation.html#cb218-1"></a>M_Cars_Shuffle &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>ShuffledCars, LowPrice<span class="op">~</span>Acc060)</span>
<span id="cb218-2"><a href="hypothesis-testing-via-permutation.html#cb218-2"></a><span class="kw">summary</span>(M_Cars_Shuffle)<span class="op">$</span>coef[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] -0.9289392</code></pre>
<p><strong>Third Permutation</strong></p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="hypothesis-testing-via-permutation.html#cb220-1"></a>ShuffledCars &lt;-<span class="st"> </span>Cars2015    <span class="co">## create copy of dataset</span></span>
<span id="cb220-2"><a href="hypothesis-testing-via-permutation.html#cb220-2"></a>ShuffledCars<span class="op">$</span>Acc060 &lt;-<span class="st"> </span>ShuffledCars<span class="op">$</span>Acc060[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledCars))] </span></code></pre></div>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="hypothesis-testing-via-permutation.html#cb221-1"></a>Shuffle1df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Cars2015<span class="op">$</span>Make, Cars2015<span class="op">$</span>Model, Cars2015<span class="op">$</span>LowPrice, Cars2015<span class="op">$</span>Acc060, ShuffledCars<span class="op">$</span>Acc060)</span>
<span id="cb221-2"><a href="hypothesis-testing-via-permutation.html#cb221-2"></a><span class="kw">names</span>(Shuffle1df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Make&quot;</span>, <span class="st">&quot;Model&quot;</span>, <span class="st">&quot;LowPrice&quot;</span>, <span class="st">&quot;Acc060&quot;</span>, <span class="st">&quot;ShuffledAcc060&quot;</span>)</span>
<span id="cb221-3"><a href="hypothesis-testing-via-permutation.html#cb221-3"></a><span class="kw">kable</span>(<span class="kw">head</span>(Shuffle1df))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Make</th>
<th align="left">Model</th>
<th align="right">LowPrice</th>
<th align="right">Acc060</th>
<th align="right">ShuffledAcc060</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Chevrolet</td>
<td align="left">Spark</td>
<td align="right">12.270</td>
<td align="right">12.8</td>
<td align="right">6.8</td>
</tr>
<tr class="even">
<td align="left">Hyundai</td>
<td align="left">Accent</td>
<td align="right">14.745</td>
<td align="right">10.3</td>
<td align="right">8.7</td>
</tr>
<tr class="odd">
<td align="left">Kia</td>
<td align="left">Rio</td>
<td align="right">13.990</td>
<td align="right">9.5</td>
<td align="right">6.7</td>
</tr>
<tr class="even">
<td align="left">Mitsubishi</td>
<td align="left">Mirage</td>
<td align="right">12.995</td>
<td align="right">12.1</td>
<td align="right">8.8</td>
</tr>
<tr class="odd">
<td align="left">Nissan</td>
<td align="left">Versa Note</td>
<td align="right">14.180</td>
<td align="right">10.9</td>
<td align="right">7.2</td>
</tr>
<tr class="even">
<td align="left">Dodge</td>
<td align="left">Dart</td>
<td align="right">16.495</td>
<td align="right">9.3</td>
<td align="right">5.5</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="hypothesis-testing-via-permutation.html#cb222-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>Shuffle1df, <span class="kw">aes</span>(<span class="dt">x=</span>ShuffledAcc060, <span class="dt">y=</span>LowPrice)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-192-1.png" width="672" /></p>
<p>Slope of regression line from permuted data:</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="hypothesis-testing-via-permutation.html#cb223-1"></a>M_Cars_Shuffle &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>ShuffledCars, LowPrice<span class="op">~</span>Acc060)</span>
<span id="cb223-2"><a href="hypothesis-testing-via-permutation.html#cb223-2"></a><span class="kw">summary</span>(M_Cars_Shuffle)<span class="op">$</span>coef[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] -1.428531</code></pre>
</div>
<div id="fourth-permutation" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.10</span> Fourth Permutation<a href="hypothesis-testing-via-permutation.html#fourth-permutation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="hypothesis-testing-via-permutation.html#cb225-1"></a>ShuffledCars &lt;-<span class="st"> </span>Cars2015    <span class="co">## create copy of dataset</span></span>
<span id="cb225-2"><a href="hypothesis-testing-via-permutation.html#cb225-2"></a>ShuffledCars<span class="op">$</span>Acc060 &lt;-<span class="st"> </span>ShuffledCars<span class="op">$</span>Acc060[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledCars))] </span></code></pre></div>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="hypothesis-testing-via-permutation.html#cb226-1"></a>Shuffle1df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Cars2015<span class="op">$</span>Make, Cars2015<span class="op">$</span>Model, Cars2015<span class="op">$</span>LowPrice, Cars2015<span class="op">$</span>Acc060, ShuffledCars<span class="op">$</span>Acc060)</span>
<span id="cb226-2"><a href="hypothesis-testing-via-permutation.html#cb226-2"></a><span class="kw">names</span>(Shuffle1df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Make&quot;</span>, <span class="st">&quot;Model&quot;</span>, <span class="st">&quot;LowPrice&quot;</span>, <span class="st">&quot;Acc060&quot;</span>, <span class="st">&quot;ShuffledAcc060&quot;</span>)</span>
<span id="cb226-3"><a href="hypothesis-testing-via-permutation.html#cb226-3"></a><span class="kw">kable</span>(<span class="kw">head</span>(Shuffle1df))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Make</th>
<th align="left">Model</th>
<th align="right">LowPrice</th>
<th align="right">Acc060</th>
<th align="right">ShuffledAcc060</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Chevrolet</td>
<td align="left">Spark</td>
<td align="right">12.270</td>
<td align="right">12.8</td>
<td align="right">7.4</td>
</tr>
<tr class="even">
<td align="left">Hyundai</td>
<td align="left">Accent</td>
<td align="right">14.745</td>
<td align="right">10.3</td>
<td align="right">7.0</td>
</tr>
<tr class="odd">
<td align="left">Kia</td>
<td align="left">Rio</td>
<td align="right">13.990</td>
<td align="right">9.5</td>
<td align="right">7.7</td>
</tr>
<tr class="even">
<td align="left">Mitsubishi</td>
<td align="left">Mirage</td>
<td align="right">12.995</td>
<td align="right">12.1</td>
<td align="right">7.6</td>
</tr>
<tr class="odd">
<td align="left">Nissan</td>
<td align="left">Versa Note</td>
<td align="right">14.180</td>
<td align="right">10.9</td>
<td align="right">6.2</td>
</tr>
<tr class="even">
<td align="left">Dodge</td>
<td align="left">Dart</td>
<td align="right">16.495</td>
<td align="right">9.3</td>
<td align="right">8.7</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="hypothesis-testing-via-permutation.html#cb227-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>Shuffle1df, <span class="kw">aes</span>(<span class="dt">x=</span>ShuffledAcc060, <span class="dt">y=</span>LowPrice)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-196-1.png" width="672" />
Slope of regression line from permuted data:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="hypothesis-testing-via-permutation.html#cb228-1"></a>M_Cars_Shuffle &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>ShuffledCars, LowPrice<span class="op">~</span>Acc060)</span>
<span id="cb228-2"><a href="hypothesis-testing-via-permutation.html#cb228-2"></a><span class="kw">summary</span>(M_Cars_Shuffle)<span class="op">$</span>coef[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] 0.01197376</code></pre>
<p><strong>Fifth Permutation</strong></p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="hypothesis-testing-via-permutation.html#cb230-1"></a>ShuffledCars &lt;-<span class="st"> </span>Cars2015    <span class="co">## create copy of dataset</span></span>
<span id="cb230-2"><a href="hypothesis-testing-via-permutation.html#cb230-2"></a>ShuffledCars<span class="op">$</span>Acc060 &lt;-<span class="st"> </span>ShuffledCars<span class="op">$</span>Acc060[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledCars))] </span></code></pre></div>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="hypothesis-testing-via-permutation.html#cb231-1"></a>Shuffle1df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Cars2015<span class="op">$</span>Make, Cars2015<span class="op">$</span>Model, Cars2015<span class="op">$</span>LowPrice, Cars2015<span class="op">$</span>Acc060, ShuffledCars<span class="op">$</span>Acc060)</span>
<span id="cb231-2"><a href="hypothesis-testing-via-permutation.html#cb231-2"></a><span class="kw">names</span>(Shuffle1df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Make&quot;</span>, <span class="st">&quot;Model&quot;</span>, <span class="st">&quot;LowPrice&quot;</span>, <span class="st">&quot;Acc060&quot;</span>, <span class="st">&quot;ShuffledAcc060&quot;</span>)</span>
<span id="cb231-3"><a href="hypothesis-testing-via-permutation.html#cb231-3"></a><span class="kw">kable</span>(<span class="kw">head</span>(Shuffle1df))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Make</th>
<th align="left">Model</th>
<th align="right">LowPrice</th>
<th align="right">Acc060</th>
<th align="right">ShuffledAcc060</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Chevrolet</td>
<td align="left">Spark</td>
<td align="right">12.270</td>
<td align="right">12.8</td>
<td align="right">8.8</td>
</tr>
<tr class="even">
<td align="left">Hyundai</td>
<td align="left">Accent</td>
<td align="right">14.745</td>
<td align="right">10.3</td>
<td align="right">7.0</td>
</tr>
<tr class="odd">
<td align="left">Kia</td>
<td align="left">Rio</td>
<td align="right">13.990</td>
<td align="right">9.5</td>
<td align="right">7.5</td>
</tr>
<tr class="even">
<td align="left">Mitsubishi</td>
<td align="left">Mirage</td>
<td align="right">12.995</td>
<td align="right">12.1</td>
<td align="right">7.8</td>
</tr>
<tr class="odd">
<td align="left">Nissan</td>
<td align="left">Versa Note</td>
<td align="right">14.180</td>
<td align="right">10.9</td>
<td align="right">8.1</td>
</tr>
<tr class="even">
<td align="left">Dodge</td>
<td align="left">Dart</td>
<td align="right">16.495</td>
<td align="right">9.3</td>
<td align="right">7.9</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="hypothesis-testing-via-permutation.html#cb232-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>Shuffle1df, <span class="kw">aes</span>(<span class="dt">x=</span>ShuffledAcc060, <span class="dt">y=</span>LowPrice)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-200-1.png" width="672" />
Slope of regression line from permuted data:</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="hypothesis-testing-via-permutation.html#cb233-1"></a>M_Cars_Shuffle &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>ShuffledCars, LowPrice<span class="op">~</span>Acc060)</span>
<span id="cb233-2"><a href="hypothesis-testing-via-permutation.html#cb233-2"></a><span class="kw">summary</span>(M_Cars_Shuffle)<span class="op">$</span>coef[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] -0.4476822</code></pre>
</div>
<div id="r-code-for-permutation-test-2" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.11</span> R Code for Permutation Test<a href="hypothesis-testing-via-permutation.html#r-code-for-permutation-test-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="hypothesis-testing-via-permutation.html#cb235-1"></a>b1 &lt;-<span class="st"> </span>Cars_M_A060<span class="op">$</span>coef[<span class="dv">2</span>] <span class="co">## record value of b1 from actual data</span></span>
<span id="cb235-2"><a href="hypothesis-testing-via-permutation.html#cb235-2"></a></span>
<span id="cb235-3"><a href="hypothesis-testing-via-permutation.html#cb235-3"></a><span class="co">## perform simulation</span></span>
<span id="cb235-4"><a href="hypothesis-testing-via-permutation.html#cb235-4"></a>b1Sim &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">10000</span>)          <span class="co">## vector to hold results</span></span>
<span id="cb235-5"><a href="hypothesis-testing-via-permutation.html#cb235-5"></a>ShuffledCars &lt;-<span class="st"> </span>Cars2015    <span class="co">## create copy of dataset</span></span>
<span id="cb235-6"><a href="hypothesis-testing-via-permutation.html#cb235-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>){</span>
<span id="cb235-7"><a href="hypothesis-testing-via-permutation.html#cb235-7"></a>  <span class="co">#randomly shuffle acceleration times</span></span>
<span id="cb235-8"><a href="hypothesis-testing-via-permutation.html#cb235-8"></a>ShuffledCars<span class="op">$</span>Acc060 &lt;-<span class="st"> </span>ShuffledCars<span class="op">$</span>Acc060[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledCars))] </span>
<span id="cb235-9"><a href="hypothesis-testing-via-permutation.html#cb235-9"></a>ShuffledCars_M&lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>ShuffledCars, LowPrice <span class="op">~</span><span class="st"> </span>Acc060)   <span class="co">#fit model to shuffled data</span></span>
<span id="cb235-10"><a href="hypothesis-testing-via-permutation.html#cb235-10"></a>b1Sim[i] &lt;-<span class="st"> </span>ShuffledCars_M<span class="op">$</span>coef[<span class="dv">2</span>]  <span class="co">## record b1 from shuffled model</span></span>
<span id="cb235-11"><a href="hypothesis-testing-via-permutation.html#cb235-11"></a>}</span>
<span id="cb235-12"><a href="hypothesis-testing-via-permutation.html#cb235-12"></a>Cars_A060SimulationResults &lt;-<span class="st"> </span><span class="kw">data.frame</span>(b1Sim)  <span class="co">#save results in dataframe</span></span></code></pre></div>
</div>
<div id="permutation-test-results" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.12</span> Permutation Test Results<a href="hypothesis-testing-via-permutation.html#permutation-test-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="hypothesis-testing-via-permutation.html#cb236-1"></a>b1 &lt;-<span class="st"> </span>Cars_M_A060<span class="op">$</span>coef[<span class="dv">2</span>] <span class="co">## record value of b1 from actual data</span></span>
<span id="cb236-2"><a href="hypothesis-testing-via-permutation.html#cb236-2"></a>Cars_A060SimulationResultsPlot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>Cars_A060SimulationResults, <span class="kw">aes</span>(<span class="dt">x=</span>b1Sim)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb236-3"><a href="hypothesis-testing-via-permutation.html#cb236-3"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">color=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb236-4"><a href="hypothesis-testing-via-permutation.html#cb236-4"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="kw">c</span>(b1, <span class="dv">-1</span><span class="op">*</span>b1), <span class="dt">color=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb236-5"><a href="hypothesis-testing-via-permutation.html#cb236-5"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Simulated Value of b1&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb236-6"><a href="hypothesis-testing-via-permutation.html#cb236-6"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Distribution of b1 under assumption of no relationship&quot;</span>)</span>
<span id="cb236-7"><a href="hypothesis-testing-via-permutation.html#cb236-7"></a>Cars_A060SimulationResultsPlot</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-203-1.png" width="672" /></p>
<p>It is extremely unlikely that we would observe a value of <span class="math inline">\(b_1\)</span> as extreme as -7.1933 by chance, if there is really no relationship between price and acceleration time.</p>
</div>
<div id="p-value-and-conclusion" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.3.13</span> P-value and Conclusion<a href="hypothesis-testing-via-permutation.html#p-value-and-conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Proportion of simulations resulting in simulation value of <span class="math inline">\(b_2\)</span> more extreme than -7.1933.</p>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="hypothesis-testing-via-permutation.html#cb237-1"></a><span class="kw">mean</span>(<span class="kw">abs</span>(b1Sim) <span class="op">&gt;</span><span class="st"> </span><span class="kw">abs</span>(b1))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>The p-value represents the probability of observing a slope as extreme or more extreme than -7.1933 by chance when there is actually no relationship between price and acceleration time.</p>
<p>The probability of observing a slope as extreme as -7.1933 by chance, when there is no relationship between location and mercury level practically zero.</p>
<p>There is very strong evidence of a relationship between price and acceleration time.</p>
<p>A low p-value tells us only that there is evidence of a relationship, not that it is practically meaningful. But an estimated difference of more than $7 thousand for each additional second seems pretty important and would likely influence a buyer’s decision.</p>
</div>
</div>
<div id="test-for-comparing-multiple-groups" class="section level2 hasAnchor">
<h2><span class="header-section-number">3.4</span> Test for Comparing Multiple Groups<a href="hypothesis-testing-via-permutation.html#test-for-comparing-multiple-groups" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="relationship-price-and-car-size" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.1</span> Relationship Price and Car Size<a href="hypothesis-testing-via-permutation.html#relationship-price-and-car-size" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Continuing with the sample of 110 cars, seen in the previous section, let’s compare prices of small, midsized, and large cars.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="hypothesis-testing-via-permutation.html#cb239-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>Cars2015, <span class="kw">aes</span>(<span class="dt">x=</span>Size, <span class="dt">y=</span>LowPrice, <span class="dt">fill=</span>Size)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb239-2"><a href="hypothesis-testing-via-permutation.html#cb239-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-205-1.png" width="672" /></p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="hypothesis-testing-via-permutation.html#cb240-1"></a>Cars2015 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Size) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">MeanPrice =</span> <span class="kw">mean</span>(LowPrice), </span>
<span id="cb240-2"><a href="hypothesis-testing-via-permutation.html#cb240-2"></a>                                          <span class="dt">StDevPrice=</span><span class="kw">sd</span>(LowPrice), </span>
<span id="cb240-3"><a href="hypothesis-testing-via-permutation.html#cb240-3"></a>                                          <span class="dt">N=</span><span class="kw">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 3 × 4
##   Size     MeanPrice StDevPrice     N
##   &lt;fct&gt;        &lt;dbl&gt;      &lt;dbl&gt; &lt;int&gt;
## 1 Large         42.3       17.9    29
## 2 Midsized      33.2       12.0    34
## 3 Small         26.7       14.4    47</code></pre>
</div>
<div id="cars-questions-of-interest" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.2</span> Cars Questions of Interest<a href="hypothesis-testing-via-permutation.html#cars-questions-of-interest" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li><p>Do the data provide evidence of a relationship between price and size of vehicle?</p></li>
<li><p>Is there evidence of a difference in average price between…</p>
<ol style="list-style-type: lower-alpha">
<li>large and midsized cars?<br />
</li>
<li>large and small cars?<br />
</li>
<li>small and midsized cars?</li>
</ol></li>
</ol>
</div>
<div id="cars-price-and-size-model" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.3</span> Cars Price and Size Model<a href="hypothesis-testing-via-permutation.html#cars-price-and-size-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="hypothesis-testing-via-permutation.html#cb242-1"></a>Cars_M_Size =<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>Cars2015, LowPrice<span class="op">~</span>Size)</span>
<span id="cb242-2"><a href="hypothesis-testing-via-permutation.html#cb242-2"></a><span class="kw">summary</span>(Cars_M_Size)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = LowPrice ~ Size, data = Cars2015)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -20.516 -11.190  -4.005   9.064  57.648 
## 
## Coefficients:
##              Estimate Std. Error t value             Pr(&gt;|t|)    
## (Intercept)    42.311      2.737  15.460 &lt; 0.0000000000000002 ***
## SizeMidsized   -9.098      3.725  -2.442               0.0162 *  
## SizeSmall     -15.659      3.480  -4.499            0.0000174 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 14.74 on 107 degrees of freedom
## Multiple R-squared:  0.1593, Adjusted R-squared:  0.1436 
## F-statistic: 10.14 on 2 and 107 DF,  p-value: 0.00009271</code></pre>
</div>
<div id="relationship-between-size-and-price" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.4</span> Relationship between Size and Price<a href="hypothesis-testing-via-permutation.html#relationship-between-size-and-price" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Do the data provide evidence of a relationship between price and size of vehicle?</li>
</ol>
<p><span class="math inline">\(\widehat{\text{Price}} = b_0 +b_1\times\text{I}_{\text{Midsized}}+ b_2\times\text{I}_{\text{Large}}\)</span></p>
<ul>
<li><span class="math inline">\(b_0\)</span> represents expected price of large cars.<br />
</li>
<li><span class="math inline">\(b_1\)</span> represents expected difference in price between large and midsized cars.<br />
</li>
<li><span class="math inline">\(b_2\)</span> represents expected difference in price between large and small cars.</li>
</ul>
<p>Unfortunately, none of these measure whether there is an overall relationship between price and size.</p>
<p><strong>Question:</strong>What statistic can we use to assess the size of differences between more than two groups?</p>
</div>
<div id="test-statistic-for-car-size-and-price" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.5</span> Test Statistic for Car Size and Price<a href="hypothesis-testing-via-permutation.html#test-statistic-for-car-size-and-price" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="hypothesis-testing-via-permutation.html#cb244-1"></a>Cars_A_Size &lt;-<span class="st"> </span><span class="kw">aov</span>(<span class="dt">data=</span>Cars2015, LowPrice<span class="op">~</span>Size)</span>
<span id="cb244-2"><a href="hypothesis-testing-via-permutation.html#cb244-2"></a><span class="kw">summary</span>(Cars_A_Size)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Size          2   4405  2202.7   10.14 0.0000927 ***
## Residuals   107  23242   217.2                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<div id="key-question-in-car-size-investigation" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.6</span> Key Question in Car Size Investigation<a href="hypothesis-testing-via-permutation.html#key-question-in-car-size-investigation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Null Hypothesis: Average price, among all 2015 cars, is the same between small, midsized, and large cars.</p>
<p>Alternative Hypothesis: Average price among all 2015 cars differs between at least two of these sizes.</p>
<p><strong>Key Question:</strong> How likely is it that we would have obtained an F-statistic as extreme as 10.14 by chance, if there is really no difference in price between small, medium, and large sized cars, among all 2015 cars?</p>
</div>
<div id="simulation-based-test-for-f-statistic" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.7</span> Simulation-Based Test for F-Statistic<a href="hypothesis-testing-via-permutation.html#simulation-based-test-for-f-statistic" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll simulate situations where there is no relationship between size and price, and see how often we observe an F-statistic as extreme as 10.14.</p>
<p><strong>Procedure:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Randomly shuffle the sizes of the vehicles, so that any relationship between size and price is due only to chance.</p></li>
<li><p>Fit a model, using the shuffled data, with price as the response variable, and size as the explanatory variable. Record the F-statistic.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, recording the F-statistic each time.</p></li>
<li><p>Analyze the distribution of F-statistics, simulated under the assumption that there is no relationship between size and price. Look whether the actual F-statistic we observed is consistent with the simulation results.</p></li>
</ol>
</div>
<div id="five-permutations-1" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.8</span> Five Permutations<a href="hypothesis-testing-via-permutation.html#five-permutations-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>First Permutation</strong></p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="hypothesis-testing-via-permutation.html#cb246-1"></a>ShuffledCars &lt;-<span class="st"> </span>Cars2015    <span class="co">## create copy of dataset</span></span>
<span id="cb246-2"><a href="hypothesis-testing-via-permutation.html#cb246-2"></a>ShuffledCars<span class="op">$</span>Size &lt;-<span class="st"> </span>ShuffledCars<span class="op">$</span>Size[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledCars))] </span></code></pre></div>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="hypothesis-testing-via-permutation.html#cb247-1"></a>Shuffle1df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Cars2015<span class="op">$</span>Make, Cars2015<span class="op">$</span>Model, Cars2015<span class="op">$</span>LowPrice, Cars2015<span class="op">$</span>Size, ShuffledCars<span class="op">$</span>Size)</span>
<span id="cb247-2"><a href="hypothesis-testing-via-permutation.html#cb247-2"></a><span class="kw">names</span>(Shuffle1df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Make&quot;</span>, <span class="st">&quot;Model&quot;</span>, <span class="st">&quot;LowPrice&quot;</span>, <span class="st">&quot;Size&quot;</span>, <span class="st">&quot;ShuffledSize&quot;</span>)</span>
<span id="cb247-3"><a href="hypothesis-testing-via-permutation.html#cb247-3"></a><span class="kw">kable</span>(<span class="kw">head</span>(Shuffle1df))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Make</th>
<th align="left">Model</th>
<th align="right">LowPrice</th>
<th align="left">Size</th>
<th align="left">ShuffledSize</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Chevrolet</td>
<td align="left">Spark</td>
<td align="right">12.270</td>
<td align="left">Small</td>
<td align="left">Small</td>
</tr>
<tr class="even">
<td align="left">Hyundai</td>
<td align="left">Accent</td>
<td align="right">14.745</td>
<td align="left">Small</td>
<td align="left">Large</td>
</tr>
<tr class="odd">
<td align="left">Kia</td>
<td align="left">Rio</td>
<td align="right">13.990</td>
<td align="left">Small</td>
<td align="left">Large</td>
</tr>
<tr class="even">
<td align="left">Mitsubishi</td>
<td align="left">Mirage</td>
<td align="right">12.995</td>
<td align="left">Small</td>
<td align="left">Midsized</td>
</tr>
<tr class="odd">
<td align="left">Nissan</td>
<td align="left">Versa Note</td>
<td align="right">14.180</td>
<td align="left">Small</td>
<td align="left">Midsized</td>
</tr>
<tr class="even">
<td align="left">Dodge</td>
<td align="left">Dart</td>
<td align="right">16.495</td>
<td align="left">Small</td>
<td align="left">Small</td>
</tr>
</tbody>
</table>
<p>Recall this model was fit under an assumption of no relationship between price and size.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="hypothesis-testing-via-permutation.html#cb248-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>ShuffledCars, <span class="kw">aes</span>(<span class="dt">x=</span>Size, <span class="dt">y=</span>LowPrice, <span class="dt">fill=</span>Size)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb248-2"><a href="hypothesis-testing-via-permutation.html#cb248-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Shuffled Cars&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-211-1.png" width="672" /></p>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="hypothesis-testing-via-permutation.html#cb249-1"></a>Cars_A_Size_Shuffle &lt;-<span class="st"> </span><span class="kw">aov</span>(<span class="dt">data=</span>ShuffledCars, LowPrice<span class="op">~</span>Size)</span>
<span id="cb249-2"><a href="hypothesis-testing-via-permutation.html#cb249-2"></a><span class="kw">summary</span>(Cars_A_Size_Shuffle)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)
## Size          2    746   372.9   1.483  0.232
## Residuals   107  26902   251.4</code></pre>
<p><strong>Second Permutation</strong></p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="hypothesis-testing-via-permutation.html#cb251-1"></a>ShuffledCars &lt;-<span class="st"> </span>Cars2015    <span class="co">## create copy of dataset</span></span>
<span id="cb251-2"><a href="hypothesis-testing-via-permutation.html#cb251-2"></a>ShuffledCars<span class="op">$</span>Size &lt;-<span class="st"> </span>ShuffledCars<span class="op">$</span>Size[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledCars))] </span></code></pre></div>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="hypothesis-testing-via-permutation.html#cb252-1"></a>Shuffle1df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Cars2015<span class="op">$</span>Make, Cars2015<span class="op">$</span>Model, Cars2015<span class="op">$</span>LowPrice, Cars2015<span class="op">$</span>Size, ShuffledCars<span class="op">$</span>Size)</span>
<span id="cb252-2"><a href="hypothesis-testing-via-permutation.html#cb252-2"></a><span class="kw">names</span>(Shuffle1df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Make&quot;</span>, <span class="st">&quot;Model&quot;</span>, <span class="st">&quot;LowPrice&quot;</span>, <span class="st">&quot;Size&quot;</span>, <span class="st">&quot;ShuffledSize&quot;</span>)</span>
<span id="cb252-3"><a href="hypothesis-testing-via-permutation.html#cb252-3"></a><span class="kw">kable</span>(<span class="kw">head</span>(Shuffle1df))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Make</th>
<th align="left">Model</th>
<th align="right">LowPrice</th>
<th align="left">Size</th>
<th align="left">ShuffledSize</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Chevrolet</td>
<td align="left">Spark</td>
<td align="right">12.270</td>
<td align="left">Small</td>
<td align="left">Large</td>
</tr>
<tr class="even">
<td align="left">Hyundai</td>
<td align="left">Accent</td>
<td align="right">14.745</td>
<td align="left">Small</td>
<td align="left">Small</td>
</tr>
<tr class="odd">
<td align="left">Kia</td>
<td align="left">Rio</td>
<td align="right">13.990</td>
<td align="left">Small</td>
<td align="left">Large</td>
</tr>
<tr class="even">
<td align="left">Mitsubishi</td>
<td align="left">Mirage</td>
<td align="right">12.995</td>
<td align="left">Small</td>
<td align="left">Large</td>
</tr>
<tr class="odd">
<td align="left">Nissan</td>
<td align="left">Versa Note</td>
<td align="right">14.180</td>
<td align="left">Small</td>
<td align="left">Midsized</td>
</tr>
<tr class="even">
<td align="left">Dodge</td>
<td align="left">Dart</td>
<td align="right">16.495</td>
<td align="left">Small</td>
<td align="left">Large</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="hypothesis-testing-via-permutation.html#cb253-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>ShuffledCars, <span class="kw">aes</span>(<span class="dt">x=</span>Size, <span class="dt">y=</span>LowPrice, <span class="dt">fill=</span>Size)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb253-2"><a href="hypothesis-testing-via-permutation.html#cb253-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Shuffled Cars&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-215-1.png" width="672" /></p>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="hypothesis-testing-via-permutation.html#cb254-1"></a>Cars_A_Size_Shuffle &lt;-<span class="st"> </span><span class="kw">aov</span>(<span class="dt">data=</span>ShuffledCars, LowPrice<span class="op">~</span>Size)</span>
<span id="cb254-2"><a href="hypothesis-testing-via-permutation.html#cb254-2"></a><span class="kw">summary</span>(Cars_A_Size_Shuffle)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)
## Size          2    688   344.1   1.366   0.26
## Residuals   107  26960   252.0</code></pre>
<p><strong>Third Permutation</strong></p>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="hypothesis-testing-via-permutation.html#cb256-1"></a>ShuffledCars &lt;-<span class="st"> </span>Cars2015    <span class="co">## create copy of dataset</span></span>
<span id="cb256-2"><a href="hypothesis-testing-via-permutation.html#cb256-2"></a>ShuffledCars<span class="op">$</span>Size &lt;-<span class="st"> </span>ShuffledCars<span class="op">$</span>Size[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledCars))] </span></code></pre></div>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="hypothesis-testing-via-permutation.html#cb257-1"></a>Shuffle1df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Cars2015<span class="op">$</span>Make, Cars2015<span class="op">$</span>Model, Cars2015<span class="op">$</span>LowPrice, Cars2015<span class="op">$</span>Size, ShuffledCars<span class="op">$</span>Size)</span>
<span id="cb257-2"><a href="hypothesis-testing-via-permutation.html#cb257-2"></a><span class="kw">names</span>(Shuffle1df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Make&quot;</span>, <span class="st">&quot;Model&quot;</span>, <span class="st">&quot;LowPrice&quot;</span>, <span class="st">&quot;Size&quot;</span>, <span class="st">&quot;ShuffledSize&quot;</span>)</span>
<span id="cb257-3"><a href="hypothesis-testing-via-permutation.html#cb257-3"></a><span class="kw">kable</span>(<span class="kw">head</span>(Shuffle1df))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Make</th>
<th align="left">Model</th>
<th align="right">LowPrice</th>
<th align="left">Size</th>
<th align="left">ShuffledSize</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Chevrolet</td>
<td align="left">Spark</td>
<td align="right">12.270</td>
<td align="left">Small</td>
<td align="left">Small</td>
</tr>
<tr class="even">
<td align="left">Hyundai</td>
<td align="left">Accent</td>
<td align="right">14.745</td>
<td align="left">Small</td>
<td align="left">Large</td>
</tr>
<tr class="odd">
<td align="left">Kia</td>
<td align="left">Rio</td>
<td align="right">13.990</td>
<td align="left">Small</td>
<td align="left">Small</td>
</tr>
<tr class="even">
<td align="left">Mitsubishi</td>
<td align="left">Mirage</td>
<td align="right">12.995</td>
<td align="left">Small</td>
<td align="left">Small</td>
</tr>
<tr class="odd">
<td align="left">Nissan</td>
<td align="left">Versa Note</td>
<td align="right">14.180</td>
<td align="left">Small</td>
<td align="left">Midsized</td>
</tr>
<tr class="even">
<td align="left">Dodge</td>
<td align="left">Dart</td>
<td align="right">16.495</td>
<td align="left">Small</td>
<td align="left">Midsized</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="hypothesis-testing-via-permutation.html#cb258-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>ShuffledCars, <span class="kw">aes</span>(<span class="dt">x=</span>Size, <span class="dt">y=</span>LowPrice, <span class="dt">fill=</span>Size)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb258-2"><a href="hypothesis-testing-via-permutation.html#cb258-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Shuffled Cars&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-219-1.png" width="672" /></p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="hypothesis-testing-via-permutation.html#cb259-1"></a>Cars_A_Size_Shuffle &lt;-<span class="st"> </span><span class="kw">aov</span>(<span class="dt">data=</span>ShuffledCars, LowPrice<span class="op">~</span>Size)</span>
<span id="cb259-2"><a href="hypothesis-testing-via-permutation.html#cb259-2"></a><span class="kw">summary</span>(Cars_A_Size_Shuffle)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)
## Size          2     42   21.01   0.081  0.922
## Residuals   107  27606  258.00</code></pre>
<p><strong>Fourth Permutation</strong></p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="hypothesis-testing-via-permutation.html#cb261-1"></a>ShuffledCars &lt;-<span class="st"> </span>Cars2015    <span class="co">## create copy of dataset</span></span>
<span id="cb261-2"><a href="hypothesis-testing-via-permutation.html#cb261-2"></a>ShuffledCars<span class="op">$</span>Size &lt;-<span class="st"> </span>ShuffledCars<span class="op">$</span>Size[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledCars))] </span></code></pre></div>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="hypothesis-testing-via-permutation.html#cb262-1"></a>Shuffle1df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Cars2015<span class="op">$</span>Make, Cars2015<span class="op">$</span>Model, Cars2015<span class="op">$</span>LowPrice, Cars2015<span class="op">$</span>Size, ShuffledCars<span class="op">$</span>Size)</span>
<span id="cb262-2"><a href="hypothesis-testing-via-permutation.html#cb262-2"></a><span class="kw">names</span>(Shuffle1df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Make&quot;</span>, <span class="st">&quot;Model&quot;</span>, <span class="st">&quot;LowPrice&quot;</span>, <span class="st">&quot;Size&quot;</span>, <span class="st">&quot;ShuffledSize&quot;</span>)</span>
<span id="cb262-3"><a href="hypothesis-testing-via-permutation.html#cb262-3"></a><span class="kw">kable</span>(<span class="kw">head</span>(Shuffle1df))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Make</th>
<th align="left">Model</th>
<th align="right">LowPrice</th>
<th align="left">Size</th>
<th align="left">ShuffledSize</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Chevrolet</td>
<td align="left">Spark</td>
<td align="right">12.270</td>
<td align="left">Small</td>
<td align="left">Small</td>
</tr>
<tr class="even">
<td align="left">Hyundai</td>
<td align="left">Accent</td>
<td align="right">14.745</td>
<td align="left">Small</td>
<td align="left">Small</td>
</tr>
<tr class="odd">
<td align="left">Kia</td>
<td align="left">Rio</td>
<td align="right">13.990</td>
<td align="left">Small</td>
<td align="left">Midsized</td>
</tr>
<tr class="even">
<td align="left">Mitsubishi</td>
<td align="left">Mirage</td>
<td align="right">12.995</td>
<td align="left">Small</td>
<td align="left">Small</td>
</tr>
<tr class="odd">
<td align="left">Nissan</td>
<td align="left">Versa Note</td>
<td align="right">14.180</td>
<td align="left">Small</td>
<td align="left">Small</td>
</tr>
<tr class="even">
<td align="left">Dodge</td>
<td align="left">Dart</td>
<td align="right">16.495</td>
<td align="left">Small</td>
<td align="left">Midsized</td>
</tr>
</tbody>
</table>
<p>Recall this model was fit under an assumption of no relationship between price and size.</p>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="hypothesis-testing-via-permutation.html#cb263-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>ShuffledCars, <span class="kw">aes</span>(<span class="dt">x=</span>Size, <span class="dt">y=</span>LowPrice, <span class="dt">fill=</span>Size)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb263-2"><a href="hypothesis-testing-via-permutation.html#cb263-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Shuffled Cars&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-223-1.png" width="672" /></p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="hypothesis-testing-via-permutation.html#cb264-1"></a>Cars_A_Size_Shuffle &lt;-<span class="st"> </span><span class="kw">aov</span>(<span class="dt">data=</span>ShuffledCars, LowPrice<span class="op">~</span>Size)</span>
<span id="cb264-2"><a href="hypothesis-testing-via-permutation.html#cb264-2"></a><span class="kw">summary</span>(Cars_A_Size_Shuffle)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)
## Size          2    885   442.6    1.77  0.175
## Residuals   107  26763   250.1</code></pre>
<p><strong>Fifth Permutation</strong></p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="hypothesis-testing-via-permutation.html#cb266-1"></a>ShuffledCars &lt;-<span class="st"> </span>Cars2015    <span class="co">## create copy of dataset</span></span>
<span id="cb266-2"><a href="hypothesis-testing-via-permutation.html#cb266-2"></a>ShuffledCars<span class="op">$</span>Size &lt;-<span class="st"> </span>ShuffledCars<span class="op">$</span>Size[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledCars))] </span></code></pre></div>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="hypothesis-testing-via-permutation.html#cb267-1"></a>Shuffle1df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(Cars2015<span class="op">$</span>Make, Cars2015<span class="op">$</span>Model, Cars2015<span class="op">$</span>LowPrice, Cars2015<span class="op">$</span>Size, ShuffledCars<span class="op">$</span>Size)</span>
<span id="cb267-2"><a href="hypothesis-testing-via-permutation.html#cb267-2"></a><span class="kw">names</span>(Shuffle1df) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Make&quot;</span>, <span class="st">&quot;Model&quot;</span>, <span class="st">&quot;LowPrice&quot;</span>, <span class="st">&quot;Size&quot;</span>, <span class="st">&quot;ShuffledSize&quot;</span>)</span>
<span id="cb267-3"><a href="hypothesis-testing-via-permutation.html#cb267-3"></a><span class="kw">kable</span>(<span class="kw">head</span>(Shuffle1df))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Make</th>
<th align="left">Model</th>
<th align="right">LowPrice</th>
<th align="left">Size</th>
<th align="left">ShuffledSize</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Chevrolet</td>
<td align="left">Spark</td>
<td align="right">12.270</td>
<td align="left">Small</td>
<td align="left">Midsized</td>
</tr>
<tr class="even">
<td align="left">Hyundai</td>
<td align="left">Accent</td>
<td align="right">14.745</td>
<td align="left">Small</td>
<td align="left">Small</td>
</tr>
<tr class="odd">
<td align="left">Kia</td>
<td align="left">Rio</td>
<td align="right">13.990</td>
<td align="left">Small</td>
<td align="left">Small</td>
</tr>
<tr class="even">
<td align="left">Mitsubishi</td>
<td align="left">Mirage</td>
<td align="right">12.995</td>
<td align="left">Small</td>
<td align="left">Midsized</td>
</tr>
<tr class="odd">
<td align="left">Nissan</td>
<td align="left">Versa Note</td>
<td align="right">14.180</td>
<td align="left">Small</td>
<td align="left">Midsized</td>
</tr>
<tr class="even">
<td align="left">Dodge</td>
<td align="left">Dart</td>
<td align="right">16.495</td>
<td align="left">Small</td>
<td align="left">Large</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="hypothesis-testing-via-permutation.html#cb268-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>ShuffledCars, <span class="kw">aes</span>(<span class="dt">x=</span>Size, <span class="dt">y=</span>LowPrice, <span class="dt">fill=</span>Size)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb268-2"><a href="hypothesis-testing-via-permutation.html#cb268-2"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Shuffled Cars&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-227-1.png" width="672" /></p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="hypothesis-testing-via-permutation.html#cb269-1"></a>Cars_A_Size_Shuffle &lt;-<span class="st"> </span><span class="kw">aov</span>(<span class="dt">data=</span>ShuffledCars, LowPrice<span class="op">~</span>Size)</span>
<span id="cb269-2"><a href="hypothesis-testing-via-permutation.html#cb269-2"></a><span class="kw">summary</span>(Cars_A_Size_Shuffle)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)
## Size          2    745   372.3   1.481  0.232
## Residuals   107  26903   251.4</code></pre>
</div>
<div id="r-code-for-permutation-test-3" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.9</span> R Code For Permutation Test<a href="hypothesis-testing-via-permutation.html#r-code-for-permutation-test-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll simulate 10,000 permutations and record the F-statistic for each set of permuted data.</p>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="hypothesis-testing-via-permutation.html#cb271-1"></a>Fstat &lt;-<span class="st"> </span><span class="kw">summary</span>(Cars_M_Size)<span class="op">$</span>fstatistic[<span class="dv">1</span>] <span class="co">## record value of F-statistic from actual data</span></span>
<span id="cb271-2"><a href="hypothesis-testing-via-permutation.html#cb271-2"></a></span>
<span id="cb271-3"><a href="hypothesis-testing-via-permutation.html#cb271-3"></a><span class="co">## perform simulation</span></span>
<span id="cb271-4"><a href="hypothesis-testing-via-permutation.html#cb271-4"></a>FSim &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">10000</span>)          <span class="co">## vector to hold results</span></span>
<span id="cb271-5"><a href="hypothesis-testing-via-permutation.html#cb271-5"></a>ShuffledCars &lt;-<span class="st"> </span>Cars2015    <span class="co">## create copy of dataset</span></span>
<span id="cb271-6"><a href="hypothesis-testing-via-permutation.html#cb271-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>){</span>
<span id="cb271-7"><a href="hypothesis-testing-via-permutation.html#cb271-7"></a>  <span class="co">#randomly shuffle acceleration times</span></span>
<span id="cb271-8"><a href="hypothesis-testing-via-permutation.html#cb271-8"></a>ShuffledCars<span class="op">$</span>Size &lt;-<span class="st"> </span>ShuffledCars<span class="op">$</span>Size[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledCars))] </span>
<span id="cb271-9"><a href="hypothesis-testing-via-permutation.html#cb271-9"></a>ShuffledCars_M&lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>ShuffledCars, LowPrice <span class="op">~</span><span class="st"> </span>Size)   <span class="co">#fit model to shuffled data</span></span>
<span id="cb271-10"><a href="hypothesis-testing-via-permutation.html#cb271-10"></a>FSim[i] &lt;-<span class="st"> </span><span class="kw">summary</span>(ShuffledCars_M)<span class="op">$</span>fstatistic[<span class="dv">1</span>]  <span class="co">## record F from shuffled model</span></span>
<span id="cb271-11"><a href="hypothesis-testing-via-permutation.html#cb271-11"></a>}</span>
<span id="cb271-12"><a href="hypothesis-testing-via-permutation.html#cb271-12"></a>CarSize_SimulationResults &lt;-<span class="st"> </span><span class="kw">data.frame</span>(FSim)  <span class="co">#save results in dataframe</span></span></code></pre></div>
</div>
<div id="f-statistic-for-size-simulation-results" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.10</span> F-statistic for Size Simulation Results<a href="hypothesis-testing-via-permutation.html#f-statistic-for-size-simulation-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="hypothesis-testing-via-permutation.html#cb272-1"></a>CarSize_SimulationResults_Plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>CarSize_SimulationResults, <span class="kw">aes</span>(<span class="dt">x=</span>FSim)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb272-2"><a href="hypothesis-testing-via-permutation.html#cb272-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">color=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="kw">c</span>(Fstat), <span class="dt">color=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb272-3"><a href="hypothesis-testing-via-permutation.html#cb272-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Simulated Value of F&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="op">+</span><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Distribution of F under assumption of no relationship&quot;</span>)</span>
<span id="cb272-4"><a href="hypothesis-testing-via-permutation.html#cb272-4"></a>CarSize_SimulationResults_Plot</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-230-1.png" width="672" /></p>
<p>p-value:</p>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="hypothesis-testing-via-permutation.html#cb273-1"></a><span class="kw">mean</span>(FSim <span class="op">&gt;</span><span class="st"> </span>Fstat)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>The p-value represents the probability of observing an F-statistic as extreme as 10.14 by chance, in samples of size 29, 34, and 47, if in fact there is no relationship between price and size of car.</p>
<p>The data provide strong evidence of a relationship between price and size.</p>
</div>
<div id="differences-between-different-sizes" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.11</span> Differences Between Different Sizes<a href="hypothesis-testing-via-permutation.html#differences-between-different-sizes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now that we have evidence that car price is related to size, we might want to know which sizes differ from each other.</p>
<p>Is there evidence of a difference in average price between…<br />
a) large and midsized cars?<br />
b) large and small cars?<br />
c) small and midsized cars?</p>
</div>
<div id="regression-coefficients-for-tests-between-sizes" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.12</span> Regression Coefficients for Tests Between Sizes<a href="hypothesis-testing-via-permutation.html#regression-coefficients-for-tests-between-sizes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math inline">\(\widehat{\text{Price}} = b_0 +b_1\times\text{I}_{\text{Midsized}}+ b_2\times\text{I}_{\text{Small}}\)</span></p>
<ul>
<li><span class="math inline">\(b_0\)</span> represents expected price of large cars.<br />
</li>
<li><span class="math inline">\(b_1\)</span> represents expected difference in price between large and midsized cars.<br />
</li>
<li><span class="math inline">\(b_2\)</span> represents expected difference in price between large and small cars.</li>
</ul>
<p>Thus, we can answer each question by looking at the appropriate regression coefficient.<br />
a) large and midsized cars? (<span class="math inline">\(b_1\)</span>)<br />
b) large and small cars? (<span class="math inline">\(b_2\)</span>)<br />
c) small and midsized cars? (<span class="math inline">\(b_1-b_2\)</span>)</p>
</div>
<div id="simulation-for-differences-between-types-of-cars" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.13</span> Simulation for Differences between Types of Cars<a href="hypothesis-testing-via-permutation.html#simulation-for-differences-between-types-of-cars" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll simulate situations where there is no relationship between size and price, and see how often we observe results for <span class="math inline">\(b_1\)</span>, <span class="math inline">\(b_2\)</span>, and <span class="math inline">\(b_1-b_2\)</span> as extreme as we did in the actual data.</p>
<p><strong>Procedure:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Randomly shuffle the sizes of the vehicles, so that any relationship between size and price is due only to chance.</p></li>
<li><p>Fit a model, using the shuffled data, with price as the response variable, and size as the explanatory variable. Record the values of <span class="math inline">\(b_1\)</span>, <span class="math inline">\(b_2\)</span>, and <span class="math inline">\(b_1-b_2\)</span>.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, recording the values of <span class="math inline">\(b_1\)</span>, <span class="math inline">\(b_2\)</span>, and <span class="math inline">\(b_1-b_2\)</span> each time.</p></li>
<li><p>Analyze the distribution of <span class="math inline">\(b_1\)</span>, <span class="math inline">\(b_2\)</span>, <span class="math inline">\(b_1-b_2\)</span>, simulated under the assumption that there is no relationship between size and price. Look whether the actual values we observed are consistent with the simulation results.</p></li>
</ol>
</div>
<div id="code-for-simulation-based-test-of-prices-by-size" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.14</span> Code for Simulation-Based Test of Prices by Size<a href="hypothesis-testing-via-permutation.html#code-for-simulation-based-test-of-prices-by-size" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="hypothesis-testing-via-permutation.html#cb275-1"></a>b1 &lt;-<span class="st"> </span>Cars_M_Size<span class="op">$</span>coefficients[<span class="dv">2</span>]  <span class="co">#record b1 from actual data</span></span>
<span id="cb275-2"><a href="hypothesis-testing-via-permutation.html#cb275-2"></a>b2 &lt;-<span class="st"> </span>Cars_M_Size<span class="op">$</span>coefficients[<span class="dv">3</span>]  <span class="co">#record b2 from actual data</span></span>
<span id="cb275-3"><a href="hypothesis-testing-via-permutation.html#cb275-3"></a></span>
<span id="cb275-4"><a href="hypothesis-testing-via-permutation.html#cb275-4"></a><span class="co">## perform simulation</span></span>
<span id="cb275-5"><a href="hypothesis-testing-via-permutation.html#cb275-5"></a>b1Sim &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">10000</span>)          <span class="co">## vector to hold results</span></span>
<span id="cb275-6"><a href="hypothesis-testing-via-permutation.html#cb275-6"></a>b2Sim &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">10000</span>)          <span class="co">## vector to hold results</span></span>
<span id="cb275-7"><a href="hypothesis-testing-via-permutation.html#cb275-7"></a>ShuffledCars &lt;-<span class="st"> </span>Cars2015    <span class="co">## create copy of dataset</span></span>
<span id="cb275-8"><a href="hypothesis-testing-via-permutation.html#cb275-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>){</span>
<span id="cb275-9"><a href="hypothesis-testing-via-permutation.html#cb275-9"></a>  <span class="co">#randomly shuffle acceleration times</span></span>
<span id="cb275-10"><a href="hypothesis-testing-via-permutation.html#cb275-10"></a>ShuffledCars<span class="op">$</span>Size &lt;-<span class="st"> </span>ShuffledCars<span class="op">$</span>Size[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledCars))] </span>
<span id="cb275-11"><a href="hypothesis-testing-via-permutation.html#cb275-11"></a>ShuffledCars_M&lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>ShuffledCars, LowPrice <span class="op">~</span><span class="st"> </span>Size)   <span class="co">#fit model to shuffled data</span></span>
<span id="cb275-12"><a href="hypothesis-testing-via-permutation.html#cb275-12"></a>b1Sim[i] &lt;-<span class="st"> </span>ShuffledCars_M<span class="op">$</span>coefficients[<span class="dv">2</span>]   <span class="co">## record b1 from shuffled model</span></span>
<span id="cb275-13"><a href="hypothesis-testing-via-permutation.html#cb275-13"></a>b2Sim[i] &lt;-<span class="st"> </span>ShuffledCars_M<span class="op">$</span>coefficients[<span class="dv">3</span>]   <span class="co">## record b2 from shuffled model</span></span>
<span id="cb275-14"><a href="hypothesis-testing-via-permutation.html#cb275-14"></a>}</span>
<span id="cb275-15"><a href="hypothesis-testing-via-permutation.html#cb275-15"></a>Cars_Size2_SimulationResults &lt;-<span class="st"> </span><span class="kw">data.frame</span>(b1Sim, b2Sim)  <span class="co">#save results in dataframe</span></span></code></pre></div>
</div>
<div id="car-size-simulation-based-results-for-b_1" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.15</span> Car Size Simulation-Based Results for <span class="math inline">\(b_1\)</span><a href="hypothesis-testing-via-permutation.html#car-size-simulation-based-results-for-b_1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="hypothesis-testing-via-permutation.html#cb276-1"></a>Cars_Size2_SimulationResultsPlot_b1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>Cars_Size2_SimulationResults, <span class="kw">aes</span>(<span class="dt">x=</span>b1Sim)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb276-2"><a href="hypothesis-testing-via-permutation.html#cb276-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">color=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb276-3"><a href="hypothesis-testing-via-permutation.html#cb276-3"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="kw">c</span>(b1, <span class="dv">-1</span><span class="op">*</span>b1), <span class="dt">color=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb276-4"><a href="hypothesis-testing-via-permutation.html#cb276-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Simulated Value of b1&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb276-5"><a href="hypothesis-testing-via-permutation.html#cb276-5"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Large vs Midsize Cars: Distribution of b1 under assumption of no relationship&quot;</span>)</span>
<span id="cb276-6"><a href="hypothesis-testing-via-permutation.html#cb276-6"></a>Cars_Size2_SimulationResultsPlot_b1</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-233-1.png" width="672" /></p>
<p>p-value:</p>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="hypothesis-testing-via-permutation.html#cb277-1"></a><span class="kw">mean</span>(<span class="kw">abs</span>(b1Sim)<span class="op">&gt;</span><span class="kw">abs</span>(b1))</span></code></pre></div>
<pre><code>## [1] 0.0243</code></pre>
<p>The p-value represents the probability of observing a difference in mean prices as extreme as 9.1 by chance, in samples of size 29 and 34 cars, if in fact there is no difference in average prices of large and midsized cars.</p>
</div>
<div id="car-size-simulation-based-results-for-b_2" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.16</span> Car Size Simulation-Based Results for <span class="math inline">\(b_2\)</span><a href="hypothesis-testing-via-permutation.html#car-size-simulation-based-results-for-b_2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="hypothesis-testing-via-permutation.html#cb279-1"></a>Cars_Size2_SimulationResultsPlot_b2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>Cars_Size2_SimulationResults, <span class="kw">aes</span>(<span class="dt">x=</span>b2Sim)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb279-2"><a href="hypothesis-testing-via-permutation.html#cb279-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">color=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb279-3"><a href="hypothesis-testing-via-permutation.html#cb279-3"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="kw">c</span>(b2, <span class="dv">-1</span><span class="op">*</span>b2), <span class="dt">color=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb279-4"><a href="hypothesis-testing-via-permutation.html#cb279-4"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Simulated Value of b2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb279-5"><a href="hypothesis-testing-via-permutation.html#cb279-5"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Large vs Small Cars: Distribution of b2 under assumption of no relationship&quot;</span>)</span>
<span id="cb279-6"><a href="hypothesis-testing-via-permutation.html#cb279-6"></a>Cars_Size2_SimulationResultsPlot_b2</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-235-1.png" width="672" /></p>
<p>p-value:</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb280-1"><a href="hypothesis-testing-via-permutation.html#cb280-1"></a><span class="kw">mean</span>(<span class="kw">abs</span>(b2Sim)<span class="op">&gt;</span><span class="kw">abs</span>(b2))</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>The p-value represents the probability of observing a difference in mean prices as extreme as 15.4 by chance, in samples of size 29 and 47 cars, if in fact there is no difference in average prices of large and small cars.</p>
</div>
<div id="car-size-simulation-based-results-for-b_1-b_2" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.17</span> Car Size Simulation-Based Results for <span class="math inline">\(b_1-b_2\)</span><a href="hypothesis-testing-via-permutation.html#car-size-simulation-based-results-for-b_1-b_2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="hypothesis-testing-via-permutation.html#cb282-1"></a>Cars_Size2_SimulationResultsPlot_b1_b2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>Cars_Size2_SimulationResults, <span class="kw">aes</span>(<span class="dt">x=</span>b1Sim<span class="op">-</span>b2Sim)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb282-2"><a href="hypothesis-testing-via-permutation.html#cb282-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">color=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="kw">c</span>(b1<span class="op">-</span>b2, <span class="dv">-1</span><span class="op">*</span>(b1<span class="op">-</span>b2)), <span class="dt">color=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb282-3"><a href="hypothesis-testing-via-permutation.html#cb282-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Simulated Value of b1-b2&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb282-4"><a href="hypothesis-testing-via-permutation.html#cb282-4"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Small vs Midsize Cars: Distribution of b1-b2 under assumption of no relationship&quot;</span>)</span>
<span id="cb282-5"><a href="hypothesis-testing-via-permutation.html#cb282-5"></a>Cars_Size2_SimulationResultsPlot_b1_b2</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-237-1.png" width="672" /></p>
<p>p-value:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="hypothesis-testing-via-permutation.html#cb283-1"></a><span class="kw">mean</span>(<span class="kw">abs</span>(b1Sim<span class="op">-</span>b2Sim)<span class="op">&gt;</span><span class="kw">abs</span>(b1<span class="op">-</span>b2))</span></code></pre></div>
<pre><code>## [1] 0.0666</code></pre>
<p>The p-value represents the probability of observing a difference in mean prices as extreme as 6.5 by chance, in samples of size 34 and 47 cars, if in fact there is no difference in average prices of midsized and small cars.</p>
</div>
<div id="bonferroni-correction" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.18</span> Bonferroni Correction<a href="hypothesis-testing-via-permutation.html#bonferroni-correction" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>We might normally conclude that there is evidence of differences in group means in the p-value is less than 0.05. However, since we are performing multiple tests simultaneously, there is an increased chance that at least one of them will yield a small p-value just by chance. Thus, we should be more strict in deciding what constitutes evidence against the null hypothesis.</p></li>
<li><p>A commone rule (known as the <strong>Bonferroni correction</strong>) is to divide the values usually used as criteria for evidence by the number of tests. In this example:<br />
- Here, we would say there is some evidence of differences between groups if the p-value is less than 0.10/3=0.0333.<br />
- We would say there is strong evidence of differences if the p-value is less than 0.05/3=0.0167</p></li>
</ul>
<table>
<thead>
<tr class="header">
<th>Comparison</th>
<th>Coefficient</th>
<th>p-value</th>
<th>Evidence of Difference</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>large vs midsize</td>
<td><span class="math inline">\(b_1\)</span></td>
<td>0.0243</td>
<td>Some evidence</td>
</tr>
<tr class="even">
<td>large vs small</td>
<td><span class="math inline">\(b_2\)</span></td>
<td>0</td>
<td>Strong evidence</td>
</tr>
<tr class="odd">
<td>small vs midsize</td>
<td><span class="math inline">\(b_1-b_2\)</span></td>
<td>0.0666</td>
<td>No evidence</td>
</tr>
</tbody>
</table>
</div>
<div id="summary-of-tests-between-multiple-groups" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.19</span> Summary of Tests Between Multiple Groups<a href="hypothesis-testing-via-permutation.html#summary-of-tests-between-multiple-groups" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When testing for differences between more than two groups:</p>
<ol style="list-style-type: decimal">
<li>Perform an overall test, using the F-statistic. A large F-statistic and small p-value tell us there is evidence of differences between at least some of the groups.<br />
</li>
<li>If the F-tests yields evidence evidence of differences, perform tests on individual model coefficients to determine which groups differ. Use a more strict cutoff criteria, such as the Bonferroni correction.</li>
</ol>
</div>
<div id="bear-weights-by-season" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.20</span> Bear Weights by Season<a href="hypothesis-testing-via-permutation.html#bear-weights-by-season" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="hypothesis-testing-via-permutation.html#cb285-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>Bears_Subset, <span class="kw">aes</span>(<span class="dt">y=</span>Weight, <span class="dt">x=</span>Season, <span class="dt">fill=</span>Season)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb285-2"><a href="hypothesis-testing-via-permutation.html#cb285-2"></a><span class="st">   </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>()</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-239-1.png" width="672" /></p>
</div>
<div id="bear-weights-by-season-model" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.21</span> Bear Weights by Season Model<a href="hypothesis-testing-via-permutation.html#bear-weights-by-season-model" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="hypothesis-testing-via-permutation.html#cb286-1"></a>Bears_M_Season &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>Bears_Subset, Weight<span class="op">~</span>Season)</span>
<span id="cb286-2"><a href="hypothesis-testing-via-permutation.html#cb286-2"></a><span class="kw">summary</span>(Bears_M_Season)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Weight ~ Season, data = Bears_Subset)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -178.84  -79.84  -29.02   54.98  309.16 
## 
## Coefficients:
##              Estimate Std. Error t value            Pr(&gt;|t|)    
## (Intercept)    204.84      17.16  11.939 &lt;0.0000000000000002 ***
## SeasonSpring   -37.27      34.62  -1.076               0.284    
## SeasonSummer   -29.81      24.71  -1.206               0.231    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 112.5 on 94 degrees of freedom
## Multiple R-squared:  0.02034,    Adjusted R-squared:  -0.0005074 
## F-statistic: 0.9757 on 2 and 94 DF,  p-value: 0.3807</code></pre>
</div>
<div id="f-statistic-for-bear-weights-by-season" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.22</span> F-Statistic for Bear Weights by Season<a href="hypothesis-testing-via-permutation.html#f-statistic-for-bear-weights-by-season" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="hypothesis-testing-via-permutation.html#cb288-1"></a>Bears_A_Season &lt;-<span class="st"> </span><span class="kw">aov</span>(<span class="dt">data=</span>Bears_Subset, Weight<span class="op">~</span>Season)</span>
<span id="cb288-2"><a href="hypothesis-testing-via-permutation.html#cb288-2"></a><span class="kw">summary</span>(Bears_A_Season)</span></code></pre></div>
<pre><code>##             Df  Sum Sq Mean Sq F value Pr(&gt;F)
## Season       2   24699   12350   0.976  0.381
## Residuals   94 1189818   12658</code></pre>
</div>
<div id="hypotheses-for-bears-seasons-f-test" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.23</span> Hypotheses for Bears Seasons F-Test<a href="hypothesis-testing-via-permutation.html#hypotheses-for-bears-seasons-f-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Null Hypothesis: Among all bears of this type, mean weight is the same in each season.<br />
Alternative Hypothesis: Among all bears of this type, mean weight differs between at least two of the seasons.</p>
<p><strong>Key Question:</strong> What is the probability of observing an F-statistic as extreme as 0.976 if there is really no relationship between weight and season?</p>
</div>
<div id="simulation-based-test-for-bears-f-statistic" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.24</span> Simulation-Based Test for Bears F-Statistic<a href="hypothesis-testing-via-permutation.html#simulation-based-test-for-bears-f-statistic" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We’ll simulate situations where there is no relationship between size and price, and see how often we observe an F-statistic as extreme as 0.976.</p>
<p><strong>Procedure:</strong></p>
<ol style="list-style-type: decimal">
<li><p>Randomly shuffle the seasons, so that any relationship between weight and season is due only to chance.</p></li>
<li><p>Fit a model, using the shuffled data, with weight as the response variable, and season as the explanatory variable. Record the F-statistic.</p></li>
<li><p>Repeat steps 1 and 2 many (say 10,000) times, recording the F-statistic each time.</p></li>
<li><p>Analyze the distribution of F-statistics, simulated under the assumption that there is no relationship between season and weight Look whether the actual F-statistic we observed is consistent with the simulation results.</p></li>
</ol>
</div>
<div id="bears-f-statistic-simulation" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.25</span> Bears F-Statistic Simulation<a href="hypothesis-testing-via-permutation.html#bears-f-statistic-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="hypothesis-testing-via-permutation.html#cb290-1"></a>Fstat &lt;-<span class="st"> </span><span class="kw">summary</span>(Bears_M_Season)<span class="op">$</span>fstatistic[<span class="dv">1</span>] <span class="co">## record value of F-statistic from actual data</span></span>
<span id="cb290-2"><a href="hypothesis-testing-via-permutation.html#cb290-2"></a></span>
<span id="cb290-3"><a href="hypothesis-testing-via-permutation.html#cb290-3"></a><span class="co">## perform simulation</span></span>
<span id="cb290-4"><a href="hypothesis-testing-via-permutation.html#cb290-4"></a>FSim &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">10000</span>)          <span class="co">## vector to hold results</span></span>
<span id="cb290-5"><a href="hypothesis-testing-via-permutation.html#cb290-5"></a>ShuffledBears &lt;-<span class="st"> </span>Bears_Subset    <span class="co">## create copy of dataset</span></span>
<span id="cb290-6"><a href="hypothesis-testing-via-permutation.html#cb290-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10000</span>){</span>
<span id="cb290-7"><a href="hypothesis-testing-via-permutation.html#cb290-7"></a>  <span class="co">#randomly shuffle acceleration times</span></span>
<span id="cb290-8"><a href="hypothesis-testing-via-permutation.html#cb290-8"></a>ShuffledBears<span class="op">$</span>Season &lt;-<span class="st"> </span>ShuffledBears<span class="op">$</span>Season[<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(ShuffledBears))] </span>
<span id="cb290-9"><a href="hypothesis-testing-via-permutation.html#cb290-9"></a>ShuffledBears_M&lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">data=</span>ShuffledBears, Weight <span class="op">~</span><span class="st"> </span>Season)   <span class="co">#fit model to shuffled data</span></span>
<span id="cb290-10"><a href="hypothesis-testing-via-permutation.html#cb290-10"></a>FSim[i] &lt;-<span class="st"> </span><span class="kw">summary</span>(ShuffledBears_M)<span class="op">$</span>fstatistic[<span class="dv">1</span>]  <span class="co">## record F from shuffled model</span></span>
<span id="cb290-11"><a href="hypothesis-testing-via-permutation.html#cb290-11"></a>}</span>
<span id="cb290-12"><a href="hypothesis-testing-via-permutation.html#cb290-12"></a>Bears_Seasons_SimulationResults &lt;-<span class="st"> </span><span class="kw">data.frame</span>(FSim)  <span class="co">#save results in dataframe</span></span></code></pre></div>
</div>
<div id="f-statistic-for-bears-season-simulation" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.26</span> F-statistic for Bears Season Simulation<a href="hypothesis-testing-via-permutation.html#f-statistic-for-bears-season-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="hypothesis-testing-via-permutation.html#cb291-1"></a>Bears_Seasons_SimulationResultsPlot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data=</span>Bears_Seasons_SimulationResults, <span class="kw">aes</span>(<span class="dt">x=</span>FSim)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb291-2"><a href="hypothesis-testing-via-permutation.html#cb291-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>, <span class="dt">color=</span><span class="st">&quot;white&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span><span class="kw">c</span>(Fstat), <span class="dt">color=</span><span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb291-3"><a href="hypothesis-testing-via-permutation.html#cb291-3"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Simulated Value of F&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Frequency&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb291-4"><a href="hypothesis-testing-via-permutation.html#cb291-4"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Distribution of F under assumption of no relationship&quot;</span>)</span>
<span id="cb291-5"><a href="hypothesis-testing-via-permutation.html#cb291-5"></a>Bears_Seasons_SimulationResultsPlot</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-243-1.png" width="672" /></p>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="hypothesis-testing-via-permutation.html#cb292-1"></a><span class="kw">mean</span>(FSim <span class="op">&gt;</span><span class="st"> </span>Fstat)</span></code></pre></div>
<pre><code>## [1] 0.3762</code></pre>
<p>The p-value represents the probability of observing and F-statistic as extreme as 0.976 by chance, in a sample of 97, if in fact there is no difference in average weights of bears between seasons.</p>
<p>It is not at all unusual to observe an F-statistic as extreme or more extreme than we did if there is really no relationship between weight and season.</p>
<p>There is no evidence that average bear weights differ between seasons.</p>
</div>
<div id="dont-accept-null-hypothesis" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.27</span> Don’t Accept Null Hypothesis<a href="hypothesis-testing-via-permutation.html#dont-accept-null-hypothesis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><p>In the previous example, we concluded that there is no evidence that average bear weights differ between seasons.</p></li>
<li><p>This is different than saying that bear weights are the same in each season. Why would it be inappropriate to say this?</p></li>
</ul>
</div>
<div id="comparison-of-weights-by-season" class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.28</span> Comparison of Weights by Season<a href="hypothesis-testing-via-permutation.html#comparison-of-weights-by-season" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="hypothesis-testing-via-permutation.html#cb294-1"></a>Bears_Season_Table &lt;-<span class="st"> </span>Bears_Subset <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(Season) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">MeanWeight =</span> <span class="kw">mean</span>(Weight),</span>
<span id="cb294-2"><a href="hypothesis-testing-via-permutation.html#cb294-2"></a>                                         <span class="dt">StDevWeight =</span> <span class="kw">sd</span>(Weight),</span>
<span id="cb294-3"><a href="hypothesis-testing-via-permutation.html#cb294-3"></a>                                         <span class="dt">N=</span><span class="kw">n</span>())</span>
<span id="cb294-4"><a href="hypothesis-testing-via-permutation.html#cb294-4"></a><span class="kw">kable</span>(Bears_Season_Table)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Season</th>
<th align="right">MeanWeight</th>
<th align="right">StDevWeight</th>
<th align="right">N</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Fall</td>
<td align="right">204.8372</td>
<td align="right">125.71414</td>
<td align="right">43</td>
</tr>
<tr class="even">
<td align="left">Spring</td>
<td align="right">167.5714</td>
<td align="right">108.74155</td>
<td align="right">14</td>
</tr>
<tr class="odd">
<td align="left">Summer</td>
<td align="right">175.0250</td>
<td align="right">97.70796</td>
<td align="right">40</td>
</tr>
</tbody>
</table>
</div>
<div id="dont-accept-null-hypothesis-cont." class="section level3 hasAnchor">
<h3><span class="header-section-number">3.4.29</span> Don’t Accept Null Hypothesis (Cont.)<a href="hypothesis-testing-via-permutation.html#dont-accept-null-hypothesis-cont." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The data do show differences in average weight between seasons. It’s just that we can’t rule out the possibility that these differences are due to chance alone.</p>
<ul>
<li><p>A hypothesis test can only tell us the strength of evidence against the null hypothesis. The absence of evidence against the null hypothesis should not be interpreted as evidence for the null hypothesis.</p></li>
<li><p>We should never say that the data support/prove/confirm the null hypothesis.</p></li>
<li><p>We can only say that the data do not provide evidence against the null hypothesis.</p></li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction-to-statistical-models.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Stat255-LU/Notes/edit/master/03-Hypothesis_Testing.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Stat255-LU/Notes/blob/master/03-Hypothesis_Testing.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
